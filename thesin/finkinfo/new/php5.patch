diff -ruN php-5.6.7.orig/fink/debhelper/php5-maintscript-helper php-5.6.7/fink/debhelper/php5-maintscript-helper
--- php-5.6.7.orig/fink/debhelper/php5-maintscript-helper	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/debhelper/php5-maintscript-helper	2015-04-29 09:45:19.000000000 -0600
@@ -0,0 +1,279 @@
+# php5-maintscript-helper - Php5 helper function for maintainer scripts
+# Copyright (C) 2012 Arno Töll <debian@toell.net>
+#               2013 Ondřej Surý <ondrej@sury.org>
+#
+# Permission is hereby granted, free of charge, to any person obtaining a copy of
+# this software and associated documentation files (the "Software"), to deal in
+# the Software without restriction, including without limitation the rights to
+# use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
+# the Software, and to permit persons to whom the Software is furnished to do so,
+# subject to the following conditions:
+#
+# The above copyright notice and this permission notice shall be included in all
+# copies or substantial portions of the Software.
+#
+# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
+# FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
+# COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
+# IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
+# CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
+
+
+#
+# VARIABLES
+#
+
+
+# global environment variables used by php5-maintscript-helper:
+# * PHP5_MAINTSCRIPT_DEBUG:
+#				set this to any non-zero value to get debug output
+# * PHP5_MAINTSCRIPT_HELPER_QUIET:
+#				set this to any non-zero value to omit any output
+# * EXPORT_PHP5_MAINTSCRIPT_HELPER:
+#				will be defined by php5-maintscript-helper
+#				to avoid inclusion loops. Do not set this
+#				variable manually
+# * PHP5_NEED_ACTION:
+#				will be defined if a function call wants to
+#				override the behavior of php5_needs_action.
+#				Do not rely on this variable. It is considered
+#				an implementation detail.
+# * PHP5_MAINTSCRIPT_NAME
+# * PHP5_MAINTSCRIPT_PACKAGE
+# * PHP5_MAINTSCRIPT_METHOD
+# * PHP5_MAINTSCRIPT_ARGUMENT
+#				these variables contain information about the
+#				maintainer script which is calling the
+#				maintscript-helper. It contains arguments which
+#				dpkg supplies to maintainer scripts and similar
+#				information. These variables are an
+#				implementation detail and not to be changed.
+#
+#				You might want to set them manually only if you
+#				are calling php5-maintscript-helper from
+#				some place which does not preserve the original
+#				script arguments for example when calling from
+#				a subfunction instead of the main function in
+#				your maintainer script
+
+#
+# INITIALIZATION
+#
+
+if [ -n "${EXPORT_PHP5_MAINTSCRIPT_HELPER:-}" ] ; then
+	return
+else
+	EXPORT_PHP5_MAINTSCRIPT_HELPER=1
+
+	if [ -n "${PHP5_MAINTSCRIPT_DEBUG:-}" ] ; then
+		set -x
+	fi
+
+	if [ -z "$1" ] ; then
+		echo "You must invoke php5-maintscript-helper with an unmodified environment when sourcing it" >&2
+		return 1
+	fi
+
+	PHP5_MAINTSCRIPT_NAME="$DPKG_MAINTSCRIPT_NAME"
+	[ "$PHP5_MAINTSCRIPT_NAME" ] || PHP5_MAINTSCRIPT_NAME="${0##*.}"
+
+	case "$PHP5_MAINTSCRIPT_NAME" in
+		preinst|prerm|postrm|postinst)
+			# yay - recognized script
+		;;
+		*)
+			echo "php5-maintscript-helper invoked from an unrecognized maintainer script: exiting" >&2
+			return 1
+		;;
+	esac
+
+	PHP5_MAINTSCRIPT_PACKAGE="$DPKG_MAINTSCRIPT_PACKAGE"
+	if [ -z "$PHP5_MAINTSCRIPT_PACKAGE" ]; then
+		PHP5_MAINTSCRIPT_PACKAGE="${0##*/}"
+		PHP5_MAINTSCRIPT_PACKAGE="${PHP5_MAINTSCRIPT_PACKAGE%.*}"
+	fi
+
+	if [ -z "$PHP5_MAINTSCRIPT_METHOD" ] ; then
+		PHP5_MAINTSCRIPT_METHOD="$1"
+	fi
+
+	case "$PHP5_MAINTSCRIPT_METHOD" in
+		install|upgrade|abort-upgrade|configure|abort-remove|abort-remove|abort-deconfigure|remove|failed-upgrade|purge|disappear|abort-install)
+			# yay - recognized script
+		;;
+		*)
+			echo "php5-maintscript-helper invoked from a modified environment. Please hint required arguments manually" >&2
+			return 1
+		;;
+	esac
+
+
+
+	if [ -z "$PHP5_MAINTSCRIPT_ARGUMENT" ] ; then
+		PHP5_MAINTSCRIPT_ARGUMENT="${2:-}"
+	fi
+
+fi
+
+#
+# FUNCTIONS
+#
+
+#
+# Function php5_msg
+#	print out a warning to both, the syslog and a local standard output.
+#	This function should generally be used to display messages related to
+#	the web server in maintainer scripts.
+# Parameters:
+#	priority
+#		The message priority. Recognized values are the same as defined
+#		by syslog(3), thus: one among debug, info, notice, warning,
+#		err, crit, alert, emerg.
+#		If no known priority is recognized, the priority is set to
+#		"warning".
+#	message
+#		The message as a string. It is printed out verbatim.
+# Behavior:
+#	No message is displayed if PHP5_MAINTSCRIPT_HELPER_QUIET is defined
+# Returns:
+#	this function always returns 0
+# Since: 5.5.0+dfsg-7
+php5_msg()
+{
+	local PRIORITY="$1"
+	local MSG="$2"
+	case "$PRIORITY" in
+		debug|info|notice|warning|err|crit|alert|emerg)
+		;;
+		*)
+			PRIORITY="warning"
+		;;
+	esac
+	[ -z "$PHP5_MAINTSCRIPT_HELPER_QUIET" ] && ( [ -n "${PHP5_MAINTSCRIPT_DEBUG:-}" ] || [ "$PRIORITY" != "debug" ] ) && echo "$MSG" >&2
+	[ -x /usr/bin/logger ] || return 0
+	local LOGGER="/usr/bin/logger -p daemon.$PRIORITY -t $PHP5_MAINTSCRIPT_PACKAGE "
+	$LOGGER "$MSG" || return 0
+}
+
+#
+# Function php5_invoke
+#	invokes an Apache 2 configuration helper to enable or disable a
+#	particular piece of configuration, a site or a module. It carefully
+#	checks whether the supplied configuration snippet exists and reloads the
+#	web server if the site administrator desires that by call dpkg trigger
+#       @FINKPREFIX@/etc/php5/SAPI/conf.d which is defined for apache2, apache2filter and fpm.
+#
+# Parameters:
+#	command - The command to invoke. Recognized commands are "enconf",
+#		"enmod", "ensite", "disconf", "dismod", "dissite"
+#
+#       sapi - Either the specific SAPI (apache2, apache2filter, fpm,
+#              cgi, cli, embed) or ALL
+#
+#	arguments
+#		- A single argument (e.g. a module) which shall be
+#		  enabled or disabled respectively.
+#
+# Returns
+#	0 if the changes could be activated
+#	1 otherwise
+# Since: 5.5.0+dsfg-7
+php5_invoke()
+{
+    local CMD=$1
+    local SAPI=$2
+    local MOD=$3
+    local check_switch=""
+    local invoke_string=""
+    local rcd_action=""
+    local rcd_scripts=""
+    local sapi_list=""
+
+    [ -x "@FINKPREFIX@/sbin/php5$CMD" ] || return 1
+    [ -x "@FINKPREFIX@/sbin/php5query" ] || return 1
+
+    sapi_list="$SAPI"
+    case "$SAPI" in
+	apache2|apache2filter|fpm|cli|cgi|embed)
+	    ;;
+	ALL)
+	    sapi_list=$(php5query -S)
+	    case "$CMD" in
+		enmod|dismod)
+		    php5$CMD -q -m -r "$MOD" || return 1
+		    ;;
+		*)
+		    return 1
+		    ;;
+	    esac
+	    ;;
+	*)
+	    return 1
+	    ;;
+    esac
+
+    for SAPI in $sapi_list; do
+	case "$CMD" in
+	    enmod)
+		local php5query_ret=0
+		php5query -s "$SAPI" -m "$MOD" > /dev/null 2>&1 || php5query_ret=$?
+		if [ "$php5query_ret" -eq 0 ] ; then
+		    # configuration is already enabled
+ 		    php5$CMD -m -s "$SAPI" -q "$MOD" > /dev/null 2>&1 || return 1
+		    php5_msg "debug" "php5_invoke $MOD: already enabled for $SAPI SAPI"
+		    PHP5_NEED_ACTION=1
+		elif [ "$php5query_ret" -eq 32	 ] ; then
+		    # the maintainer disabled the module
+		    php5_msg "info" "php5_invoke $MOD: no action - module was disabled by maintainer for $SAPI SAPI"
+		    return 0
+		else
+		    # coming here either means:
+		    # a) we have no clue about the module (e.g. for upgrades prior to maintscript-helper
+		    # b) it's a fresh install
+		    PHP5_NEED_ACTION=1
+ 		    php5$CMD -m -s "$SAPI" -q "$MOD" > /dev/null 2>&1 || return 1
+		    php5_msg "info" "php5_invoke: Enable module $MOD for $SAPI SAPI"
+		fi
+		;;
+	    dismod)
+		local php5query_ret=0
+		php5query -s "$SAPI" -m "$MOD" > /dev/null 2>&1 || php5query_ret=$?
+		if [ "$php5query_ret" -eq 0 ] ; then
+		    if [ "$PHP5_MAINTSCRIPT_NAME" = 'postrm' ] && [ "$PHP5_MAINTSCRIPT_METHOD" = "purge" ] ; then
+			php5$CMD -p -f -s "$SAPI" -q "$MOD" || return 1
+			php5_msg "debug" "php5_invoke $PHP5_MAINTSCRIPT_NAME: Purging module $MOD for $SAPI SAPI"
+			PHP5_NEED_ACTION=1
+		    elif [ "$PHP5_MAINTSCRIPT_NAME" = 'postrm' ] || [ "$PHP5_MAINTSCRIPT_NAME" = 'prerm' ] ; then
+			if [ "$PHP5_MAINTSCRIPT_METHOD" = "remove" ] ; then
+			    php5$CMD -m -f -s "$SAPI" -q "$MOD" || return 1
+			    php5_msg "info" "php5_invoke $PHP5_MAINTSCRIPT_NAME: Disable module $MOD for $SAPI SAPI"
+			    PHP5_NEED_ACTION=1
+			fi
+		    else
+			php5_msg "error" "php5_invoke: module $MOD not supported in $PHP5_MAINTSCRIPT_NAME for $SAPI SAPI"
+			return 1
+		    fi
+		elif [ "$php5query_ret" -eq 32 ] || [ "$php5query_ret" -eq 33 ] ; then
+		    if [ "$PHP5_MAINTSCRIPT_NAME" = 'postrm' ] && [ "$PHP5_MAINTSCRIPT_METHOD" = "purge" ] ; then
+			php5_msg "debug" "php5_invoke $PHP5_MAINTSCRIPT_NAME: Purging state for $MOD for $SAPI SAPI"
+			# this will return RC=1
+			( php5$CMD -p -f -s "$SAPI" -q "$MOD" > /dev/null 2>&1 )
+		    else
+			php5_msg "debug" "php5_invoke $MOD $PHP5_MAINTSCRIPT_NAME: No action required for $SAPI SAPI"
+		    fi
+		else
+		    php5_msg "debug" "php5_invoke $MOD $PHP5_MAINTSCRIPT_NAME: No action required for $SAPI SAPI"
+		fi
+		;;
+	    *)
+		return 1
+		;;
+	esac
+	if [ -n "${PHP_NEED_ACTION:-}" -a -n "$rcd_action" ]; then
+	    dpkg-trigger @FINKPREFIX@/etc/php5/$SAPI/conf.d
+	fi
+    done
+}
+
+# vim: syntax=sh sw=8 sts=8 sr noet
diff -ruN php-5.6.7.orig/fink/libapache2-mod-php5.postinst.extra php-5.6.7/fink/libapache2-mod-php5.postinst.extra
--- php-5.6.7.orig/fink/libapache2-mod-php5.postinst.extra	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/libapache2-mod-php5.postinst.extra	2013-09-09 09:44:16.000000000 -0600
@@ -0,0 +1,32 @@
+if [ -e @FINKPREFIX@/share/apache2/apache2-maintscript-helper ]; then
+    . @FINKPREFIX@/share/apache2/apache2-maintscript-helper
+
+    php5_enable() {
+       mpm=$(a2query -M)
+       case "$(a2query -M)" in
+           prefork|itk) return 0;;
+           *) if apache2_switch_mpm prefork; then return 0; fi;;
+       esac
+        apache2_msg err "Could not switch to prefork MPM, not enabling php5"
+       return 1
+    }
+
+else
+    echo "Warning: Could not load Apache 2.4 maintainer script helper."
+
+    php5_enable() {
+        return 1;
+    }
+
+fi
+
+# we've registered a trigger to handle extension updates.
+if [ "$1" = "triggered" ] && [ "$2" = "@FINKPREFIX@/etc/php5/apache2/conf.d" ]; then
+    if [ -e @FINKPREFIX@/share/apache2/apache2-maintscript-helper ]; then
+	. @FINKPREFIX@/share/apache2/apache2-maintscript-helper
+	apache2_reload restart
+    fi
+    exit 0
+elif [ "$1" != "configure" ]; then
+    exit 0
+fi
diff -ruN php-5.6.7.orig/fink/libapache2-mod-php5filter.postinst.extra php-5.6.7/fink/libapache2-mod-php5filter.postinst.extra
--- php-5.6.7.orig/fink/libapache2-mod-php5filter.postinst.extra	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/libapache2-mod-php5filter.postinst.extra	2013-09-09 09:43:48.000000000 -0600
@@ -0,0 +1,32 @@
+if [ -e @FINKPREFIX@/share/apache2/apache2-maintscript-helper ]; then
+    . @FINKPREFIX@/share/apache2/apache2-maintscript-helper
+
+    php5_enable() {
+       mpm=$(a2query -M)
+       case "$(a2query -M)" in
+           prefork|itk) return 0;;
+           *) if apache2_switch_mpm prefork; then return 0; fi;;
+       esac
+        apache2_msg err "Could not switch to prefork MPM, not enabling php5"
+       return 1
+    }
+
+else
+    echo "Warning: Could not load Apache 2.4 maintainer script helper."
+
+    php5_enable() {
+        return 1;
+    }
+
+fi
+
+# we've registered a trigger to handle extension updates.
+if [ "$1" = "triggered" ] && [ "$2" = "@FINKPREFIX@/etc/php5/apache2/conf.d" ]; then
+    if [ -e @FINKPREFIX@/share/apache2/apache2-maintscript-helper ]; then
+	. @FINKPREFIX@/share/apache2/apache2-maintscript-helper
+	apache2_reload restart
+    fi
+    exit 0
+elif [ "$1" != "configure" ]; then
+    exit 0
+fi
diff -ruN php-5.6.7.orig/fink/libphp5-embed.postrm.extra php-5.6.7/fink/libphp5-embed.postrm.extra
--- php-5.6.7.orig/fink/libphp5-embed.postrm.extra	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/libphp5-embed.postrm.extra	2013-09-09 20:31:13.000000000 -0600
@@ -0,0 +1 @@
+#[ "$1" = "remove" ] && ldconfig
diff -ruN php-5.6.7.orig/fink/patches/dtrace-extern.patch php-5.6.7/fink/patches/dtrace-extern.patch
--- php-5.6.7.orig/fink/patches/dtrace-extern.patch	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/patches/dtrace-extern.patch	2014-02-06 09:14:06.000000000 -0700
@@ -0,0 +1,16 @@
+--- php5.orig/Zend/zend_dtrace.h
++++ php5/Zend/zend_dtrace.h
+@@ -30,9 +30,9 @@
+ #endif
+ 
+ #ifdef HAVE_DTRACE
+-ZEND_API zend_op_array *(*zend_dtrace_compile_file)(zend_file_handle *file_handle, int type TSRMLS_DC);
+-ZEND_API void (*zend_dtrace_execute)(zend_op_array *op_array TSRMLS_DC);
+-ZEND_API void (*zend_dtrace_execute_internal)(zend_execute_data *execute_data_ptr, zend_fcall_info *fci, int return_value_used TSRMLS_DC);
++extern ZEND_API zend_op_array *(*zend_dtrace_compile_file)(zend_file_handle *file_handle, int type TSRMLS_DC);
++extern ZEND_API void (*zend_dtrace_execute)(zend_op_array *op_array TSRMLS_DC);
++extern ZEND_API void (*zend_dtrace_execute_internal)(zend_execute_data *execute_data_ptr, zend_fcall_info *fci, int return_value_used TSRMLS_DC);
+ 
+ ZEND_API zend_op_array *dtrace_compile_file(zend_file_handle *file_handle, int type TSRMLS_DC);
+ ZEND_API void dtrace_execute_ex(zend_execute_data *execute_data TSRMLS_DC);
+
diff -ruN php-5.6.7.orig/fink/patches/fink_quirks.patch php-5.6.7/fink/patches/fink_quirks.patch
--- php-5.6.7.orig/fink/patches/fink_quirks.patch	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/patches/fink_quirks.patch	2015-04-29 12:16:56.000000000 -0600
@@ -0,0 +1,269 @@
+Description: Changes to make php use versioned paths and other minor
+ cleanup changes.
+Origin: vendor
+Forwarded: not-needed
+Last-Update: 2010-01-18
+
+--- a/configure.in
++++ b/configure.in
+@@ -1085,7 +1085,7 @@ if test "$PHP_CLI" = "no"; then
+ fi
+ 
+ PHP_ARG_WITH(pear, [whether to install PEAR],
+-[  --with-pear=DIR         Install PEAR in DIR @<:@PREFIX/lib/php@:>@
++[  --with-pear=DIR         Install PEAR in DIR @<:@PREFIX/lib/php5@:>@
+   --without-pear          Do not install PEAR], DEFAULT, yes)
+ 
+ if test "$PHP_PEAR" != "no"; then
+@@ -1115,7 +1115,7 @@ dnl
+   if test "$PHP_PEAR" = "DEFAULT" || test "$PHP_PEAR" = "yes"; then
+     case $PHP_LAYOUT in
+       GNU) PEAR_INSTALLDIR=$datadir/pear;;
+-      *)   PEAR_INSTALLDIR=$libdir/php;;
++      *)   PEAR_INSTALLDIR=$libdir/php5;;
+     esac
+   fi
+ 
+@@ -1170,12 +1170,12 @@ test "$program_suffix" = "NONE" && progr
+ 
+ case $libdir in
+   '${exec_prefix}/lib')
+-    libdir=$libdir/php
++    libdir=$libdir/php5
+     ;;
+ esac
+ case `eval echo $datadir` in
+   '${prefix}/share')
+-    datadir=$datadir/php
++    datadir=$datadir/php5
+     ;;
+ esac
+ 
+@@ -1242,7 +1242,7 @@ EXPANDED_SYSCONFDIR=`eval echo $sysconfd
+ EXPANDED_DATADIR=$datadir
+ EXPANDED_PHP_CONFIG_FILE_PATH=`eval echo "$PHP_CONFIG_FILE_PATH"`
+ EXPANDED_PHP_CONFIG_FILE_SCAN_DIR=`eval echo "$PHP_CONFIG_FILE_SCAN_DIR"`
+-INCLUDE_PATH=.:$EXPANDED_PEAR_INSTALLDIR
++INCLUDE_PATH=.:$EXPANDED_PEAR_INSTALLDIR:/usr/share/pear
+ 
+ exec_prefix=$old_exec_prefix
+ libdir=$old_libdir
+--- a/ext/ext_skel
++++ b/ext/ext_skel
+@@ -70,7 +70,7 @@ if test -d "$extname" ; then
+ fi
+ 
+ if test -z "$skel_dir"; then
+-  skel_dir="skeleton"
++  skel_dir="@FINKPREFIX@/lib/php5/skeleton"
+ fi
+ 
+ ## convert skel_dir to full path
+--- a/php.ini-development
++++ b/php.ini-development
+@@ -708,7 +708,7 @@ default_mimetype = "UTF-8"
+ ;;;;;;;;;;;;;;;;;;;;;;;;;
+ 
+ ; UNIX: "/path1:/path2"
+-;include_path = ".:/php/includes"
++;include_path = ".:@FINKPREFIX@/share/php"
+ ;
+ ; Windows: "\path1;\path2"
+ ;include_path = ".;c:\php\includes"
+--- a/php.ini-production
++++ b/php.ini-production
+@@ -708,7 +708,7 @@ default_mimetype = "UTF-8"
+ ;;;;;;;;;;;;;;;;;;;;;;;;;
+ 
+ ; UNIX: "/path1:/path2"
+-;include_path = ".:/php/includes"
++;include_path = ".:@FINKPREFIX@/share/php"
+ ;
+ ; Windows: "\path1;\path2"
+ ;include_path = ".;c:\php\includes"
+@@ -869,49 +869,6 @@ default_socket_timeout = 60
+ ; If you only provide the name of the extension, PHP will look for it in its
+ ; default extension directory.
+ ;
+-; Windows Extensions
+-; Note that ODBC support is built in, so no dll is needed for it.
+-; Note that many DLL files are located in the extensions/ (PHP 4) ext/ (PHP 5)
+-; extension folders as well as the separate PECL DLL download (PHP 5).
+-; Be sure to appropriately set the extension_dir directive.
+-;
+-;extension=php_bz2.dll
+-;extension=php_curl.dll
+-;extension=php_fileinfo.dll
+-;extension=php_gd2.dll
+-;extension=php_gettext.dll
+-;extension=php_gmp.dll
+-;extension=php_intl.dll
+-;extension=php_imap.dll
+-;extension=php_interbase.dll
+-;extension=php_ldap.dll
+-;extension=php_mbstring.dll
+-;extension=php_exif.dll      ; Must be after mbstring as it depends on it
+-;extension=php_mysql.dll
+-;extension=php_mysqli.dll
+-;extension=php_oci8_12c.dll  ; Use with Oracle Database 12c Instant Client
+-;extension=php_openssl.dll
+-;extension=php_pdo_firebird.dll
+-;extension=php_pdo_mysql.dll
+-;extension=php_pdo_oci.dll
+-;extension=php_pdo_odbc.dll
+-;extension=php_pdo_pgsql.dll
+-;extension=php_pdo_sqlite.dll
+-;extension=php_pgsql.dll
+-;extension=php_pspell.dll
+-;extension=php_shmop.dll
+-
+-; The MIBS data available in the PHP distribution must be installed. 
+-; See http://www.php.net/manual/en/snmp.installation.php 
+-;extension=php_snmp.dll
+-
+-;extension=php_soap.dll
+-;extension=php_sockets.dll
+-;extension=php_sqlite3.dll
+-;extension=php_sybase_ct.dll
+-;extension=php_tidy.dll
+-;extension=php_xmlrpc.dll
+-;extension=php_xsl.dll
+ 
+ ;;;;;;;;;;;;;;;;;;;
+ ; Module Settings ;
+--- a/sapi/caudium/config.m4
++++ b/sapi/caudium/config.m4
+@@ -26,8 +26,8 @@ if test "$PHP_CAUDIUM" != "no"; then
+     AC_MSG_ERROR([Could not find a pike in $PHP_CAUDIUM/bin/])
+   fi
+   if $PIKE -e 'float v; int rel;sscanf(version(), "Pike v%f release %d", v, rel);v += rel/10000.0; if(v < 7.0268) exit(1); exit(0);'; then
+-    PIKE_MODULE_DIR=`$PIKE --show-paths 2>&1| grep '^Module' | sed -e 's/.*: //'`
+-    PIKE_INCLUDE_DIR=`echo $PIKE_MODULE_DIR | sed -e 's,lib/pike/modules,include/pike,' -e 's,lib/modules,include/pike,' `
++    PIKE_MODULE_DIR=`$PIKE --show-paths 2>&1| grep '^Master file' | sed -e 's/.*: //' -e 's/master.pike/modules/'`
++    PIKE_INCLUDE_DIR=`echo $PIKE_MODULE_DIR | sed -e 's,lib/modules,,' -e 's,modules,include,' `
+     if test -z "$PIKE_INCLUDE_DIR" || test -z "$PIKE_MODULE_DIR"; then
+       AC_MSG_ERROR(Failed to figure out Pike module and include directories)
+     fi
+@@ -84,7 +84,9 @@ if test "$PHP_CAUDIUM" != "no"; then
+   PIKE_VERSION=`$PIKE -e 'string v; int rel;sscanf(version(), "Pike v%s release %d", v, rel); write(v+"."+rel);'`   
+   AC_DEFINE(HAVE_CAUDIUM,1,[Whether to compile with Caudium support])
+   PHP_SELECT_SAPI(caudium, shared, caudium.c)
+-  INSTALL_IT="\$(INSTALL) -m 0755 $SAPI_SHARED $PHP_CAUDIUM/lib/$PIKE_VERSION/PHP5.so"
++  dnl FIXME: This is the ugliest hack in the world!
++  dnl INSTALL_IT="\$(mkinstalldirs) \$(INSTALL_ROOT)$PHP_CAUDIUM/lib/$PIKE_VERSION/ && \$(INSTALL) -m 0755 $SAPI_SHARED \$(INSTALL_ROOT)$PHP_CAUDIUM/lib/$PIKE_VERSION/php5.so"
++  INSTALL_IT="\$(mkinstalldirs) \$(INSTALL_ROOT)$PHP_CAUDIUM/lib/$PIKE_VERSION/ && \$(INSTALL) -m 0755 .$SAPI_SHARED \$(INSTALL_ROOT)$PHP_CAUDIUM/lib/$PIKE_VERSION/PHP5.so"
+   RESULT="  *** Pike binary used:         $PIKE
+   *** Pike include dir(s) used: $PIKE_INCLUDE_DIR
+   *** Pike version:             $PIKE_VERSION"
+--- a/sapi/cli/php.1.in
++++ b/sapi/cli/php.1.in
+@@ -365,13 +365,14 @@ Shows configuration for extension
+ Show configuration file names
+ .SH FILES
+ .TP 15
+-.B php\-cli.ini
++.B @FINKPREFIX@/etc/php5/cli/php.ini
+ The configuration file for the CLI version of PHP.
+ .TP
+-.B php.ini
+-The standard configuration file will only be used when 
+-.B php\-cli.ini
+-cannot be found.
++.B @FINKPREFIX@/etc/php5/cgi/php.ini
++The configuration file for the CGI version of PHP.
++.TP
++.B @FINKPREFIX@/etc/php5/apache2/php.ini
++The configuration file for the version of PHP that apache2 uses.
+ .SH EXAMPLES
+ .TP 5
+ \fI@program_prefix@php \-r 'echo "Hello World\\n";'\fP
+--- a/scripts/Makefile.frag
++++ b/scripts/Makefile.frag
+@@ -3,8 +3,8 @@
+ # Build environment install
+ #
+ 
+-phpincludedir = $(includedir)/php
+-phpbuilddir = $(libdir)/build
++phpincludedir = $(includedir)/php5
++phpbuilddir = $(prefix)/lib/php5/build
+ 
+ BUILD_FILES = \
+ 	scripts/phpize.m4 \
+--- a/scripts/php-config.in
++++ b/scripts/php-config.in
+@@ -6,9 +6,9 @@ datarootdir="@datarootdir@"
+ exec_prefix="@exec_prefix@"
+ version="@PHP_VERSION@"
+ vernum="@PHP_VERSION_ID@"
+-include_dir="@includedir@/php"
+-includes="-I$include_dir -I$include_dir/main -I$include_dir/TSRM -I$include_dir/Zend -I$include_dir/ext -I$include_dir/ext/date/lib"
+-ldflags="@PHP_LDFLAGS@"
++include_dir="@includedir@/php5"
++includes="-I$include_dir -I$include_dir/main -I$include_dir/TSRM -I$include_dir/Zend -I$include_dir/ext -I$include_dir/ext/date/lib"
++ldflags="-L$prefix/lib/php5 @PHP_LDFLAGS@"
+ libs="@EXTRA_LIBS@"
+ extension_dir='@EXTENSION_DIR@'
+ man_dir=`eval echo @mandir@`
+--- a/scripts/phpize.in
++++ b/scripts/phpize.in
+@@ -4,8 +4,8 @@
+ prefix='@prefix@'
+ datarootdir='@datarootdir@'
+ exec_prefix="`eval echo @exec_prefix@`"
+-phpdir="`eval echo @libdir@`/build"
+-includedir="`eval echo @includedir@`/php"
++phpdir="$prefix/lib/php5/build"
++includedir="$prefix/include/php5"
+ builddir="`pwd`"
+ SED="@SED@"
+ 
+--- php-5.4.3.orig/ext/pdo/config.m4	2012-05-07 23:22:56.000000000 -0600
++++ php-5.4.3.old/ext/pdo/config.m4	2012-06-12 15:33:12.000000000 -0600
+@@ -39,7 +39,7 @@
+ 
+   if test "$ext_shared" = "yes" ; then
+     case $host_alias in
+-      *darwin*)
++      *darwin7*)
+           AC_MSG_ERROR([
+ Due to the way that loadable modules work on OSX/Darwin, you need to
+ compile the PDO package statically into the PHP core.
+--- php-5.4.3.orig/ext/gd/config.m4	2012-05-07 23:22:56.000000000 -0600
++++ php-5.4.3.old/ext/gd/config.m4	2012-06-12 15:46:05.000000000 -0600
+@@ -101,7 +101,7 @@
+ AC_DEFUN([PHP_GD_JPEG],[
+   if test "$PHP_JPEG_DIR" != "no"; then
+ 
+-    for i in $PHP_JPEG_DIR /usr/local /usr; do
++    for i in $PHP_JPEG_DIR @FINKPREFIX@ /usr/local /usr; do
+       test -f $i/include/jpeglib.h && GD_JPEG_DIR=$i && break
+     done
+ 
+@@ -126,7 +126,7 @@
+ AC_DEFUN([PHP_GD_PNG],[
+   if test "$PHP_PNG_DIR" != "no"; then
+ 
+-    for i in $PHP_PNG_DIR /usr/local /usr; do
++    for i in $PHP_PNG_DIR @FINKPREFIX@ /usr/local /usr; do
+       test -f $i/include/png.h && GD_PNG_DIR=$i && break
+     done
+ 
+@@ -159,7 +159,7 @@
+
+     for i in $PHP_XPM_DIR /usr/local /usr/X11R6 /usr; do
+       test -f $i/include/xpm.h && GD_XPM_DIR=$i && GD_XPM_INC=$i && break
+-      test -f $i/include/X11/xpm.h && GD_XPM_DIR=$i && GD_XPM_INC=$i/X11 && break
++      test -f $i/include/X11/xpm.h && GD_XPM_DIR=$i && GD_XPM_INC=$i/include && break
+     done
+
+     if test -z "$GD_XPM_DIR"; then
+@@ -184,7 +184,7 @@
+ AC_DEFUN([PHP_GD_FREETYPE2],[
+   if test "$PHP_FREETYPE_DIR" != "no"; then
+ 
+-    for i in $PHP_FREETYPE_DIR /usr/local /usr; do
++    for i in $PHP_FREETYPE_DIR @FINKPREFIX@ /usr/local /usr; do
+       if test -f "$i/bin/freetype-config"; then
+         FREETYPE2_DIR=$i
+         FREETYPE2_CONFIG="$i/bin/freetype-config"
diff -ruN php-5.6.7.orig/fink/patches/fpm-config.patch php-5.6.7/fink/patches/fpm-config.patch
--- php-5.6.7.orig/fink/patches/fpm-config.patch	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/patches/fpm-config.patch	2015-04-29 10:01:36.000000000 -0600
@@ -0,0 +1,54 @@
+Description: Add major version number to paths and allow process pools
+ to be configured in individual files in @FINKPREFIX@/etc/php5/fpm/pool.d/
+Origin: vendor
+Forwarded: not-needed
+Last-Update: 2010-07-30
+
+--- php5.orig/sapi/fpm/php-fpm.conf.in
++++ php5/sapi/fpm/php-fpm.conf.in
+@@ -12,7 +12,7 @@
+ ; Relative path can also be used. They will be prefixed by:
+ ;  - the global prefix if it's been set (-p argument)
+ ;  - @prefix@ otherwise
+-;include=etc/fpm.d/*.conf
++;include=@EXPANDED_SYSCONFDIR@/php5/fpm/*.conf
+ 
+ ;;;;;;;;;;;;;;;;;;
+ ; Global Options ;
+@@ -22,14 +22,14 @@
+ ; Pid file
+ ; Note: the default prefix is @EXPANDED_LOCALSTATEDIR@
+ ; Default Value: none
+-;pid = run/php-fpm.pid
++pid = @EXPANDED_LOCALSTATEDIR@/run/php5-fpm.pid
+ 
+ ; Error log file
+ ; If it's set to "syslog", log is sent to syslogd instead of being written
+ ; in a local file.
+ ; Note: the default prefix is @EXPANDED_LOCALSTATEDIR@
+ ; Default Value: log/php-fpm.log
+-;error_log = log/php-fpm.log
++error_log = @EXPANDED_LOCALSTATEDIR@/log/php5-fpm.log
+ 
+ ; syslog_facility is used to specify what type of program is logging the
+ ; message. This lets syslogd specify that messages from different facilities
+@@ -124,6 +124,10 @@
+ ; used in logs and stats. There is no limitation on the number of pools which
+ ; FPM can handle. Your system will tell you anyway :)
+ 
++; To configure the pools it is recommended to have one .conf file per
++; pool in the following directory:
++include=@EXPANDED_SYSCONFDIR@/php5/fpm/pool.d/*.conf
++
+ ; Start a new pool named 'www'.
+ ; the variable $pool can we used in any directive and will be replaced by the
+ ; pool name ('www' here)
+@@ -476,7 +480,7 @@ pm.max_spare_servers = 3
+ ; Chdir to this directory at the start.
+ ; Note: relative path can be used.
+ ; Default Value: current directory or / when chroot
+-;chdir = /var/www
++chdir = /
+  
+ ; Redirect worker stdout and stderr into main error log. If not set, stdout and
+ ; stderr will be redirected to /dev/null according to FastCGI specs.
diff -ruN php-5.6.7.orig/fink/patches/giconv_is_inferior.patch php-5.6.7/fink/patches/giconv_is_inferior.patch
--- php-5.6.7.orig/fink/patches/giconv_is_inferior.patch	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/patches/giconv_is_inferior.patch	2013-10-11 11:23:49.000000000 -0600
@@ -0,0 +1,60 @@
+--- php-5.4.3.orig/acinclude.m4	2012-05-07 23:22:56.000000000 -0600
++++ php-5.4.3.old/acinclude.m4	2012-06-12 15:48:09.000000000 -0600
+@@ -2475,14 +2475,14 @@
+   if test "$found_iconv" = "no"; then
+ 
+     for i in $PHP_ICONV /usr/local /usr; do
+-      if test -r $i/include/giconv.h; then
+-        AC_DEFINE(HAVE_GICONV_H, 1, [ ])
++      if test -r $i/include/iconv.h; then
+         ICONV_DIR=$i
+-        iconv_lib_name=giconv
++        iconv_lib_name=iconv
+         break
+-      elif test -r $i/include/iconv.h; then
++      elif test -r $i/include/giconv.h; then
++        AC_DEFINE(HAVE_GICONV_H, 1, [ ])
+         ICONV_DIR=$i
+-        iconv_lib_name=iconv
++        iconv_lib_name=giconv
+         break
+       fi
+     done
+--- php-5.4.3.orig/aclocal.m4	2012-05-08 00:19:30.000000000 -0600
++++ php-5.4.3.old/aclocal.m4	2012-06-12 15:49:10.000000000 -0600
+@@ -2475,14 +2475,14 @@
+   if test "$found_iconv" = "no"; then
+ 
+     for i in $PHP_ICONV /usr/local /usr; do
+-      if test -r $i/include/giconv.h; then
+-        AC_DEFINE(HAVE_GICONV_H, 1, [ ])
++      if test -r $i/include/iconv.h; then
+         ICONV_DIR=$i
+-        iconv_lib_name=giconv
++        iconv_lib_name=iconv
+         break
+-      elif test -r $i/include/iconv.h; then
++      elif test -r $i/include/giconv.h; then
++        AC_DEFINE(HAVE_GICONV_H, 1, [ ])
+         ICONV_DIR=$i
+-        iconv_lib_name=iconv
++        iconv_lib_name=giconv
+         break
+       fi
+     done
+--- php-5.4.3.orig/ext/iconv/config.m4	2012-05-07 23:22:56.000000000 -0600
++++ php-5.4.3.old/ext/iconv/config.m4	2012-06-12 15:50:36.000000000 -0600
+@@ -31,10 +31,10 @@
+     CFLAGS="-I$PHP_ICONV_PREFIX/include $CFLAGS"
+     LDFLAGS="-L$PHP_ICONV_PREFIX/$PHP_LIBDIR $LDFLAGS"
+ 
+-    if test -r "$PHP_ICONV_PREFIX/include/giconv.h"; then
+-      PHP_ICONV_H_PATH="$PHP_ICONV_PREFIX/include/giconv.h"
+-    else
++    if test -r "$PHP_ICONV_PREFIX/include/iconv.h"; then
+       PHP_ICONV_H_PATH="$PHP_ICONV_PREFIX/include/iconv.h"
++    else
++      PHP_ICONV_H_PATH="$PHP_ICONV_PREFIX/include/giconv.h"
+     fi 
+ 
+     AC_MSG_CHECKING([if iconv is glibc's])
diff -ruN php-5.6.7.orig/fink/patches/php-5.2.4-embed.patch php-5.6.7/fink/patches/php-5.2.4-embed.patch
--- php-5.6.7.orig/fink/patches/php-5.2.4-embed.patch	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/patches/php-5.2.4-embed.patch	2015-04-29 12:29:44.000000000 -0600
@@ -0,0 +1,33 @@
+--- a/sapi/embed/config.m4
++++ b/sapi/embed/config.m4
+@@ -12,7 +12,8 @@ if test "$PHP_EMBED" != "no"; then
+   case "$PHP_EMBED" in
+     yes|shared)
+       PHP_EMBED_TYPE=shared
+-      INSTALL_IT="\$(mkinstalldirs) \$(INSTALL_ROOT)\$(prefix)/lib; \$(INSTALL) -m 0755 $SAPI_SHARED \$(INSTALL_ROOT)\$(prefix)/lib"
++      EXTRA_LDFLAGS_DARWIN="-dynamiclib -version-info \$(PHP_MAJOR_VERSION):\$(PHP_MINOR_VERSION) -L@FINKPREFIX@/lib"
++      INSTALL_IT="\$(mkinstalldirs) \$(INSTALL_ROOT)\$(prefix)/lib; \$(LIBTOOL) --mode=install \$(INSTALL) -m 0755 \$(OVERALL_TARGET) \$(INSTALL_ROOT)\$(prefix)/lib"
+       ;;
+     static)
+       PHP_EMBED_TYPE=static
+--- a/Makefile.global	2012-06-12 22:54:23.000000000 -0600
++++ b/Makefile.global	2012-06-15 20:16:37.000000000 -0600
+@@ -16,7 +16,7 @@
+ build-binaries: $(PHP_BINARIES)
+ 
+ libphp$(PHP_MAJOR_VERSION).la: $(PHP_GLOBAL_OBJS) $(PHP_SAPI_OBJS)
+-	$(LIBTOOL) --mode=link $(CC) $(CFLAGS) $(EXTRA_CFLAGS) -rpath $(phptempdir) $(EXTRA_LDFLAGS) $(LDFLAGS) $(PHP_RPATHS) $(PHP_GLOBAL_OBJS) $(PHP_SAPI_OBJS) $(EXTRA_LIBS) $(ZEND_EXTRA_LIBS) -o $@
++	$(LIBTOOL) --mode=link $(CC) $(CFLAGS) $(EXTRA_CFLAGS) -rpath $(prefix)/lib $(EXTRA_LDFLAGS_DARWIN) $(LDFLAGS) $(PHP_RPATHS) $(PHP_GLOBAL_OBJS) $(PHP_SAPI_OBJS) $(EXTRA_LIBS) $(ZEND_EXTRA_LIBS) -o $@
+ 	-@$(LIBTOOL) --silent --mode=install cp $@ $(phptempdir)/$@ >/dev/null 2>&1
+ 
+ libs/libphp$(PHP_MAJOR_VERSION).bundle: $(PHP_GLOBAL_OBJS) $(PHP_SAPI_OBJS)
+--- a/configure.in	2012-06-12 22:54:23.000000000 -0600
++++ b/configure.in	2012-06-16 11:05:07.000000000 -0600
+@@ -1345,6 +1345,7 @@
+ PHP_SUBST_OLD(DEBIAN_PHP_API)
+ PHP_SUBST_OLD(EXTENSION_DIR)
+ PHP_SUBST_OLD(EXTRA_LDFLAGS)
++PHP_SUBST_OLD(EXTRA_LDFLAGS_DARWIN)
+ PHP_SUBST_OLD(EXTRA_LDFLAGS_PROGRAM)
+ PHP_SUBST_OLD(EXTRA_LIBS)
+ PHP_SUBST_OLD(ZEND_EXTRA_LIBS)
diff -ruN php-5.6.7.orig/fink/patches/php-5.3.9-mysqlnd.patch php-5.6.7/fink/patches/php-5.3.9-mysqlnd.patch
--- php-5.6.7.orig/fink/patches/php-5.3.9-mysqlnd.patch	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/patches/php-5.3.9-mysqlnd.patch	2015-04-29 10:04:03.000000000 -0600
@@ -0,0 +1,22 @@
+--- php5.orig/ext/mysqlnd/mysqlnd.c
++++ php5/ext/mysqlnd/mysqlnd.c
+@@ -946,7 +946,7 @@ MYSQLND_METHOD(mysqlnd_conn_data, connec
+ 		if (host_len == sizeof("localhost") - 1 && !strncasecmp(host, "localhost", host_len)) {
+ 			DBG_INF_FMT("socket=%s", socket_or_pipe? socket_or_pipe:"n/a");
+ 			if (!socket_or_pipe) {
+-				socket_or_pipe = "/tmp/mysql.sock";
++				socket_or_pipe = "@FINKPREFIX@/var/run/mysqld/mysqld.sock";
+ 			}
+ 			transport_len = mnd_sprintf(&transport, 0, "unix://%s", socket_or_pipe);
+ 			unix_socket = TRUE;
+--- php5.orig/ext/pdo_mysql/pdo_mysql.c
++++ php5/ext/pdo_mysql/pdo_mysql.c
+@@ -50,7 +50,7 @@ ZEND_DECLARE_MODULE_GLOBALS(pdo_mysql)
+ #  define PDO_MYSQL_UNIX_ADDR PHP_MYSQL_UNIX_SOCK_ADDR
+ # else
+ #  if !PHP_WIN32
+-#   define PDO_MYSQL_UNIX_ADDR "/tmp/mysql.sock"
++#   define PDO_MYSQL_UNIX_ADDR "@FINKPREFIX@/var/run/mysqld/mysqld.sock"
+ #  else
+ #   define PDO_MYSQL_UNIX_ADDR NULL
+ #  endif
diff -ruN php-5.6.7.orig/fink/patches/php-fpm-listen-on-unix-socket.patch php-5.6.7/fink/patches/php-fpm-listen-on-unix-socket.patch
--- php-5.6.7.orig/fink/patches/php-fpm-listen-on-unix-socket.patch	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/patches/php-fpm-listen-on-unix-socket.patch	2015-04-29 10:10:17.000000000 -0600
@@ -0,0 +1,11 @@
+--- php5.orig/sapi/fpm/php-fpm.conf.in
++++ php5/sapi/fpm/php-fpm.conf.in
+@@ -165,7 +165,7 @@ group = @php_fpm_group@
+ ;                            (IPv6 and IPv4-mapped) on a specific port;
+ ;   '/path/to/unix/socket' - to listen on a unix socket.
+ ; Note: This value is mandatory.
+-listen = 127.0.0.1:9000
++listen = @FINKPREFIX@/var/run/php5-fpm.sock
+ 
+ ; Set listen(2) backlog.
+ ; Default Value: 65535 (-1 on FreeBSD and OpenBSD)
diff -ruN php-5.6.7.orig/fink/patches/session_save_path.patch php-5.6.7/fink/patches/session_save_path.patch
--- php-5.6.7.orig/fink/patches/session_save_path.patch	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/patches/session_save_path.patch	2015-04-29 09:57:50.000000000 -0600
@@ -0,0 +1,40 @@
+Description: Set the default session.save_path dir to /var/lib/php5.
+ This is the directory that has been used in Debian to store the
+ session files and is partially protected by dir permissions.
+Origin: vendor
+Forwarded: not-needed
+Last-Update: 2010-05-01
+
+--- php5.orig/ext/session/session.c
++++ php5/ext/session/session.c
+@@ -782,7 +782,7 @@ static ZEND_INI_MH(OnUpdateSmartStr) /*
+ /* {{{ PHP_INI
+  */
+ PHP_INI_BEGIN()
+-	STD_PHP_INI_ENTRY("session.save_path",          "",          PHP_INI_ALL, OnUpdateSaveDir,save_path,          php_ps_globals,    ps_globals)
++	STD_PHP_INI_ENTRY("session.save_path",          "@FINKPREFIX@/var/lib/php5/sessions",          PHP_INI_ALL, OnUpdateSaveDir,save_path,          php_ps_globals,    ps_globals)
+ 	STD_PHP_INI_ENTRY("session.name",               "PHPSESSID", PHP_INI_ALL, OnUpdateName, session_name,       php_ps_globals,    ps_globals)
+ 	PHP_INI_ENTRY("session.save_handler",           "files",     PHP_INI_ALL, OnUpdateSaveHandler)
+ 	STD_PHP_INI_BOOLEAN("session.auto_start",       "0",         PHP_INI_PERDIR, OnUpdateBool,   auto_start,         php_ps_globals,    ps_globals)
+--- php5.orig/php.ini-development
++++ php5/php.ini-development
+@@ -1420,7 +1420,7 @@ session.save_handler = files
+ ; where MODE is the octal representation of the mode. Note that this
+ ; does not overwrite the process's umask.
+ ; http://php.net/session.save-path
+-;session.save_path = "/tmp"
++;session.save_path = "@FINKPREFIX@/var/lib/php5/sessions"
+ 
+ ; Whether to use strict session mode.
+ ; Strict session mode does not accept uninitialized session ID and regenerate
+--- php5.orig/php.ini-production
++++ php5/php.ini-production
+@@ -1371,7 +1371,7 @@ session.save_handler = files
+ ; where MODE is the octal representation of the mode. Note that this
+ ; does not overwrite the process's umask.
+ ; http://php.net/session.save-path
+-;session.save_path = "/tmp"
++;session.save_path = "@FINKPREFIX@/var/lib/php5/sessions"
+ 
+ ; Whether to use strict session mode.
+ ; Strict session mode does not accept uninitialized session ID and regenerate
diff -ruN php-5.6.7.orig/fink/php5-cgi.conf php-5.6.7/fink/php5-cgi.conf
--- php-5.6.7.orig/fink/php5-cgi.conf	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-cgi.conf	2015-04-29 10:13:16.000000000 -0600
@@ -0,0 +1,35 @@
+# This file replaces old system MIME types and sets them only in the
+# Apache webserver
+
+# application/x-httpd-php                        phtml pht php
+# application/x-httpd-php3                       php3
+# application/x-httpd-php4                       php4
+# application/x-httpd-php5                       php
+<FilesMatch ".+\.ph(p[345]?|t|tml)$">
+    SetHandler application/x-httpd-php
+</FilesMatch>
+# application/x-httpd-php-source                 phps
+<FilesMatch ".+\.phps$">
+    SetHandler application/x-httpd-php-source
+    # Deny access to raw php sources by default
+    # To re-enable it's recommended to enable access to the files
+    # only in specific virtual host or directory
+    Require all denied
+</FilesMatch>
+# Deny access to files without filename (e.g. '.php')
+<FilesMatch "^\.ph(p[345]?|t|tml|ps)$">
+    Require all denied
+</FilesMatch>
+
+# To enable PHP CGI site-wide, just uncomment following lines, however
+# as a security measure, it's recommended to enable PHP just in the
+# specific virtual servers or just specific directories
+
+#ScriptAlias /cgi-bin/ @FINKPREFIX@/lib/cgi-bin/
+#<Directory "@FINKPREFIX@/lib/cgi-bin">
+#    AllowOverride None
+#    Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch
+#    Order allow,deny
+#    Allow from all
+#</Directory>
+#Action application/x-httpd-php /cgi-bin/php5
diff -ruN php-5.6.7.orig/fink/php5-cgi.postinst.extra php-5.6.7/fink/php5-cgi.postinst.extra
--- php-5.6.7.orig/fink/php5-cgi.postinst.extra	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-cgi.postinst.extra	2013-08-13 10:43:47.000000000 -0600
@@ -0,0 +1,25 @@
+dpkg-maintscript-helper mv_conffile @FINKPREFIX@/etc/apache2/mods-available/php5_cgi.conf \
+    @FINKPREFIX@/etc/apache2/conf-available/php5-cgi.conf 5.5.0~beta4-1 -- "$@"
+
+dpkg-maintscript-helper rm_conffile @FINKPREFIX@/etc/apache2/mods-available/php5_cgi.load 5.5.0~beta4-1 -- "$@"
+
+VERSION=$2
+
+php5_enable() {
+    # Enable php5-cgi only if upgrading from older versions of php5-cgi
+    if [ -n "$VERSION" ] && dpkg --compare-versions "$VERSION" lt 5.4.4-5; then
+	return 0
+    else
+	return 1
+    fi
+}
+
+if [ "$1" = "configure" ]; then
+    update-alternatives \
+	--install @FINKPREFIX@/bin/php-cgi php-cgi @FINKPREFIX@/bin/php5-cgi 50 \
+	--slave @FINKPREFIX@/share/man/man1/php-cgi.1 php-cgi.1 \
+	@FINKPREFIX@/share/man/man1/php5-cgi.1
+
+    update-alternatives \
+	--install @FINKPREFIX@/lib/cgi-bin/php php-cgi-bin @FINKPREFIX@/lib/cgi-bin/php5 50
+fi
diff -ruN php-5.6.7.orig/fink/php5-cgi.postrm.extra php-5.6.7/fink/php5-cgi.postrm.extra
--- php-5.6.7.orig/fink/php5-cgi.postrm.extra	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-cgi.postrm.extra	2013-08-13 10:44:08.000000000 -0600
@@ -0,0 +1,2 @@
+dpkg-maintscript-helper mv_conffile @FINKPREFIX@/etc/apache2/mods-available/php5_cgi.conf @FINKPREFIX@/etc/apache2/conf-available/php5-cgi.conf 5.5.0~beta4-1 -- "$@"
+dpkg-maintscript-helper rm_conffile @FINKPREFIX@/etc/apache2/mods-available/php5_cgi.load 5.5.0~beta4-1 -- "$@"
diff -ruN php-5.6.7.orig/fink/php5-cgi.prerm.extra php-5.6.7/fink/php5-cgi.prerm.extra
--- php-5.6.7.orig/fink/php5-cgi.prerm.extra	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-cgi.prerm.extra	2013-08-13 10:44:20.000000000 -0600
@@ -0,0 +1,4 @@
+if [ "$1" = "remove" ]; then
+    update-alternatives --remove php-cgi @FINKPREFIX@/bin/php5-cgi
+    update-alternatives --remove php-cgi-bin @FINKPREFIX@/lib/cgi-bin/php5
+fi
diff -ruN php-5.6.7.orig/fink/php5-cli.postinst.extra php-5.6.7/fink/php5-cli.postinst.extra
--- php-5.6.7.orig/fink/php5-cli.postinst.extra	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-cli.postinst.extra	2013-08-13 10:44:42.000000000 -0600
@@ -0,0 +1,5 @@
+if [ "$1" = "configure" ]; then
+    update-alternatives \
+	--install @FINKPREFIX@/bin/php php @FINKPREFIX@/bin/php5 50 \
+	--slave @FINKPREFIX@/share/man/man1/php.1 php.1 @FINKPREFIX@/share/man/man1/php5.1
+fi
diff -ruN php-5.6.7.orig/fink/php5-cli.prerm.extra php-5.6.7/fink/php5-cli.prerm.extra
--- php-5.6.7.orig/fink/php5-cli.prerm.extra	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-cli.prerm.extra	2013-08-13 10:44:50.000000000 -0600
@@ -0,0 +1,3 @@
+if [ "$1" = "remove" -o "$1" = "deconfigure" ]; then
+    update-alternatives --remove php @FINKPREFIX@/bin/php5
+fi
diff -ruN php-5.6.7.orig/fink/php5-common.php5.cron.d php-5.6.7/fink/php5-common.php5.cron.d
--- php-5.6.7.orig/fink/php5-common.php5.cron.d	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-common.php5.cron.d	2015-04-29 10:16:09.000000000 -0600
@@ -0,0 +1,14 @@
+# @FINKPREFIX@/etc/cron.d/php5: crontab fragment for php5
+#  This purges session files in session.save_path older than X,
+#  where X is defined in seconds as the largest value of
+#  session.gc_maxlifetime from all your SAPI php.ini files
+#  or 24 minutes if not defined.  The script triggers only
+#  when session.save_handler=files.
+#
+#  WARNING: The scripts tries hard to honour all relevant
+#  session PHP options, but if you do something unusual
+#  you have to disable this script and take care of your
+#  sessions yourself.
+
+# Look for and purge old sessions every 30 minutes
+09,39 *     * * *     root   [ -x @FINKPREFIX@/lib/php5/sessionclean ] && @FINKPREFIX@/lib/php5/sessionclean
diff -ruN php-5.6.7.orig/fink/php5-common.postinst.extra php-5.6.7/fink/php5-common.postinst.extra
--- php-5.6.7.orig/fink/php5-common.postinst.extra	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-common.postinst.extra	2013-08-13 10:58:28.000000000 -0600
@@ -0,0 +1,10 @@
+for sapi in apache2 apache2filter cli cgi embed fpm; do
+    CONFDIR=@FINKPREFIX@/etc/php5/$sapi/conf.d
+
+    if [ -L $CONFDIR ]; then
+	rm $CONFDIR
+	mkdir $CONFDIR
+    fi
+done
+
+chmod 01733 @FINKPREFIX@/var/lib/php5
diff -ruN php-5.6.7.orig/fink/php5-common.postrm.extra php-5.6.7/fink/php5-common.postrm.extra
--- php-5.6.7.orig/fink/php5-common.postrm.extra	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-common.postrm.extra	2013-08-13 10:45:04.000000000 -0600
@@ -0,0 +1 @@
+[ "$1" = "purge" ] && rm -rf @FINKPREFIX@/var/lib/php5
diff -ruN php-5.6.7.orig/fink/php5-common.preinst.extra php-5.6.7/fink/php5-common.preinst.extra
--- php-5.6.7.orig/fink/php5-common.preinst.extra	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-common.preinst.extra	2013-08-13 10:45:22.000000000 -0600
@@ -0,0 +1,4 @@
+if [ -d @FINKPREFIX@/var/lib/php5/module/ ]; then
+   cp -a @FINKPREFIX@/var/lib/php5/module/ @FINKPREFIX@/var/lib/php5/modules/
+   rm -rf @FINKPREFIX@/var/lib/php5/module/
+fi
diff -ruN php-5.6.7.orig/fink/php5-fpm-checkconf php-5.6.7/fink/php5-fpm-checkconf
--- php-5.6.7.orig/fink/php5-fpm-checkconf	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-fpm-checkconf	2013-08-16 16:49:50.000000000 -0600
@@ -0,0 +1,9 @@
+#!/bin/sh
+set -e
+errors=$(@FINKPREFIX@/sbin/php5-fpm --fpm-config @FINKPREFIX@/etc/php5/fpm/php-fpm.conf -t 2>&1 | grep "\[ERROR\]" || true);
+if [ -n "${errors}" ]; then
+    echo "Please fix your configuration file..."
+    echo ${errors}
+    exit 1
+fi
+exit 0
diff -ruN php-5.6.7.orig/fink/php5-fpm-reopenlogs php-5.6.7/fink/php5-fpm-reopenlogs
--- php-5.6.7.orig/fink/php5-fpm-reopenlogs	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-fpm-reopenlogs	2015-04-29 10:21:17.000000000 -0600
@@ -0,0 +1,7 @@
+#!/bin/sh
+CONFFILE=@FINKPREFIX@/etc/php5/fpm/php-fpm.conf
+[ -r @FINKPREFIX@/etc/default/php5-fpm ] && . @FINKPREFIX@/etc/default/php5-fpm
+CONF_PIDFILE=$(sed -n 's/^[[:space:]]*pid[[:space:]]*=[[:space:]]*//p' $CONFFILE)
+PIDFILE=${CONF_PIDFILE:-/run/php5-fpm.pid}
+[ -r "$PIDFILE" ] && kill -USR1 $(cat "$PIDFILE") > /dev/null
+exit 0
diff -ruN php-5.6.7.orig/fink/php5-fpm.init php-5.6.7/fink/php5-fpm.init
--- php-5.6.7.orig/fink/php5-fpm.init	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-fpm.init	2015-04-29 10:19:38.000000000 -0600
@@ -0,0 +1,168 @@
+#!/bin/sh
+### BEGIN INIT INFO
+# Provides:          php-fpm php5-fpm
+# Required-Start:    $remote_fs $network
+# Required-Stop:     $remote_fs $network
+# Default-Start:     2 3 4 5
+# Default-Stop:      0 1 6	
+# Short-Description: starts php5-fpm
+# Description:       Starts The PHP FastCGI Process Manager Daemon
+### END INIT INFO
+
+# Author: Ondrej Sury <ondrej@debian.org>
+
+PATH=@FINKPREFIX@/sbin:@FINKPREFIX@/bin
+DESC="PHP5 FastCGI Process Manager"
+NAME=php5-fpm
+DAEMON=@FINKPREFIX@/sbin/$NAME
+DAEMON_ARGS="--daemonize --fpm-config @FINKPREFIX@/etc/php5/fpm/php-fpm.conf"
+CONF_PIDFILE=$(sed -n 's/^pid[ =]*//p' @FINKPREFIX@/etc/php5/fpm/php-fpm.conf)
+PIDFILE=${CONF_PIDFILE:-/run/php5-fpm.pid}
+TIMEOUT=30
+SCRIPTNAME=@FINKPREFIX@/sbin/${NAME}ctl
+
+# Exit if the package is not installed
+[ -x "$DAEMON" ] || exit 0
+
+# Read configuration variable file if it is present
+[ -r @FINKPREFIX@/etc/default/$NAME ] && . @FINKPREFIX@/etc/default/$NAME
+
+#
+# Function to check the correctness of the config file
+#
+do_check()
+{
+    @FINKPREFIX@/lib/php5/php5-fpm-checkconf || return 1
+    return 0
+}
+
+#
+# Function that starts the daemon/service
+#
+do_start()
+{
+	# Return
+	#   0 if daemon has been started
+	#   1 if daemon was already running
+	#   2 if daemon could not be started
+	start-stop-daemon --start --quiet --pidfile $PIDFILE --exec $DAEMON --test > /dev/null \
+		|| return 1
+	start-stop-daemon --start --quiet --pidfile $PIDFILE --exec $DAEMON -- \
+		$DAEMON_ARGS 2>/dev/null \
+		|| return 2
+	# Add code here, if necessary, that waits for the process to be ready
+	# to handle requests from services started subsequently which depend
+	# on this one.  As a last resort, sleep for some time.
+}
+
+#
+# Function that stops the daemon/service
+#
+do_stop()
+{
+	# Return
+	#   0 if daemon has been stopped
+	#   1 if daemon was already stopped
+	#   2 if daemon could not be stopped
+	#   other if a failure occurred
+	start-stop-daemon --stop --quiet --retry=QUIT/$TIMEOUT/TERM/5/KILL/5 --pidfile $PIDFILE --name $NAME
+	RETVAL="$?"
+	[ "$RETVAL" = 2 ] && return 2
+	# Wait for children to finish too if this is a daemon that forks
+	# and if the daemon is only ever run from this initscript.
+	# If the above conditions are not satisfied then add some other code
+	# that waits for the process to drop all resources that could be
+	# needed by services started subsequently.  A last resort is to
+	# sleep for some time.
+	start-stop-daemon --stop --quiet --oknodo --retry=0/30/TERM/5/KILL/5 --exec $DAEMON
+	[ "$?" = 2 ] && return 2
+	# Many daemons don't delete their pidfiles when they exit.
+	rm -f $PIDFILE
+	return "$RETVAL"
+}
+
+#
+# Function that sends a SIGHUP to the daemon/service
+#
+do_reload() {
+	#
+	# If the daemon can reload its configuration without
+	# restarting (for example, when it is sent a SIGHUP),
+	# then implement that here.
+	#
+	start-stop-daemon --stop --signal USR2 --quiet --pidfile $PIDFILE --name $NAME
+	return 0
+}
+
+case "$1" in
+    start)
+	[ "$VERBOSE" != no ] && echo -n "Starting $DESC "
+	do_check $VERBOSE
+	case "$?" in
+	    0)
+		do_start
+		case "$?" in
+		    0|1) [ "$VERBOSE" != no ] && echo "OK" ;;
+		    2) [ "$VERBOSE" != no ] && echo "Fail" ;;
+		esac
+		;;
+	    1) [ "$VERBOSE" != no ] && echo "Fail" ;;
+	esac
+	;;
+    stop)
+	[ "$VERBOSE" != no ] && echo -n "Stopping $DESC "
+	do_stop
+	case "$?" in
+		0|1) [ "$VERBOSE" != no ] && echo "OK" ;;
+		2) [ "$VERBOSE" != no ] && echo "Fail" ;;
+	esac
+	;;
+    status)
+        status_of_proc "$DAEMON" "$NAME" && exit 0 || exit $?
+        ;;
+    check)
+        do_check yes
+	;;
+    reload|force-reload)
+	echo "Reloading $DESC "
+	do_reload
+	case "$?" in
+		0|1) echo "OK" ;;
+		2) echo "Fail" ;;
+	esac
+	;;
+    reopen-logs)
+	echo "Reopening $DESC logs "
+	if start-stop-daemon --stop --signal USR1 --oknodo --quiet \
+	    --pidfile $PIDFILE --exec $DAEMON
+	then
+	    echo "Fail"
+	else
+	    echo "OK"
+	fi
+	;;
+    restart)
+	echo "Restarting $DESC "
+	do_stop
+	case "$?" in
+	  0|1)
+		do_start
+		case "$?" in
+			0) echo "OK" ;;
+			1) echo "Fail" ;; # Old process is still running
+			*) echo "Fail" ;; # Failed to start
+		esac
+		;;
+	  *)
+	  	# Failed to stop
+		echo "Fail"
+		;;
+	esac
+	;;
+    *)
+	echo "Usage: $SCRIPTNAME {start|stop|status|restart|reload|force-reload}" >&2
+	exit 1
+    ;;
+esac
+
+:
diff -ruN php-5.6.7.orig/fink/php5-fpm.logrotate php-5.6.7/fink/php5-fpm.logrotate
--- php-5.6.7.orig/fink/php5-fpm.logrotate	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-fpm.logrotate	2015-04-29 10:20:22.000000000 -0600
@@ -0,0 +1,11 @@
+@FINKPREFIX@/var/log/php5-fpm.log {
+	rotate 12
+	weekly
+	missingok
+	notifempty
+	compress
+	delaycompress
+	postrotate
+		@FINKPREFIX@/lib/php5/php5-fpm-reopenlogs
+	endscript
+}
diff -ruN php-5.6.7.orig/fink/php5-fpm.postinst.extra php-5.6.7/fink/php5-fpm.postinst.extra
--- php-5.6.7.orig/fink/php5-fpm.postinst.extra	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-fpm.postinst.extra	2013-08-13 10:45:37.000000000 -0600
@@ -0,0 +1,5 @@
+if [ "$1" = "triggered" ] && [ "$2" = "@FINKPREFIX@/etc/php5/fpm/conf.d" ]; then
+    invoke-rc.d php5-fpm restart
+fi
+
+dpkg-maintscript-helper mv_conffile @FINKPREFIX@/etc/php5/fpm/main.conf @FINKPREFIX@/etc/php5/fpm/php-fpm.conf 5.3.5-1 -- "$@"
diff -ruN php-5.6.7.orig/fink/php5-fpm.postrm.extra php-5.6.7/fink/php5-fpm.postrm.extra
--- php-5.6.7.orig/fink/php5-fpm.postrm.extra	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-fpm.postrm.extra	2013-08-13 10:45:47.000000000 -0600
@@ -0,0 +1 @@
+dpkg-maintscript-helper mv_conffile @FINKPREFIX@/etc/php5/fpm/main.conf @FINKPREFIX@/etc/php5/fpm/php-fpm.conf 5.3.5-1 -- "$@"
diff -ruN php-5.6.7.orig/fink/php5-helper php-5.6.7/fink/php5-helper
--- php-5.6.7.orig/fink/php5-helper	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-helper	2013-08-13 10:22:36.000000000 -0600
@@ -0,0 +1,210 @@
+#!/bin/sh
+#
+#  php5enmod - a php5 module manager for Debian/Fink
+#
+#  Copyright 2013 Ondřej Surý <ondrej@sury.org>
+#
+# This program is licensed at your choice under the terms of the GNU General
+# Public License version 2+ or under the terms of the PHP License 3.01.
+#
+# For GPL-2+:
+# This program is free software; you can redistribute it and/or
+# modify it under the terms of the GNU General Public License
+# as published by the Free Software Foundation; either version 2
+# of the License, or (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301,
+# USA.
+#
+# For PHP 3.01:
+# This source file is subject to version 3.01 of the PHP license,
+# that is bundled with this package in the file LICENSE, and is
+# available through the world-wide-web at the following url:
+# http://www.php.net/license/3_01.txt
+# If you did not receive a copy of the PHP license and are unable to
+# obtain it through the world-wide-web, please send a note to
+# license@php.net so we can mail you a copy immediately.
+#
+
+warning() {
+    echo "WARNING: ${@}" >&2
+}
+
+remove_state() {
+    local action=$1
+    local sapi=$2
+    local modname=$3
+
+    local state_dir="$(get_state_dir $sapi)"
+    rm -f "${state_dir}/${action}_by_admin/$modname"
+    rm -f "${state_dir}/${action}_by_maint/$modname"
+
+    return 0
+}
+
+mod_registry() {
+    local action=$1
+    local modname=$2
+    local registry_dir="$(get_registry_dir)"
+    local registry_file="$registry_dir/$modname"
+
+    case $action in
+	register)
+	    if [ ! -d "$registry_dir" ]; then
+		mkdir -p "$registry_dir"
+	    fi
+	    touch "$registry_file"
+	    ;;
+	unregister)
+	    rm -f "$registry_file"
+	    ;;
+	status)
+	    if [ -e "$registry_file" ]; then
+		return 0
+	    else
+		return 1
+	    fi
+	    ;;
+	*)
+	    return 1
+	    ;;
+    esac
+
+    return 0
+}
+
+record_state() {
+    local action=$1
+    local sapi=$2
+    local modname=$3
+
+    local state_dir="@FINKPREFIX@/var/lib/php5/modules/${sapi}"
+    local admin_state="${state_dir}/${action}_by_admin/$modname"
+    local maint_state="${state_dir}/${action}_by_maint/$modname"
+
+    if [ -e "$admin_state" ]; then
+	return
+    fi
+
+    if [ -e "$maint_state" ]; then
+	if [ "$MAINT_MODE" = "yes" ]; then
+	    return
+	else
+	    rm "$maint_state"
+	fi
+    fi
+
+    # cleanup previous state
+    remove_state disabled $sapi $modname
+    remove_state enabled $sapi $modname
+
+    if [ "$MAINT_MODE" = "yes" ]; then
+	mkdir -p "$(dirname $maint_state)"
+	touch "$maint_state"
+    else
+	mkdir -p "$(dirname $admin_state)"
+	touch "$admin_state"
+    fi
+
+    return 0
+}
+
+output() {
+    if [ "$QUIET" != "yes" ]; then
+	echo "$@"
+    fi
+}
+
+get_priority() {
+    local sapi=$1
+    local modname=$2
+
+    local source_ini="@FINKPREFIX@/etc/php5/mods-available/${modname}.ini"
+
+    module_ret=0
+    module_exists $modname || module_ret=$?
+
+    if [ "$module_ret" -eq 0 ]; then
+	priority=$(sed -ne "s/^; priority=\([0-9]\+\)$/\\1/p" $source_ini)
+	[ -z "$priority" ] && priority=20
+	echo $priority
+	return 0
+    fi
+
+    return $module_ret
+}
+
+get_live_link() {
+    local sapi=$1
+    local modname=$2
+    local priority=$3
+    echo "@FINKPREFIX@/etc/php5/$sapi/conf.d/$priority-$modname.ini"
+}
+
+get_live_link_content() {
+    local sapi=$1
+    local modname=$2
+    local priority=$3
+    echo "../../mods-available/$modname.ini"
+}
+
+module_exists() {
+    local modname=$1
+    local source_ini="@FINKPREFIX@/etc/php5/mods-available/${modname}.ini"
+
+    if [ ! -r "${source_ini}" ]; then
+	return 1
+    fi
+    return 0
+}
+
+module_cleanup() {
+    local sapi=$1
+    local modname=$2
+    local priority=$3
+
+    if [ -L "@FINKPREFIX@/etc/php5/conf.d/$priority-$modname.ini" ]; then
+	rm "@FINKPREFIX@/etc/php5/conf.d/$priority-$modname.ini";
+    fi
+}
+
+get_state_dir() {
+    local sapi=$1
+    echo "@FINKPREFIX@/var/lib/php5/modules/$sapi"
+    return 0
+}
+
+get_registry_dir() {
+    echo "@FINKPREFIX@/var/lib/php5/modules/registry"
+    return 0
+}
+
+get_sapi_dir() {
+    echo "@FINKPREFIX@/share/php5/sapi"
+    return 0
+}
+
+list_parts() {
+    local dir=$1
+    local regex=${2:-}
+    local args="! ( -name '*.dpkg-old' -name '*.dpkg-new' -name '*.dpkg-dist' -name '*~' -name '*.bak' -name '*.ucf-old' -name '*.ucf-new' -name '*.ucf-dist' -name '*%' )"
+
+    if [ -d "$dir" ]; then
+	if [ -n "$regex" ]; then
+	    args="${args} -regex '$regex'"
+	fi
+	for i in $(find "$dir" -mindepth 1 -maxdepth 1 $args); do
+		echo $(basename ${i})
+	done
+	return $?
+    else
+	return 1
+    fi    
+}
diff -ruN php-5.6.7.orig/fink/php5-module.postinst php-5.6.7/fink/php5-module.postinst
--- php-5.6.7.orig/fink/php5-module.postinst	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-module.postinst	2013-08-13 10:48:28.000000000 -0600
@@ -0,0 +1,38 @@
+#!/bin/sh
+
+set -e
+
+#EXTRA#
+
+if [ "$1" = "configure" ]; then
+    inidir=@FINKPREFIX@/etc/php5/mods-available
+
+    if [ -e @FINKPREFIX@/share/php5/php5-maintscript-helper ] ; then
+	. @FINKPREFIX@/share/php5/php5-maintscript-helper
+
+	for dsoname in @modules@; do
+	    inifile=${dsoname}.ini
+
+	    # Register new conffile with UCF
+	    ucf @FINKPREFIX@/share/php5/@package@/${inifile} ${inidir}/${inifile}
+	    ucfr --force php5-@package@ ${inidir}/${inifile}
+
+	    # Move pre-extension manager conffile
+	    dpkg-maintscript-helper mv_conffile @FINKPREFIX@/etc/php5/conf.d/${inifile} ${inidir}/${inifile} 5.4.0~rc6-1 -- "$@";
+
+	    if [ -f "${inidir}/${inifile}.dpkg-new" ]; then
+		md5sum="$(md5sum ${inidir}/${inifile}.dpkg-new | sed -e 's/ .*//')"
+		old_md5sum="$(md5sum ${inidir}/${inifile} | sed -e 's/ .*//')"
+		if [ "$md5sum" = "$old_md5sum" ]; then
+		    mv "${inidir}/${inifile}.dpkg-new" "${inidir}/${inifile}"
+		fi
+	    fi
+	
+	    php5_invoke enmod ALL ${dsoname}
+	done
+    fi
+fi
+
+#DEBHELPER#
+
+exit 0
diff -ruN php-5.6.7.orig/fink/php5-module.postrm php-5.6.7/fink/php5-module.postrm
--- php-5.6.7.orig/fink/php5-module.postrm	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-module.postrm	2013-08-13 10:48:55.000000000 -0600
@@ -0,0 +1,45 @@
+#!/bin/sh
+
+set -e
+
+#EXTRA#
+
+inidir=@FINKPREFIX@/etc/php5/mods-available
+for dsoname in @modules@; do
+    inifile=${dsoname}.ini
+
+    dpkg-maintscript-helper mv_conffile @FINKPREFIX@/etc/php5/conf.d/${inifile} ${inidir}/${inifile} 5.4.0~rc6-1 -- "$@";
+
+    if [ "$1" = "purge" ]; then
+        # Query which package has this conffile registered
+	if which ucfq >/dev/null; then
+	    ucfp=$(ucfq -w ${inidir}/${inifile} | cut -f 2 -d:)
+	fi
+
+        # Only work with the config file if it still belongs to us
+	if test "$ucfp" = php5-@package@; then
+	    for ext in '~' '%' .bak .ucf-new .ucf-old .ucf-dist;  do
+		rm -f ${inidir}/${inifile}${ext}
+	    done
+	    rm -f ${inidir}/${inifile}
+	    if which ucf >/dev/null; then
+		ucf --purge ${inidir}/${inifile}
+	    fi
+	    if which ucfr >/dev/null; then
+		ucfr --purge php5-@package@ ${inidir}/${inifile}
+	    fi
+	fi
+	
+	if [ -e @FINKPREFIX@/share/php5/php5-maintscript-helper ] ; then
+	    . @FINKPREFIX@/share/php5/php5-maintscript-helper
+
+	    for dsoname in @modules@; do
+		php5_invoke dismod ALL ${dsoname}
+	    done
+	fi
+    fi
+done
+
+#DEBHELPER#
+
+exit 0
diff -ruN php-5.6.7.orig/fink/php5-module.preinst php-5.6.7/fink/php5-module.preinst
--- php-5.6.7.orig/fink/php5-module.preinst	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-module.preinst	2013-08-13 10:49:10.000000000 -0600
@@ -0,0 +1,14 @@
+#!/bin/sh
+
+set -e
+
+#EXTRA#
+
+for dsoname in @modules@; do
+    inifile=${dsoname}.ini
+    dpkg-maintscript-helper mv_conffile @FINKPREFIX@/etc/php5/conf.d/${inifile} @FINKPREFIX@/etc/php5/mods-available/${inifile} 5.4.0~rc6-1 -- "$@";
+done
+
+#DEBHELPER#
+
+exit 0
diff -ruN php-5.6.7.orig/fink/php5-module.prerm php-5.6.7/fink/php5-module.prerm
--- php-5.6.7.orig/fink/php5-module.prerm	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-module.prerm	2013-08-13 10:49:22.000000000 -0600
@@ -0,0 +1,19 @@
+#!/bin/sh
+
+set -e
+
+#EXTRA#
+
+if [ "$1" = "remove" ] || [ "$1" = "deconfigure" ]; then
+    if [ -e @FINKPREFIX@/share/php5/php5-maintscript-helper ] ; then
+	. @FINKPREFIX@/share/php5/php5-maintscript-helper
+
+	for dsoname in @modules@; do
+	    php5_invoke dismod ALL ${dsoname}
+	done
+    fi
+fi
+
+#DEBHELPER#
+
+exit 0
diff -ruN php-5.6.7.orig/fink/php5-mysqlnd.postinst.extra php-5.6.7/fink/php5-mysqlnd.postinst.extra
--- php-5.6.7.orig/fink/php5-mysqlnd.postinst.extra	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-mysqlnd.postinst.extra	2013-08-13 10:46:16.000000000 -0600
@@ -0,0 +1,5 @@
+if [ "$1" = "configure" ]; then
+    ucf @FINKPREFIX@/share/php5/mysqlnd/mysqlnd.ini @FINKPREFIX@/etc/php5/mods-available/mysqlnd.ini
+fi
+
+dpkg-maintscript-helper mv_conffile @FINKPREFIX@/etc/php5/conf.d/10-mysqlnd.ini @FINKPREFIX@/etc/php5/mods-available/mysqlnd.ini 5.4.0~rc6-1 -- "$@";
diff -ruN php-5.6.7.orig/fink/php5-mysqlnd.postrm.extra php-5.6.7/fink/php5-mysqlnd.postrm.extra
--- php-5.6.7.orig/fink/php5-mysqlnd.postrm.extra	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-mysqlnd.postrm.extra	2013-08-13 10:46:26.000000000 -0600
@@ -0,0 +1 @@
+dpkg-maintscript-helper mv_conffile @FINKPREFIX@/etc/php5/conf.d/10-mysqlnd.ini @FINKPREFIX@/etc/php5/mods-available/mysqlnd.ini 5.4.0~rc6-1 -- "$@";
diff -ruN php-5.6.7.orig/fink/php5-mysqlnd.preinst.extra php-5.6.7/fink/php5-mysqlnd.preinst.extra
--- php-5.6.7.orig/fink/php5-mysqlnd.preinst.extra	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-mysqlnd.preinst.extra	2013-08-13 10:46:37.000000000 -0600
@@ -0,0 +1 @@
+dpkg-maintscript-helper mv_conffile @FINKPREFIX@/etc/php5/conf.d/10-mysqlnd.ini @FINKPREFIX@/etc/php5/mods-available/mysqlnd.ini 5.4.0~rc6-1 -- "$@";
diff -ruN php-5.6.7.orig/fink/php5-sapi.postinst php-5.6.7/fink/php5-sapi.postinst
--- php-5.6.7.orig/fink/php5-sapi.postinst	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-sapi.postinst	2014-02-18 10:48:28.000000000 -0700
@@ -0,0 +1,37 @@
+#!/bin/sh
+
+set -e
+
+#EXTRA#
+
+CONFDIR=@FINKPREFIX@/etc/php5/@sapi@/conf.d
+
+if [ -L $CONFDIR ]; then
+    rm $CONFDIR
+    mkdir $CONFDIR
+fi
+
+if [ "$1" = "configure" ]; then
+    phpini="@FINKPREFIX@/etc/php5/@sapi@/php.ini"
+
+    if [ "@sapi@" = "cli" ]; then
+       ucf @FINKPREFIX@/share/php5/php.ini-production.@sapi@ $phpini
+    else
+       ucf @FINKPREFIX@/share/php5/php.ini-production $phpini
+    fi
+    ucfr @package@ $phpini
+
+    if [ -e @FINKPREFIX@/share/php5/php5-maintscript-helper ]; then
+	. @FINKPREFIX@/share/php5/php5-maintscript-helper
+	
+	mods=$(php5query -M)
+	for mod in $mods; do
+	    php5_invoke enmod @sapi@ $mod
+	done
+    fi
+
+fi
+
+#DEBHELPER#
+
+exit 0
diff -ruN php-5.6.7.orig/fink/php5-sapi.postrm php-5.6.7/fink/php5-sapi.postrm
--- php-5.6.7.orig/fink/php5-sapi.postrm	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-sapi.postrm	2013-08-13 10:51:06.000000000 -0600
@@ -0,0 +1,38 @@
+#!/bin/sh
+
+set -e
+
+#EXTRA#
+
+php5_enable() { return 0; }
+
+if [ "$1" = "purge" ]; then
+    phpini=@FINKPREFIX@/etc/php5/@sapi@/php.ini
+    # remove the flag to remember the original state
+    if [ -e @FINKPREFIX@/etc/php5/@sapi@/.start ]; then
+	rm -f @FINKPREFIX@/etc/php5/@sapi@/.start
+    fi
+    for ext in '~' '%' .bak .ucf-new .ucf-old .ucf-dist;  do
+	rm -f $phpini$ext
+    done
+    rm -f $phpini
+    if which ucf >/dev/null; then
+	ucf --purge $phpini
+    fi
+    if which ucfr >/dev/null; then
+	ucfr --purge @package@ $phpini
+    fi
+fi
+
+if [ -e @FINKPREFIX@/share/php5/php5-maintscript-helper ]; then
+    . @FINKPREFIX@/share/php5/php5-maintscript-helper
+
+    mods=$(php5query -M)
+    for mod in $mods; do
+	php5_invoke dismod @sapi@ $mod
+    done
+fi
+
+#DEBHELPER#
+
+exit 0
diff -ruN php-5.6.7.orig/fink/php5-sapi.prerm php-5.6.7/fink/php5-sapi.prerm
--- php-5.6.7.orig/fink/php5-sapi.prerm	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-sapi.prerm	2013-08-13 10:51:16.000000000 -0600
@@ -0,0 +1,20 @@
+#!/bin/sh
+
+set -e
+
+#EXTRA#
+
+php5_enable() { return 0; }
+
+if [ -e @FINKPREFIX@/share/php5/php5-maintscript-helper ]; then
+    . @FINKPREFIX@/share/php5/php5-maintscript-helper
+
+    mods=$(php5query -M)
+    for mod in $mods; do
+	php5_invoke dismod @sapi@ $mod
+    done
+fi
+
+#DEBHELPER#
+
+exit 0
diff -ruN php-5.6.7.orig/fink/php5-sqlite.postinst.extra php-5.6.7/fink/php5-sqlite.postinst.extra
--- php-5.6.7.orig/fink/php5-sqlite.postinst.extra	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-sqlite.postinst.extra	2013-08-13 10:46:43.000000000 -0600
@@ -0,0 +1 @@
+dpkg-maintscript-helper rm_conffile @FINKPREFIX@/etc/php5/conf.d/sqlite.ini 5.3.9~ -- "$@"
diff -ruN php-5.6.7.orig/fink/php5-sqlite.postrm.extra php-5.6.7/fink/php5-sqlite.postrm.extra
--- php-5.6.7.orig/fink/php5-sqlite.postrm.extra	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-sqlite.postrm.extra	2013-08-13 10:46:49.000000000 -0600
@@ -0,0 +1 @@
+dpkg-maintscript-helper rm_conffile @FINKPREFIX@/etc/php5/conf.d/sqlite.ini 5.3.9~ -- "$@"
diff -ruN php-5.6.7.orig/fink/php5-sqlite.preinst.extra php-5.6.7/fink/php5-sqlite.preinst.extra
--- php-5.6.7.orig/fink/php5-sqlite.preinst.extra	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-sqlite.preinst.extra	2013-08-13 10:46:56.000000000 -0600
@@ -0,0 +1 @@
+dpkg-maintscript-helper rm_conffile @FINKPREFIX@/etc/php5/conf.d/sqlite.ini 5.3.9~ -- "$@"
diff -ruN php-5.6.7.orig/fink/php5-sybase.postinst.extra php-5.6.7/fink/php5-sybase.postinst.extra
--- php-5.6.7.orig/fink/php5-sybase.postinst.extra	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-sybase.postinst.extra	2013-08-13 10:47:03.000000000 -0600
@@ -0,0 +1 @@
+dpkg-maintscript-helper rm_conffile @FINKPREFIX@/etc/php5/conf.d/mssql.ini 5.2.3-1 -- "$@"
diff -ruN php-5.6.7.orig/fink/php5-sybase.postrm.extra php-5.6.7/fink/php5-sybase.postrm.extra
--- php-5.6.7.orig/fink/php5-sybase.postrm.extra	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-sybase.postrm.extra	2013-08-13 10:47:09.000000000 -0600
@@ -0,0 +1 @@
+dpkg-maintscript-helper rm_conffile @FINKPREFIX@/etc/php5/conf.d/mssql.ini 5.2.3-1 -- "$@"
diff -ruN php-5.6.7.orig/fink/php5-sybase.preinst.extra php-5.6.7/fink/php5-sybase.preinst.extra
--- php-5.6.7.orig/fink/php5-sybase.preinst.extra	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5-sybase.preinst.extra	2013-08-13 10:47:17.000000000 -0600
@@ -0,0 +1 @@
+dpkg-maintscript-helper rm_conffile @FINKPREFIX@/etc/php5/conf.d/mssql.ini 5.2.3-1 -- "$@"
diff -ruN php-5.6.7.orig/fink/php5.conf php-5.6.7/fink/php5.conf
--- php-5.6.7.orig/fink/php5.conf	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5.conf	2015-04-29 10:17:31.000000000 -0600
@@ -0,0 +1,25 @@
+<FilesMatch ".+\.ph(p[345]?|t|tml)$">
+    SetHandler application/x-httpd-php
+</FilesMatch>
+<FilesMatch ".+\.phps$">
+    SetHandler application/x-httpd-php-source
+    # Deny access to raw php sources by default
+    # To re-enable it's recommended to enable access to the files
+    # only in specific virtual host or directory
+    Require all denied
+</FilesMatch>
+# Deny access to files without filename (e.g. '.php')
+<FilesMatch "^\.ph(p[345]?|t|tml|ps)$">
+    Require all denied
+</FilesMatch>
+
+# Running PHP scripts in user directories is disabled by default
+# 
+# To disenable PHP in user directories uncomment the following lines
+# (from <IfModule ...> to </IfModule>.) Do NOT set it to On as it
+# prevents .htaccess files from disabling it.
+#<IfModule mod_userdir.c>
+#    <Directory /Users/*/Sites>
+#        php_admin_flag engine Off
+#    </Directory>
+#</IfModule>
diff -ruN php-5.6.7.orig/fink/php5.load php-5.6.7/fink/php5.load
--- php-5.6.7.orig/fink/php5.load	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5.load	2013-08-08 10:02:53.000000000 -0600
@@ -0,0 +1 @@
+LoadModule php5_module @FINKPREFIX@/lib/apache2/modules/libphp5.so
diff -ruN php-5.6.7.orig/fink/php5enmod php-5.6.7/fink/php5enmod
--- php-5.6.7.orig/fink/php5enmod	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5enmod	2013-08-08 09:59:50.000000000 -0600
@@ -0,0 +1,263 @@
+#!/bin/sh
+#
+#  php5enmod - a php5 module manager for Debian/Fink
+#
+#  Copyright 2013 Ondřej Surý <ondrej@sury.org>
+#
+# This program is licensed at your choice under the terms of the GNU General
+# Public License version 2+ or under the terms of the PHP License 3.01.
+#
+# For GPL-2+:
+# This program is free software; you can redistribute it and/or
+# modify it under the terms of the GNU General Public License
+# as published by the Free Software Foundation; either version 2
+# of the License, or (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301,
+# USA.
+#
+# For PHP 3.01:
+# This source file is subject to version 3.01 of the PHP license,
+# that is bundled with this package in the file LICENSE, and is
+# available through the world-wide-web at the following url:
+# http://www.php.net/license/3_01.txt
+# If you did not receive a copy of the PHP license and are unable to
+# obtain it through the world-wide-web, please send a note to
+# license@php.net so we can mail you a copy immediately.
+#
+
+set -ue
+
+SCRIPT_NAME=${0##*/}
+QUIET=no
+NEED_RESTART=no
+MAINT_MODE=no
+
+. @FINKPREFIX@/share/php5/php5-helper
+
+usage() {
+    [ -n "$@" ] && warning $@
+    echo "usage: ${SCRIPT_NAME} [ -s ALL|sapi_name ] module_name [ module_name_2 ]"
+    exit 1
+}
+
+enmods() {
+    local sapis="$1"
+    local mods="$2"
+    local register="$3"
+    local sapi
+    local mod
+
+    for mod in $mods; do
+	for sapi in $sapis; do
+	    enmod_ret=0
+            enmod $sapi $mod || enmod_ret=$?
+	    case $enmod_ret in
+		0)
+		    NEED_RESTART=yes
+		    record_state enabled $sapi $mod
+		    ;;
+	    esac
+	done
+	if [ "$register" = "yes" ]; then
+	    mod_registry register $mod
+	fi
+    done
+}
+
+dismods() {
+    local sapis="$1"
+    local mods="$2"
+    local register="$3"
+    local purge="$4"
+    local sapi
+    local mod
+
+    for mod in $mods; do
+	for sapi in $sapis; do
+	    local dismod_ret=0
+            dismod $sapi $mod $purge || dismod_ret=$?
+	    case $dismod_ret in
+		0)
+		    NEED_RESTART=yes
+		    record_state disabled $sapi $mod
+		    ;;
+	    esac
+	done
+	if [ "$purge" = "yes" ]; then
+	    remove_state enabled $sapi $mod
+	    remove_state disabled $sapi $mod
+	    mod_registry unregister $mod
+	elif [ "$register" = "yes" ]; then
+	    mod_registry unregister $mod
+	fi
+    done
+}
+
+enmod() {
+    local sapi=$1
+    local modname=$2
+
+    if ! module_exists $modname; then
+	warning "Module $modname ini file doesn't exist under @FINKPREFIX@/etc/php5/mods-available"
+	return 1
+    fi
+
+    local priority=$(get_priority $sapi $modname)
+    local live_link=$(get_live_link $sapi $modname $priority)
+    local live_link_content=$(get_live_link_content $sapi $modname $priority)
+
+    module_cleanup $sapi $modname $priority
+
+    local module_state=0
+    php5query -q -s $sapi -m $modname || module_state=$?
+
+    case $module_state in
+	# module enabled, but re-enable the conf.d link just in case
+	0)
+	    ;;
+	# module not yet enabled
+	1)
+	    ;;
+	# module disabled by maintainer script
+	33)
+	    ;;
+	# module disabled by site administrator
+	# enable module only if not running in maintainer mode
+	32)
+	    if [ "$MAINT_MODE" = "yes" ]; then
+		warning "Not enabling the ${modname} module for ${sapi} SAPI since the module"
+		warning "was disabled by local administrator."
+		return 1
+	    fi
+	    ;;
+	34)
+            warning "Not enabling the ${modname} module for ${sapi} SAPI since module symlink"
+	    warning "already exists in @FINKPREFIX@/etc/php5/${sapi}/conf.d with different content."
+	    return 1
+	    ;;
+	# fail if we get any different result
+	*)
+	    warning "Unable to get module state, run php5query -s $sapi -m $modname manually"
+	    warning "and fix the module state."
+	    return 1
+    esac
+
+    if [ -d "@FINKPREFIX@/etc/php5/$sapi/conf.d" ]; then
+	if [ ! -h "${live_link}" ]; then
+	    ln -s "${live_link_content}" "${live_link}"
+	fi
+    else
+	warning "Directory @FINKPREFIX@/etc/php5/$sapi/conf.d doesn't exist, not enabling the module"
+	return 1
+    fi
+
+    return 0
+}
+
+dismod() {
+    local sapi=$1
+    local modname=$2
+    local purge=$3
+
+    if ! module_exists $modname; then
+	if [ "$purge" = "no" ]; then
+	    warning "Module $modname ini file doesn't exist under @FINKPREIFX@/etc/php5/mods-available"
+	    return 1
+	fi
+    fi
+
+    local priority=$(get_priority $sapi $modname)
+    local live_link=$(get_live_link $sapi $modname $priority)
+    local live_link_content=$(get_live_link_content $sapi $modname $priority)
+
+    module_cleanup $sapi $modname $priority
+
+    local module_state=0
+    php5query -q -s $sapi -m $modname || module_state=$?
+
+    case $module_state in
+	# module enabled
+	0)
+	    ;;
+	# module not enabled, but re-remove the link just in case
+	1|32|33)
+	    ;;
+	34)
+	    warning "Not disabling module $modname for $sapi SAPI.  The configuration was"
+	    warning "modified by local administrator."
+	    return 1
+	    ;;
+	# fail if we get any different result
+	*)
+	    warning "Unable to get module state, run php5query -s $sapi -m $modname manually"
+	    warning "and fix the module state."
+	    return 1
+    esac
+
+    if [ -d "@FINKPREFIX@/etc/php5/$sapi/conf.d" ]; then
+	if [ -h "$live_link" ]; then
+	    rm -f "$live_link"
+	fi
+    fi
+
+    return 0
+}
+
+sapis=
+register=no
+purge=no
+while getopts pfs:mqr opt; do
+    case $opt in
+	r) register=yes;;
+	s)
+	    if [ "$sapis" = "ALL" -o \( "$OPTARG" = "ALL" -a -n "$sapis" \) ]; then
+		warning "You cannot specify ALL and individual sapis"
+		usage
+	    fi
+	    sapis="${sapis}${sapis:+ }$OPTARG"
+	    ;;
+	m) MAINT_MODE=yes;;
+	p) purge=yes;;
+	q) QUIET=yes;;
+	\?) usage;;
+    esac
+done
+shift $(expr $OPTIND - 1)
+mods=""
+for mod in $@; do
+    mods="${mods}${mods:+ }${mod%%/*}"
+done
+if [ "$register" = "no" ]; then
+    sapis="${sapis:-ALL}"
+
+    if [ "$sapis" = "ALL" ]; then
+	register=yes
+    fi
+fi
+
+if [ "$sapis" = "ALL" ]; then
+    sapis=$(php5query -S)
+fi
+
+[ -z "$mods" ] && usage
+
+case "${SCRIPT_NAME}" in
+    php5enmod)
+	enmods "$sapis" "$mods" "$register"
+	;;
+    php5dismod)
+	dismods "$sapis" "$mods" "$register" "$purge"
+	;;
+    *)
+	usage
+	;;
+esac
+exit 0
diff -ruN php-5.6.7.orig/fink/php5filter.load php-5.6.7/fink/php5filter.load
--- php-5.6.7.orig/fink/php5filter.load	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5filter.load	2013-08-08 10:02:27.000000000 -0600
@@ -0,0 +1 @@
+LoadModule php5_module @FINKPREFIX@/lib/apache2/modules/libphp5filter.so
diff -ruN php-5.6.7.orig/fink/php5query php-5.6.7/fink/php5query
--- php-5.6.7.orig/fink/php5query	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/php5query	2013-08-08 09:54:36.000000000 -0600
@@ -0,0 +1,208 @@
+#!/bin/sh
+#
+#  php5query - a php5 module manager for Debian/Fink
+#
+#  Copyright 2013 Ondřej Surý <ondrej@sury.org>
+#
+# This program is licensed at your choice under the terms of the GNU General
+# Public License version 2+ or under the terms of the PHP License 3.01.
+#
+# For GPL-2+:
+# This program is free software; you can redistribute it and/or
+# modify it under the terms of the GNU General Public License
+# as published by the Free Software Foundation; either version 2
+# of the License, or (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301,
+# USA.
+#
+# For PHP 3.01:
+# This source file is subject to version 3.01 of the PHP license,
+# that is bundled with this package in the file LICENSE, and is
+# available through the world-wide-web at the following url:
+# http://www.php.net/license/3_01.txt
+# If you did not receive a copy of the PHP license and are unable to
+# obtain it through the world-wide-web, please send a note to
+# license@php.net so we can mail you a copy immediately.
+#
+
+set -ue
+
+SCRIPT_NAME=${0##*/}
+QUIET=no
+
+. @FINKPREFIX@/share/php5/php5-helper
+
+usage() {
+    [ -n "$@" ] && warning $@
+    echo "usage: ${SCRIPT_NAME} [ -q ] -s sapi_name [ -m module_name ] [ -M ] [ -S ]"
+    exit 1
+}
+
+check_mod() {
+    local sapi=$1
+    local modname=$2
+
+    if ! module_exists $modname; then
+	output "No module matches $modname"
+	return 1
+    fi
+
+    local priority=$(get_priority $sapi $modname)
+    local live_link=$(get_live_link $sapi $modname $priority)
+    local live_link_content=$(get_live_link_content $sapi $modname $priority)
+
+    found=no
+    if [ -e "${live_link}" ] ; then
+	if [ -h "${live_link}" ] ; then
+	    local content="$(greadlink "${live_link}")"
+	    if [ "${content}" = "${live_link_content}" ] ; then
+		found=yes
+	    fi
+	fi
+	if [ "$found" != "yes" ]; then
+	    output "Module $modname symlink was modified by local administrator."
+	    return 34
+	fi
+    fi
+
+    local state_dir="$(get_state_dir $sapi)"
+
+    if [ -e "${state_dir}/enabled_by_admin/$modname" ]; then
+	output "$modname (Enabled for $sapi by local administrator)"
+	return 0
+    elif [ -e "${state_dir}/enabled_by_maint/$modname" ]; then
+	output "$modname (Enabled for $sapi by maintainer script)"
+	return 0
+    elif [ -e "${state_dir}/disabled_by_admin/$modname" ]; then
+	output "No module matches $modname (Disabled for $sapi by local administrator)"
+	return 32
+    elif [ -e "${state_dir}/disabled_by_maint/$modname" ]; then
+	output "No module matches $modname (Disabled for $sapi by maintainer script)"
+	return 33
+    elif [ "$found" = "yes" ]; then
+	output "$modname (Enabled for $sapi by unknown)"
+	return 0
+    else
+	output "No module matches $modname"
+	return 1
+    fi
+}
+
+list_mod() {
+    local verbose=$1
+    local registry_dir="$(get_registry_dir)"
+
+    sapis=$(list_sapi)
+    if [ -d "$registry_dir" ]; then
+	for mod in $(list_parts "$registry_dir"); do
+	    if [ "$verbose" = "yes" ]; then
+		for sapi in $sapis; do
+		    check_mod $sapi $mod
+		done
+	    else
+		echo $mod
+	    fi
+	done
+	return 0
+    fi
+}
+
+list_sapi() {
+    local sapi_dir="$(get_sapi_dir)"
+
+    if [ -d "$sapi_dir" ]; then
+	for sapi in $(list_parts "$sapi_dir"); do
+	    echo $sapi;
+	done
+    fi
+}
+
+check_sapi() {
+    local sapi=$1
+    local sapi_dir="$(get_sapi_dir)"
+
+    if [ -e "$sapi_dir/$sapi" ]; then
+	return 0
+    fi
+    return 1
+}
+
+QUIET=no
+verbose=no
+action=
+sapi=
+
+while getopts s:m:SMqv opt; do
+    case $opt in
+	s)
+	    if [ -n "$action" ]; then
+		if [ "$action" != "check_mod" ]; then
+		    usage "Only one mode of operation can be used at the same time."
+		else
+		    action="check_sapi"
+		fi
+	    fi
+	    sapi="$OPTARG"
+	    ;;
+	S)
+	    if [ -n "$action" ]; then
+		usage "Only one mode of operation can be used at the same time."
+	    fi
+	    action="list_sapi"
+	    ;;
+	m)
+	    if [ -n "$action" -a "$action" != "check_sapi" ]; then
+		usage "Only one mode of operation can be used at the same time."
+	    fi
+	    action="check_mod"
+	    mod="$OPTARG"
+	    ;;
+	M)
+	    [ -n "$action" ] && usage "Only one mode of operation can be used at the same time."
+	    action="list_mod"
+	    ;;
+	q)
+	    QUIET=yes
+	    ;;
+	v)
+	    verbose=yes
+	    ;;
+	\?) usage "Unknown parameter specified";;
+    esac
+done
+shift $(expr $OPTIND - 1)
+
+if [ -z "$action" ]; then
+    usage "You need to specify at least one action."
+fi
+
+if [ -n "$sapi" ]; then
+    check_sapi $sapi || usage "Invalid SAPI specified"
+fi
+
+ret=0
+case "$action" in
+    check_mod)
+	[ -z "$sapi" ] && usage "You need to specify sapi"
+	check_mod $sapi $mod || ret=$?
+	;;
+    check_sapi)
+	check_sapi $sapi || ret=$?
+	if [ "$ret" -eq 0 ]; then
+	    output "$sapi"
+	fi
+	;;
+    list_mod) list_mod $verbose || ret=$?;;
+    list_sapi) list_sapi || ret=$?;;
+    *) usage "Unknown action $action"
+esac
+
+exit $ret
diff -ruN php-5.6.7.orig/fink/sessionclean php-5.6.7/fink/sessionclean
--- php-5.6.7.orig/fink/sessionclean	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/sessionclean	2015-04-29 10:56:39.000000000 -0600
@@ -0,0 +1,32 @@
+#!/bin/sh -e
+
+SAPIS="apache2:apache2\napache2filter:apache2\ncgi:php5\nfpm:php5-fpm\n"
+
+# Iterate through all web SAPIs
+(
+proc_names=""
+printf "$SAPIS" | \
+while IFS=: read -r conf_dir proc_name; do
+    if [ -e @FINKPREFIX@/etc/php5/${conf_dir}/php.ini ]; then
+        # Get all session variables once so we don't need to start PHP to get each config option
+        session_config=$(php5 -c @FINKPREFIX@/etc/php5/${conf_dir}/php.ini -d "error_reporting='~E_ALL'" -r 'foreach(ini_get_all("session") as $k => $v) echo "$k=".$v["local_value"]."\n";')
+        save_handler=$(echo "$session_config" | sed -ne 's/^session\.save_handler=\(.*\)$/\1/p')
+        save_path=$(echo "$session_config" | sed -ne 's/^session\.save_path=\(.*\)$/\1/p')
+        gc_maxlifetime=$(($(echo "$session_config" | sed -ne 's/^session\.gc_maxlifetime=\(.*\)$/\1/p')/60))
+
+        if [ "$save_handler" = "files" -a -d "$save_path" ]; then
+            proc_names="$proc_names $proc_name";
+            printf "%s:%s\n" "$save_path" "$gc_maxlifetime"
+        fi
+    fi
+done
+# first find all open session files and touch them (hope it's not massive amount of files)
+for pid in $(pidof $proc_names); do
+    find "/proc/$pid/fd" -ignore_readdir_race -lname "$save_path/sess_\*" -exec touch -c {} \;
+done
+) | sort -rn -t: -k2,2 | sort -u -t: -k 1,1 | while IFS=: read -r save_path gc_maxlifetime; do
+    # find all files older then maxlifetime and delete them
+    find -O3 "$save_path" -depth -mindepth 1 -name 'sess_*' -ignore_readdir_race -type f -cmin "+$gc_maxlifetime" -delete
+done
+
+exit 0
diff -ruN php-5.6.7.orig/fink/setup-mysql.sh php-5.6.7/fink/setup-mysql.sh
--- php-5.6.7.orig/fink/setup-mysql.sh	1969-12-31 17:00:00.000000000 -0700
+++ php-5.6.7/fink/setup-mysql.sh	2013-08-13 21:06:13.000000000 -0600
@@ -0,0 +1,78 @@
+#!/bin/sh
+
+set -eu
+
+[ $# -ge 2 ] || {
+    echo "Usage: fink/setup-mysql.sh port data-dir" >&2
+    exit 1
+}
+
+# CLI arguments #
+port=$1
+datadir=$2
+action=${3:-start}
+if [ "$(id -u)" -eq 0 ]; then
+    user="mysql"
+else
+    user="$(whoami)"
+fi
+
+# Some vars #
+
+socket=$datadir/mysql.sock
+# Commands:
+mysqladmin="mysqladmin --no-defaults --user root --port $port --host 127.0.0.1 --socket=$socket --no-beep"
+mysqld="@FINKPREFIX@/sbin/mysqld --no-defaults --user=$user --bind-address=127.0.0.1 --port=$port --socket=$socket --datadir=$datadir"
+
+# Main code #
+
+if [ "$action" = "stop" ]; then
+    $mysqladmin shutdown
+    exit
+fi
+
+rm -rf $datadir
+mkdir -p $datadir
+chmod go-rx $datadir
+chown $user: $datadir
+
+mysql_install_db --no-defaults --user=$user --datadir=$datadir --rpm --force
+
+tmpf=$(gmktemp)
+cat > "$tmpf" <<EOF
+USE mysql;
+UPDATE user SET password=PASSWORD('') WHERE user='root';
+FLUSH PRIVILEGES;
+EOF
+
+$mysqld --bootstrap --skip-grant-tables < "$tmpf"
+
+unlink "$tmpf"
+
+# Start the daemon
+$mysqld &
+
+pid=$!
+
+# Wait for the server to be actually available
+c=0;
+while ! nc -z 127.0.0.1 $port; do
+    c=$(($c+1));
+    sleep 3;
+    if [ $c -gt 20 ]; then
+	echo "Timed out waiting for mysql server to be available" >&2
+	if [ "$pid" ]; then
+	    kill $pid || :
+	    sleep 2
+	    kill -s KILL $pid || :
+	fi
+	exit 1
+    fi
+done
+
+# Check if the server is running
+$mysqladmin status
+# Drop the database if it exists
+$mysqladmin --force --silent drop test || true
+# Create new empty database
+$mysqladmin create test
