Info2: <<
Package: net-daemon-pm%type_pkg[perl]
Version: 0.43
Revision: 1101
Description: Perl extension for portable daemons
Type: perl (5.8.8 5.10.0)
License: Artistic
Maintainer: Benjamin Reed <net-daemon-pm@fink.raccoonfink.com>

Depends: perl%type_pkg[perl]-core
BuildDepends: <<
	fink (>= 0.29.7-1),
	perl%type_pkg[perl]-core
<<

Source: mirror:cpan:modules/by-module/Net/Net-Daemon-%v.tar.gz
Source-MD5: a173a8407fb7b049aa465598eca6dfd7
SourceDirectory: Net-Daemon
PatchFile: %{ni}5100+.patch
PatchFile-MD5: 0d97cf5fc8ba3b48be9792982f53d895
PatchScript: <<
#!/bin/sh -ev
	perlversion=%type_raw[perl]

	# fix for new threading model in perl5.10.0 and beyond (not
	# sure why the if/else controls in it don't fall back to
	# correct previous-perl implementation)
	if dpkg --compare-versions "$perlversion" ">=" "5.10.0"; then
		patch -p1 < %{PatchFile}
	fi

	# use correct single-arch of universal interp
	if dpkg --compare-versions "$perlversion" ">=" "5.10.0" && [ "%m" != "powerpc" ]; then
		perl -pi -e 's#(\$\^X)#"/usr/bin/arch", "-%m", \1#' t/*.t
	fi
<<

UseMaxBuildJobs: true

UpdatePOD: true
InstallScript: <<
	%{default_script}
	mv %i/share/man %i/lib/perl5/%type_raw[perl]
<<
DocFiles: ChangeLog MANIFEST README

Homepage: http://search.cpan.org/dist/Net-Daemon
DescDetail: <<
	Net::Daemon is an abstract base class for implementing portable server
	applications in a very simple way.  The module is designed for Perl
	5.005 and threads, but can work with fork() and Perl 5.004.
	
	The Net::Daemon class offers methods for the most common tasks a
	daemon needs: Starting up, logging, accepting clients, authorization,
	restricting its own environment for security and doing the true work.
	You only have to override those methods that aren't appropriate for
	you, but typically inheriting will safe you a lot of work anyways.
<<
DescPackaging: <<
	Import upstream-tracker patch for new perl5.10 threading model
	(i.e., compatibility with fink on 10.6+). See:
	https://rt.cpan.org/Public/Bug/Display.html?id=55512
	Adjusted for portability rather than hard-coded 5.10+ only.
<<
<<

