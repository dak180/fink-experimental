Package: ucf
Version: 3.0030
Revision: 1
###
BuildDepends: <<
	fink (>= 0.38.99.git),
	debhelper (>= 9),
	po-debconf
<<
Depends: <<
	debconf (>= 1.5.19)
<<
RuntimeDepends: <<
	getoptbin,
	coreutils (>= 5.91)
<<
###
Source: mirror:debian:pool/main/u/%n/%n_%v.tar.xz
Source-MD5: f9ed0e97707e76591b75a50bf74d3284
SourceDirectory: %n-%v
###
DefaultScript: debhelper
###
PatchScript: <<
%{default_script}

### Fix Install
perl -pi -e 's,-o root -g root ,,g' Makefile
perl -pi -e 's,\/usr,\%p,g' Makefile
perl -pi -e 's,\/etc,\%p\/etc,g' Makefile
perl -pi -e 's,\/var,\%p\/var,g' Makefile
perl -pi -e 's,\%p\/bin\/install,\/usr\/bin\/install,g' Makefile

perl -pi -e 's,readlink,greadlink,g' ucf ucfr
perl -pi -e 's,/usr,%p,g' examples/postinst examples/postrm lcf lcf.1 ucf ucf.1 ucf.conf ucf.conf.5 ucfq ucfq.1 ucfr ucfr.1
# except perl, keep that one using /usr
perl -pi -e 's,%p/bin/perl,/usr/bin/perl,g' examples/postinst examples/postrm lcf lcf.1 ucf ucf.1 ucf.conf ucf.conf.5 ucfq ucfq.1 ucfr ucfr.1
# fix %p/bin/seq calls need to be /usr/bin/seq
perl -pi -e 's,%p/bin/seq,/usr/bin/seq,g' examples/postinst examples/postrm lcf lcf.1 ucf ucf.1 ucf.conf ucf.conf.5 ucfq ucfq.1 ucfr ucfr.1 
perl -pi -e 's,/etc,%p/etc,g' examples/postinst examples/postrm lcf lcf.1 ucf ucf.1 ucf.conf ucf.conf.5 ucfq ucfq.1 ucfr ucfr.1
perl -pi -e 's,/var,%p/var,g' examples/postinst examples/postrm lcf lcf.1 ucf ucf.1 ucf.conf ucf.conf.5 ucfq ucfq.1 ucfr ucfr.1

# Fix for BSD stat
perl -pi -e "s,stat -c '%%s',/usr/bin/stat -f '%%z',g" ucf
<<
###
Description: Update Configuration File: preserve changes
DescDetail: <<
Debian/Fink policy mandates that user changes to configuration files must be 
preserved during package upgrades. The easy way to achieve this behavior is to
make the configuration file a 'conffile', in which case dpkg handles the file
specially during upgrades, prompting the user as needed.
.
This is appropriate only if it is possible to distribute a default version that
will work for most installations, although some system administrators may
choose to modify it. This implies that the default version will be part of the
package distribution, and must not be modified by the maintainer scripts during
installation (or at any other time). 
.
This script attempts to provide conffile-like handling for files that may not
be labelled conffiles, and are not shipped in a Debian package, but handled by
the postinst instead. This script allows one to maintain files in %p/etc,
preserving user changes and in general offering the same facilities while
upgrading that dpkg normally provides for 'conffiles'.
.
Additionally, this script provides facilities for transitioning a file that had
not been provided with conffile-like protection to come under this schema, and
attempts to minimize questions asked at installation time. Indeed, the
transitioning facility is better than the one offered by dpkg while
transitioning a file from a non-conffile to conffile status.
<<
License: GPL
Maintainer: Justin F. Halett <thesin@lists.sourceforge.net>
Homepage: http://packages.debian.org/unstable/debsums
