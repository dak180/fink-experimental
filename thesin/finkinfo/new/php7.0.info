Info2: <<
Package: php7.0
Version: 7.0.12
Revision: 1.1
Type: sapiver (20151012), phpver (7.0)
###
BuildDepends: <<
	fink (>= 0.32),
	fink-buildenv-modules,
	fink-package-precedence,
	apache2-dev (>= 2.4),
	dh-apache2,
	autoconf2.6,
	automake1.15,
	bison,
	coreutils,
	flex,
	mysql-unified-dev | libmysqlclient18-dev,
	re2c,
	sed,
	aspell-dev,
	bzip2-dev,
	cyrus-sasl2-dev,
	db53-aes,
	enchant1-dev,
	freetds-dev,
	freetype219 (>= 2.6-1),
	gd3,
	gmp5,
	libapr.0-dev,
	libaprutil.0-dev,
	libc-client1-dev,
	libcurl4,
	libgettext8-dev,
	libiconv-dev,
	libicu55-dev,
	libjpeg9,
	libmcrypt,
	libnetsnmp30-dev,
	libodbc3-dev,
	libonig2-dev,
	libpcre1,
	libpng16,
	libtidy5,
	libxml2,
	libxmlrpc-epi-dev,
	libxslt,
	libzip2,
	openldap24-dev,
	openssl100-dev,
	postgresql96-dev,
	qdbm14,
	recode-dev,
	sqlite3-dev,
	wrap
<<
RunTimeDepends: <<
	libapache2-mod-%n (= %v-%r) | libapache2-mod-%nfilter (= %v-%r) | %n-cgi (= %v-%r) | %n-fpm (= %v-%r),
	%n-common (= %v-%r)
<<
###
CustomMirror: <<
	eur-AR: http://ar.php.net/
	oce-AU: http://au.php.net/
	oce-AU: http://au2.php.net/
	oce-AU: http://au3.php.net/
	eur-AT: http://at.php.net/
	eur-AT: http://at2.php.net/
	eur-BE: http://be.php.net/
	eur-BE: http://be2.php.net/
	sam-BR: http://br.php.net/
	sam-BR: http://br2.php.net/
	nam-CA: http://ca.php.net/
	nam-CA: http://ca2.php.net/
	nam-CA: http://ca3.php.net/
	asi-CN: http://cn.php.net/
	asi-CN: http://cn2.php.net/
	sam-CR: http://cr2.php.net/
	eur-CZ: http://cz.php.net/
	eur-DK: http://dk.php.net/
	eur-DK: http://dk2.php.net/
	eur-FR: http://fr.php.net/
	eur-FR: http://fr2.php.net/
	eur-FR: http://fr3.php.net/
	eur-DE: http://de.php.net/
	eur-DE: http://de2.php.net/
	eur-DE: http://de3.php.net/
	eur-GR: http://gr.php.net/
	eur-GR: http://gr2.php.net/
	eur-HU: http://hu.php.net/
	eur-HU: http://hu2.php.net/
	asi-ID: http://id.php.net/
	eur-IE: http://ie.php.net/
	asi-JP: http://jp.php.net/
	asi-JP: http://jp2.php.net/
	eur-LV: http://lv.php.net/
	nam-MX: http://mx.php.net/
	eur-PL: http://pl.php.net/
	eur-PL: http://pl2.php.net/
	eur-RU: http://ru.php.net/
	eur-RU: http://ru2.php.net/
	eur-SI: http://si.php.net/
	eur-SI: http://si2.php.net/
	eur-SE: http://se.php.net/
	eur-SE: http://se2.php.net/
	eur-CH: http://ch.php.net/
	eur-CH: http://ch2.php.net/
	asi-TW: http://tw.php.net/
	asi-TW: http://tw2.php.net/
	eur-UA: http://ua.php.net/
	eur-UA: http://ua2.php.net/
	eur-UK: http://uk.php.net/
	eur-UK: http://uk2.php.net/
	nam-US: http://us2.php.net/
	nam-US: http://us3.php.net/  
	nam-US: http://us4.php.net/  
	nam-US: http://www.php.net/  
	eur-YU: http://yu.php.net/
<<
###
Source: mirror:custom:distributions/php-%v.tar.gz
Source-Checksum: SHA1(268b87a92d3a19802577ed48709f4c736c733961)
Source2: mirror:debian:pool/main/p/%n/%n_%v-1.debian.tar.xz
Source2-Checksum: SHA1(bc629314b5438b8baf4634238d8fe41df2f4c2af)
Source2ExtractDir: php-%v
###
PatchScript: <<
#!/bin/sh -ev
. %p/sbin/fink-buildenv-helper.sh

### Make install script
cat > debian/finkdebhelper.sh <<EOF
#!/bin/bash
set -e

pkgname=\$1
basedir=\$2
instdir=\$3

# Copy in stuff done from the main InstallScript
install -d -m0755 \${instdir}/../DEBIAN
if [ -d debian/\${pkgname}\${basedir} ]; then
	cp -a debian/\${pkgname}\${basedir}/* \${instdir}/
fi
if [ -d debian/\${pkgname}/DEBIAN ]; then
	cp -a debian/\${pkgname}/DEBIAN/* \${instdir}/../DEBIAN
fi

# Debian maintainer scripts
for i in \`ls -1 debian/\${pkgname}.post* debian/\${pkgname}.pre* 2> /dev/null | grep -v "\\.in\$" | grep -v "\\.extra"\`; do
	install -m755 \$i \${instdir}/../DEBIAN/\${i##*.}
done

# Debian triggers
if [ -f debian/\${pkgname}.triggers ]; then
	install -d -m0755 \${instdir}/../DEBIAN
	install -m644 debian/\${pkgname}.triggers \${instdir}/../DEBIAN/triggers
fi

# ConfFiles
cd \${instdir}
for i in \`find etc -type f 2> /dev/null\`; do
	echo \${basedir}/\$i >> ../DEBIAN/conffiles
done
cd -
EOF
chmod +x debian/finkdebhelper.sh

### Fix patches for fink locations
perl -pi -e 's,/etc,%p/etc,g' debian/patches/0003-debian_quirks.patch 
perl -pi -e 's,/var,%p/var,g' debian/patches/0021-session_save_path.patch debian/patches/0028-php-5.3.9-mysqlnd.patch debian/patches/0032-php-fpm-listen-on-unix-socket.patch
perl -pi -e 's,/usr,%p,g' debian/patches/0003-debian_quirks.patch debian/patches/0012-php.ini_securitynotes.patch debian/rules.d/*.mk
perl -pi -e "s;%p/X11R6;${X11_BASE_DIR};g" debian/rules.d/*.mk
perl -pi -e 's;--with-iconv=shared;--with-iconv=shared,%p;g' debian/rules.d/ext-common.mk
perl -pi -e 's;--with-libzip=%p;--with-libzip=%p/lib/libzip;g' debian/rules.d/ext-zip.mk

### Apply some Debian Patches for Security and Build Issues
patch -p1 < debian/patches/0001-libtool_fixes.patch
patch -p1 < debian/patches/0002-static_openssl.patch
patch -p1 < debian/patches/0003-debian_quirks.patch
patch -p1 < debian/patches/0004-libtool2.2.patch
patch -p1 < debian/patches/0005-we_WANT_libtool.patch
patch -p1 < debian/patches/0006-php-5.4.9-phpinfo.patch
patch -p1 < debian/patches/0007-extension_api.patch
patch -p1 < debian/patches/0008-no_apache_installed.patch
patch -p1 < debian/patches/0009-recode_is_shared.patch
patch -p1 < debian/patches/0010-proc_open.patch
patch -p1 < debian/patches/0011-php.ini_securitynotes.patch
patch -p1 < debian/patches/0012-php-5.4.7-libdb.patch
patch -p1 < debian/patches/0013-Add-support-for-use-of-the-system-timezone-database.patch
patch -p1 < debian/patches/0014-force_libmysqlclient_r.patch
patch -p1 < debian/patches/0015-strcmp_null-OnUpdateErrorLog.patch
patch -p1 < debian/patches/0016-dont-gitclean-in-build.patch
patch -p1 < debian/patches/0017-qdbm-is-usr_include_qdbm.patch
patch -p1 < debian/patches/0018-session_save_path.patch
patch -p1 < debian/patches/0019-php-fpm-man-section-and-cleanup.patch
patch -p1 < debian/patches/0020-fpm-config.patch
patch -p1 < debian/patches/0021-php-fpm-sysconfdir.patch
patch -p1 < debian/patches/0022-lp564920-fix-big-files.patch
patch -p1 < debian/patches/0023-temporary-path-fixes-for-multiarch.patch
patch -p1 < debian/patches/0024-hurd-noptrace.patch
patch -p1 < debian/patches/0025-php-5.3.9-mysqlnd.patch
patch -p1 < debian/patches/0026-php-5.3.9-gnusrc.patch
patch -p1 < debian/patches/0027-php-5.3.3-macropen.patch
patch -p1 < debian/patches/0028-php-5.2.4-norpath.patch
patch -p1 < debian/patches/0029-php-5.2.4-embed.patch
patch -p1 < debian/patches/0030-php-fpm-m68k.patch
patch -p1 < debian/patches/0031-expose_all_built_and_installed_apis.patch
patch -p1 < debian/patches/0032-Use-system-timezone.patch
patch -p1 < debian/patches/0033-zlib-largefile-function-renaming.patch
patch -p1 < debian/patches/0034-php-fpm-do-reload-on-SIGHUP.patch
patch -p1 < debian/patches/0035-php-5.4.8-ldap_r.patch
patch -p1 < debian/patches/0036-php-5.4.9-fixheader.patch
patch -p1 < debian/patches/0037-php-5.6.0-noNO.patch
patch -p1 < debian/patches/0038-php-5.6.0-oldpcre.patch
patch -p1 < debian/patches/0039-hack-phpdbg-to-explicitly-link-with-libedit.patch
patch -p1 < debian/patches/0040-Fix-ZEND_MM_ALIGNMENT-on-m64k.patch
patch -p1 < debian/patches/0041-Add-patch-to-remove-build-timestamps-from-generated-.patch
patch -p1 < debian/patches/0042-Remove-W3C-validation-icon-to-not-expose-the-reader-.patch
patch -p1 < debian/patches/0043-Don-t-put-INSTALL_ROOT-into-phar.phar-exec-stanza.patch
patch -p1 < debian/patches/0044-XMLRPC-EPI-library-has-to-be-linked-as-lxmlrpc-epi.patch
patch -p1 < debian/patches/0045-Really-expand-libdir-datadir-into-EXPANDED_LIBDIR-DA.patch
patch -p1 < debian/patches/0046-Fix-ext-date-lib-parse_tz-PATH_MAX-HURD-FTBFS.patch
patch -p1 < debian/patches/0047-Adjust-tidy-extension-for-tidy-html5.patch

# Use libtool
perl -pi -e 's,darwin,narwin,g' sapi/cli/*.m4 sapi/cgi/*.m4 sapi/fpm/*.m4

# fix libXpm location
perl -pi -e 's,i/X11,i/include,g' ext/gd/config.m4

# fix for fink db.h location
perl -pi -e 's,include\/db\.h,include\/db4\/db\.h,g' ext/dba/config.m4

# enable dso for darwin7+
perl -pi -e 's,darwin,darwin7,g' ext/pdo/config.m4

# darwin uses dylib not so
perl -pi -e 's,libpq\.so,libpq\.dylib,g' ext/pgsql/config.m4 ext/pdo_pgsql/config.m4
perl -pi -e 's,-rpath \$\(phptempdir\) \$\(EXTRA_LDFLAGS\),-dynamiclib -rpath %p/lib,g' Makefile.global

# Fix setup-mysql script for tests
perl -pi -e 's,mktemp,gmktemp,g' debian/setup-mysql.sh
perl -pi -e 's,/usr,%p,g' debian/setup-mysql.sh
# Fink nc is broken, use system one for now
perl -pi -e 's,nc -z,/usr/bin/nc -z,g' debian/setup-mysql.sh

# fix paths in debian dir files
perl -pi -e 's,\.libs,libs,g' debian/*.apache2
perl -pi -e "s,usr/,$(echo %p | sed -e 's;^/;;g')/,g" debian/*.load debian/*.conf debian/*.post* debian/*.pre* debian/*.lintian-overrides debian/*.triggers debian/*.README.Debian debian/*.logrotate debian/*.dirs debian/*.files debian/php-fpm-* debian/*.init debian/*.extra
perl -pi -e "s,etc/,$(echo %p | sed -e 's;^/;;g')/etc/,g" debian/*.load debian/*.conf debian/*.post* debian/*.pre* debian/*.lintian-overrides debian/*.triggers debian/*.README.Debian debian/*.logrotate debian/*.dirs debian/*.files debian/php-fpm-* debian/*.init debian/*.extra
perl -pi -e "s,var/,$(echo %p | sed -e 's;^/;;g')/var/,g" debian/*.load debian/*.conf debian/*.post* debian/*.pre* debian/*.lintian-overrides debian/*.triggers debian/*.README.Debian debian/*.logrotate debian/*.dirs debian/*.files debian/php-fpm-* debian/*.init debian/*.extra
perl -pi -e "s,run/,$(echo %p | sed -e 's;^/;;g')/var/run/,g" debian/php-fpm* debian/*.init

# no invoke-rc.d in darwin
perl -pi -e 's,invoke-rc.d,true; #invoke-rc.d,g' debian/php-fpm.postinst.extra

## no ldconfig on darwin and packagename differs
perl -pi -e 's,ldconfig,gecho -n,g' debian/libphp-embed.post* debian/libphp-embed.pre*

# fink doesn't compress it's man pages
perl -pi -e 's,\.gz,,g' debian/*.extra debian/php-dev.*

# Userdir location
perl -pi -e 's,home,Users,g' debian/php.conf
perl -pi -e 's,public_html,Sites,g' debian/php.conf
<<
###
#UseMaxBuildJobs: false
###
# system-tzdata doesn't work on darwin, disable it
ConfigureParams: <<
--config-cache \
--cache-file=%b/config.cache \
--libdir=%p/lib/php \
--libexecdir=%p/lib/php \
--datadir=%p/share/php/%type_raw[phpver] \
--program-suffix=%type_raw[phpver] \
--sysconfdir=%p/etc \
--localstatedir=%p/var \
--mandir=%p/share/man \
--disable-all \
--disable-debug \
--disable-rpath \
--disable-static \
--with-pic \
--with-layout=GNU \
--without-pear \
--enable-filter \
--with-openssl=%p \
--with-pcre-regex=%p \
--enable-hash \
--with-mhash=%p \
--enable-libxml \
--with-libxml-dir=%p \
--enable-session \
--without-system-tzdata \
--with-zlib \
--disable-dtrace
<<
###
SetCFLAGS: -O2 -Wall -fsigned-char -fno-strict-aliasing -g
SetCPPFLAGS: -MD
CompileScript: <<
#!/bin/sh -ex
if [ "firebird" != "installed" ]; then
	mv debian/rules.d/ext-interbase.mk debian/rules.d/ext-interbase.mk.disabled
fi

ext_CONFARGS="--prefix=%p --enable-cli --disable-cgi --disable-phpdbg \
	--with-config-file-path=/etc/php/%type_raw[phpver]/apache2 \
	--with-config-file-scan-dir=/etc/php/%type_raw[phpver]/apache2/conf.d \
	%c \
	$(grep -- -- debian/rules.d/*.mk | sed -e 's,^.*[:|:=]\s*--,--,' -e 's,\\$,,' | xargs)";

# vpx is not shared in fink, if that changes add shared
apache2_CONFARGS="--prefix=%p --with-apxs2=%p/bin/apxs2 --enable-cli --disable-cgi --disable-phpdbg \
	--with-config-file-path=/etc/php/%type_raw[phpver]/apache2 \
	--with-config-file-scan-dir=/etc/php/%type_raw[phpver]/apache2/conf.d \
	%c \
	--enable-pcntl";

cgi_CONFARGS="--prefix=%p --enable-cgi --enable-cli --disable-phpdbg \
	--enable-force-cgi-redirect --enable-fastcgi \
	--with-config-file-path=/etc/php/%type_raw[phpver]/cgi \
	--with-config-file-scan-dir=/etc/php/%type_raw[phpver]/cgi/conf.d \
	%c \
	--enable-pcntl";

cli_CONFARGS="--prefix=%p --enable-cli --disable-cgi --disable-phpdbg \
	--with-config-file-path=/etc/php/%type_raw[phpver]/cli \
	--with-config-file-scan-dir=/etc/php/%type_raw[phpver]/cli/conf.d \
	%c \
	--enable-pcntl \
	--with-libedit=shared,/usr";

phpdbg_CONFARGS="--prefix=%p --enable-phpdbg --enable-cli --disable-cgi \
	--with-config-file-path=/etc/php/%type_raw[phpver]/phpdbg \
	--with-config-file-scan-dir=/etc/php/%type_raw[phpver]/phpdbg/conf.d \
	%c \
	--enable-pcntl \
	--with-libedit=shared,/usr";

embed_CONFARGS="--prefix=%p --enable-embed --enable-cli --disable-cgi --disable-phpdbg \
	--with-config-file-path=/etc/php/%type_raw[phpver]/embed \
	--with-config-file-scan-dir=/etc/php/%type_raw[phpver]/embed/conf.d \
	%c \
	--without-mm \
	--enable-pcntl";

fpm_CONFARGS="--prefix=%p --enable-fpm --enable-cli --disable-cgi --disable-phpdbg \
	--sysconfdir=/etc/php/%type_raw[phpver]/fpm \
	--with-fpm-user=www --with-fpm-group=www \
	--with-config-file-path=/etc/php/%type_raw[phpver]/fpm \
	--with-config-file-scan-dir=/etc/php/%type_raw[phpver]/fpm/conf.d \
	%c \
	--with-libevent-dir=%p \
	--without-fpm-systemd";

if [ -f ext/ext_skel ]; then mv ext/ext_skel ext/ext_skel.in; fi
sed -i -e "s/EXTRA_VERSION=\"\"/EXTRA_VERSION=\"-%r\"/" configure.in
./buildconf --force

BUILDS='apache2 phpdbg embed fpm cgi cli ext';
for i in $BUILDS; do
	if [ -d %b/$i-build ]; then rm -rf %b/$i-build; fi
	mkdir %b/$i-build;

	CONFARGS=`eval echo "\\${${i}_CONFARGS}"`; \
	cd %b/$i-build && \
		PROG_SENDMAIL="/usr/sbin/sendmail " ../configure ${CONFARGS};

	cd %b/$i-build && make
done
cd %b
echo "Builds done!"
fink-package-precedence --depfile-ext='\.d' *-build
exit 1
<<
###
InfoTest: <<
	TestDepends: <<
		mysql-unified | mysql-server | virtual-mysql-server,
		netcat
	<<
	TestScript: <<
#!/bin/sh -ex

MYSQL_PORT=`for i in $(seq 1025 3600 | sort); do nc -z localhost $i || { echo $i; exit; } ; done`;
MYSQL_DATA_DIR=`greadlink -f mysql_db`;
if [ $MYSQL_PORT == '' ]; then
	echo "Could not find available port for mysql server";
	exit 1;
fi
MYSQL_SOCKET=${MYSQL_DATA_DIR}/mysql.sock;

TESTFILE=%b/test-results.txt

mkdir -p %b/temp_session_store;
# start our own mysql server for the tests
sh -x debian/setup-mysql.sh ${MYSQL_PORT} ${MYSQL_DATA_DIR};
extensions=""; \
for f in %b/ext-build/modules/*.so; do \
	  ext=`basename "$f"`; \
	  test -d "%b/ext/${ext%%%%.so}/tests" || continue; \
	  test "$ext" != "imap.so" || continue; \
	  test "$ext" != "interbase.so" || continue; \
	  test "$ext" != "ldap.so" || continue; \
	  test "$ext" != "odbc.so" || continue; \
	  test "$ext" != "pgsql.so" || continue; \
	  test "$ext" != "pdo_dblib.so" || continue; \
	  test "$ext" != "pdo_firebird.so" || continue; \
	  test "$ext" != "pdo_odbc.so" || continue; \
	  test "$ext" != "pdo_pgsql.so" || continue; \
	  test "$ext" != "snmp.so" || continue; \
	  test "$ext" != "opcache.so" || continue; \
	  test "$ext" != "mysqlnd.so" || continue; \
	  test "$ext" != "mysqli.so" || continue; \
	  test "$ext" != "pdo_mysql.so" || continue; \
	  test "$ext" != "wddx.so" || continue; \
	  extensions="$extensions -d extension=$ext"; \
done; \
[ "$extensions" ] || { echo "extensions list is empty"; exit 1; }; \
env MYSQL_TEST_HOST=127.0.0.1 MYSQL_TEST_PORT=${MYSQL_PORT} MYSQL_TEST_SOCKET=${MYSQL_SOCKET} PDO_MYSQL_TEST_HOST=127.0.0.1 PDO_MYSQL_TEST_PORT=${MYSQL_PORT} PDO_MYSQL_TEST_SOCKET=${MYSQL_SOCKET} NO_INTERACTION=1 TEST_PHP_CGI_EXECUTABLE=%b/cgi-build/sapi/php-cgi TEST_PHP_EXECUTABLE=%b/cli-build/sapi/cli/php \
%b/cli-build/sapi/cli/php run-tests.php -n -d mysql.default_host=127.0.0.1 -d mysql.default_socket=${MYSQL_SOCKET} -d mysqli.default_socket=${MYSQL_SOCKET} -d extension_dir=%b/ext-build/modules/ $extensions| tee ${TESTFILE}
rm -rf %b/temp_session_store
for test in `find . -name '*.log' -a '!' -name 'config.log' -a '!' -name 'bootstrap.log' -a '!' -name 'run.log'`; do \
	  echo; \
	  echo -n "${test#./}:"; \
	  cat $test; \
	  echo; \
done | tee -a ${TESTFILE}
sh -x debian/setup-mysql.sh ${MYSQL_PORT} ${MYSQL_DATA_DIR} stop
	<<
<<
###
InstallScript: <<
#!/bin/bash -ex

MODULES=
while read i; do
	if [ "${MODULES}" = "" ]; then
		MODULES=${i%_EXTENSIONS*};
	else
		MODULES="${MODULES} ${i%_EXTENSIONS*}";
	fi
	declare "ext_${i%_EXTENSIONS*}=${i##*:= }";
done < <(grep "EXTENSIONS\s*:=" debian/rules.d/*.mk | sed -e 's;^[^:]*:;;')

# setup
SED_VARIABLES= \
	sed -e "s,@sapi@,${sapi},g"				|\
	sed -e "s,@package@,${package},g"			|\
	sed -e "s,@extensions@,${extensions},g"			|\
	sed -e "s,@module@,${module},g"				|\
	sed -e "s,@extdir@,${extdir},g"				|\
	sed -e "s,@priority@,${priority},g"			|\
	sed -e "s,@PHP_VERSION@,$(PHP_NAME_VERSION),g"		|\
	sed -e "s,@PHP_MAJOR@,$(PHP_MAJOR_VERSION),g"		|\
	sed -e "s,@PHP_MINOR@,$(PHP_MINOR_VERSION),g"		|\
	sed -e "s,@PHP_RELEASE@,$(PHP_RELEASE_VERSION),g"	|\
	sed -e "s,@PHP_API@,$(PHP_ZEND_VERSION),g"

SED_REPLACEMENT=sed -e "/\#EXTRA\#/ r debian/${versionless}.${tmpl}.extra" | ${SED_VARIABLES} | sed -e '/\#EXTRA\#/ d'

PREPARE_FILES=$(cat debian/prepare-files | sed -e 's,^,debian/,')

# prepare-files-stamp FIXME
# Do this first so we don't overwrite any debhelper-generated files
#
# generate versioned files from versionless variants
for file in ${(PREPARE_FILES}; do \
	versionless=$(echo $file | sed -e 's/@PHP_VERSION@//g'); \
	versioned=$(echo $file | sed -e 's/@PHP_VERSION@/%type_raw[phpver]/g'); \
	package=$(echo $file | sed -e 's,^debian/,,;s/\..*$//;s/@PHP_VERSION@/%type_raw[phpver]/g'); \
	    < ${versionless} ${SED_REPLACEMENT} > ${versioned}; \
	if [ -x ${versionless} ]; then chmod +x ${versioned}; fi; \
done

# generate config snippets and maintscripts for the different sapi implementations
# from the templates
for sapi in $(REAL_TARGETS); do \
	$(SAPI_PACKAGE) \
	mkdir -p "debian/tmp/usr/lib/php/%type_raw[phpver]/sapi/"; \
	touch "debian/tmp/usr/lib/php/%type_raw[phpver]/sapi/$${sapi}"; \
	for tmpl in postrm prerm postinst dirs install triggers bug-script bug-control; do \
	    < debian/php-sapi.$${tmpl} $(SED_REPLACEMENT) > debian/$${package}.$${tmpl}; \
	    if [ -x debian/php-sapi.$${tmpl} ]; then chmod +x debian/$${package}.$${tmpl}; fi; \
	done; \
	< debian/php-sapi.lintian-overrides $(SED_REPLACEMENT) | grep -E "^$${package}" > debian/$${package}.lintian-overrides; \
done

for module in $(ext_PACKAGES); do \
	package=php%type_raw[phpver]-$${module}; \
	extensions=$$(eval echo \$${$${module}_EXTENSIONS}); \
	description=$$(eval echo \$${$${module}_DESCRIPTION}); \
	for tmpl in preinst postinst postrm prerm bug-script bug-control triggers dirs substvars lintian-overrides; do \
	      < debian/php-module.$${tmpl}.in \
		$(SED) -e "/\#EXTRA\#/ r debian/$${package}.$${tmpl}.extra" | \
		$(SED) -e "s,@package@,$${package},g"		\
	           -e "s,@extensions@,$${extensions},g"		\
	           -e "s,@module@,$${module},g"			\
	           -e "s|@description@|$${description}|g"	\
	           -e "s,@PHP_VERSION@,%type_raw[phpver],g"	\
	           -e "s,@PHP_API@,$${phpapi},g" | \
		$(SED) -e '/\#EXTRA\#/ d' \
	      > debian/$${package}.$${tmpl}; \
	  done; \
	  provides=""; \
	  for dsoname in $${extensions}; do \
	    normalized=$$(echo $${dsoname} | sed -e 's/_/-/g'); \
	    priority=$$(eval echo \$${$${dsoname}_PRIORITY}); \
	    if [ -z "$${priority}" ]; then priority=20; fi; \
	    extension=$$(eval echo \$${$${dsoname}_EXTENSION}); \
	    if [ -z "$${extension}" ]; then extension=extension; fi; \
	    mkdir -p debian/tmp/usr/share/$${package}/$${module}/; \
	    $(SED) -e "s,@extname@,$${module}," \
	           -e "s,@dsoname@,$${dsoname}," \
	           -e "s,@extension@,$${extension}," \
	           -e "s,@priority@,$${priority}," \
	      < debian/php-module.ini.in \
	      > debian/tmp/usr/share/$${package}/$${module}/$${dsoname}.ini; \
	    echo "usr/lib/php/*/$${dsoname}.so" >> debian/$${package}.install; \
	    echo "usr/share/$${package}/$${module}/$${dsoname}.ini" >> debian/$${package}.install; \
	    if [ "$${normalized}" != "gettext" ]; then provides="php-$${normalized}, $${provides}"; fi; \
	    if [ "$${module}" != "$${normalized}" ]; then provides="php%type_raw[phpver]-$${normalized}, $${provides}"; fi; \
	  done; \
	  echo "php-$${module}:Provides=$${provides}" >> debian/$${package}.substvars; \
	done
	touch prepare-files-stamp

for mod in $MODULES; do
	extensions=ext_${mod};
	echo ${mod}: ${!extensions};
done

# dh_installdirs
for i in debian/*.dirs; do \
	p=$(basename $i | sed -e 's,\.dirs$,,'); \
	for j in `cat $i`; do \
		mkdir -p debian/$p/$j; \
	done; \
done

# Share Docfiles, less dups
cat debian/modulelist | grep -v common | while read package extname dsoname priority; do \
	rm -rf debian/%n-${package}%p/share/doc/%n-$package; \
	mkdir -p debian/%n-${package}%p/share/doc; \
	ln -s %n-common debian/%n-${package}%p/share/doc/%n-$package; \
done

for package in %n php-pear %n-dbg %n-dev %n-cgi %n-cli %n-phpdbg %n-fpm libapache2-mod-%n libapache2-mod-%nfilter lib%n-embed; do \
	rm -rf debian/${package}%p/share/doc/$package; \
	mkdir -p debian/${package}%p/share/doc; \
	ln -s %n-common debian/${package}%p/share/doc/$package; \
done

# some other helpful (for readability at least) shorthand variables
PHPIZE_BUILDDIR=debian/%n-dev%p/lib/%n/build

PCNTL_FUNCTIONS=$(cat %b/ext/pcntl/php_pcntl.h | sed -ne "/^PHP_FUNCTION/ s/PHP_FUNCTION(\(.*\));/\1/;t end;d;:end p" | tr '\n' ',')

#chmod 01733 debian/%n-common%p/var/lib/%n/sessions/

# Mangle apache2filter DSO name before running dh_apache2
mv %b/apache2filter-build/libs/lib%n.so %b/apache2filter-build/libs/lib%nfilter.so

# install apache2 DSO module
#dh_apache2 --conditional=%N_enable
a2moddir=$(apxs2 -q exp_libexecdir); \
a2etcdir=$(apxs2 -q exp_sysconfdir); \
for i in debian/*.apache2; do \
	pn=$(basename ${i%%.*}); \
	cat $i | while read j; do \
		t=$(echo $j | awk '{print $1}'); \
		f=$(echo $j | awk '{print $2}'); \
		ext=${j##*.}; \
		if [ "$t" = "conf" ]; then \
			availdir="conf-available";
		else \
			availdir="mods-available";
		fi; \
		case "$ext" in \
			so) \
				install -d -m0755 debian/${pn}${a2moddir}; \
				install -m0644 $f debian/${pn}${a2moddir}/; \
				;; \
			conf|load) \
				install -d -m0755 debian/${pn}${a2etcdir}/$availdir; \
				install -m0644 $f debian/${pn}${a2etcdir}/$availdir/; \
				;; \
		esac; \
	done; \
done

# sanitize php.ini file
cat php.ini-production | tr "\t" " " | \
sed -e'/session.gc_probability =/ s/1/0/g;' \
    -e"/disable_functions =/ s/$/ ${PCNTL_FUNCTIONS}/g;" \
    -e'/expose_php =/ s/On/Off/g;' \
  > debian/%n-common%p/share/%n/php.ini-production
cat php.ini-production | tr "\t" " " | \
sed -e'/memory_limit =/ s/128M/-1/g;' \
    -e'/session.gc_probability =/ s/1/0/g' \
  > debian/%n-common%p/share/%n/php.ini-production.cli
cat php.ini-development | tr "\t" " " | \
sed -e'/session.gc_probability =/ s/1/0/g;' \
    -e"/disable_functions =/ s/$/ ${PCNTL_FUNCTIONS}/g;" \
  > debian/%n-common%p/share/%n/php.ini-development
if [ -f test-results.txt ]; then \
	cp test-results.txt debian/%n-common%p/share/doc/%n-common/; \
fi

# Install helper shell fragment
install -m644 debian/%n-helper debian/%n-common%p/share/%n/
install -m644 debian/debhelper/%n-maintscript-helper debian/%n-common%p/share/%n/

# install embed SAPI
cd %b/embed-build && make install-headers install-build install-sapi install-programs INSTALL_ROOT=%b/debian/lib%n-embed

# install the apache modules' files
cd %b/apache2-build && make install-headers install-build install-modules install-programs INSTALL_ROOT=%b/debian/libapache2-mod-%n

# install the headers from cgi-build
cd %b/cgi-build && make install-headers INSTALL_ROOT=%b/debian/%n-dev

# remove netware and win32 headers that we don't want
cd %b/debian/libapache2-mod-%n%p/include/%n/ && \
rm -f TSRM/readdir.h \
	TSRM/tsrm_config.nw.h TSRM/tsrm_config.w32.h\
	TSRM/tsrm_nw.h TSRM/tsrm_win32.h\
	Zend/zend_config.nw.h Zend/zend_config.w32.h\
	main/config.nw.h main/config.w32.h\
	main/win95nt.h

cd %b

# install PEAR
cp -a pear-build/* debian/php-pear/

# everything under %p/share/php/data except 'PEAR' is b0rken
# and actually needs to be fixed
if [ -f debian/php-pear%p/share/php/data/Structures_Graph/LICENSE ]; then \
	rm -f debian/php-pear%p/share/php/data/Structures_Graph/LICENSE; \
fi
if [ -f debian/php-pear%p/share/php/doc/PEAR/INSTALL ]; then \
	rm -f debian/php-pear%p/share/php/doc/PEAR/INSTALL; \
fi
if [ -f debian/php-pear%p/share/php/doc/Structures_Graph/docs/generate.sh ]; then \
	rm -f debian/php-pear%p/share/php/doc/Structures_Graph/docs/generate.sh; \
fi
for f in Structures_Graph/publish.sh Structures_Graph/package.sh \
	Structures_Graph/genpackage.xml.pl; do \
	rm -f debian/php-pear%p/share/php/data/$f; \
done
# we don't want test suites
rm -rf debian/php-pear%p/share/php/test/
if [ -d debian/php-pear%p/share/php/doc ]; then \
	mkdir -p debian/php-pear%p/share/doc/%n-common/PEAR; \
	mv debian/php-pear%p/share/php/doc/* \
		debian/php-pear%p/share/doc/%n-common/PEAR/; \
	rm -rf debian/php-pear%p/share/php/doc; \
	ln -s ../doc/php-pear/PEAR debian/php-pear%p/share/php/doc; \
	echo "Dummy placeholder to prevent the directory's deletion" > \
		debian/php-pear%p/share/doc/%n-common/PEAR/.placeholder; \
fi

# install extensions
ext=`./debian/libapache2-mod-%n%p/bin/php-config --extension-dir`;\
for i in libapache2-mod-%n libapache2-mod-%nfilter %n-cgi %n-cli %n-phpdbg lib%n-embed %n-fpm; do \
	mkdir -p debian/$i/${ext}; \
done; \
cat debian/modulelist debian/extramodulelist | while read package extname dsoname priority; do \
	if [ "$package" = "mysqlnd" ]; then \
		modulepath=cgi-build/modules; \
	elif [ "$package" = "readline" ]; then \
		modulepath=cli-build/modules; \
	else \
		modulepath=debian/libapache2-mod-%n/${ext}; \
	fi; \
	if [ -z "$dsoname" ]; then dsoname=$package; fi; \
	mkdir -p debian/%n-$package${ext}; \
	install -m 644 \
		${modulepath}/$dsoname.so \
		debian/%n-$package${ext}/$dsoname.so; \
	rm -f ${modulepath}/$dsoname.so; \
done

# install CGI
cp cgi-build/sapi/cgi/cgi-bin.%n debian/%n-cgi%p/lib/cgi-bin/%n
cp cgi-build/sapi/cgi/usr.bin.%n-cgi debian/%n-cgi%p/bin/%n-cgi
cp cli-build/sapi/cli/php.1 debian/%n-cgi%p/share/man/man1/%n-cgi.1

# install CLI
cp cli-build/sapi/cli/php debian/%n-cli%p/bin/%n
cp cli-build/sapi/cli/php.1 debian/%n-cli%p/share/man/man1/%n.1
cp cli-build/ext/phar/phar.phar debian/%n-cli%p/bin/phar5
cp cli-build/ext/phar/phar.1 debian/%n-cli%p/share/man/man1/phar5.1

# install PHPDBG
cp phpdbg-build/sapi/phpdbg/phpdbg debian/%n-phpdbg%p/bin/%ndbg
cp debian/%ndbg.1 debian/%n-phpdbg%p/share/man/man1/%ndbg.1

# install FPM
mkdir -p debian/%n-fpm%p/sbin debian/%n-fpm%p/share/man/man8/ debian/%n-fpm%p/etc/%n/fpm/pool.d
cp fpm-build/sapi/fpm/php-fpm debian/%n-fpm%p/sbin/%n-fpm
cp fpm-build/sapi/fpm/php-fpm.8 debian/%n-fpm%p/share/man/man8/%n-fpm.8
# we don't want the pool definitions on the main file itself:
sed -r '/('"'"'|\[)www('"'"'|\])/Q' < fpm-build/sapi/fpm/php-fpm.conf | \
sed -e's{pid = /var/run/%n-fpm.pid{pid = %p/var/run/%n-fpm.pid{' \
    > debian/%n-fpm%p/etc/%n/fpm/php-fpm.conf
# extract the first pool, called "www," from the config file:
sed -nr '/('"'"'|\[)www('"'"'|\])/{h;p;d};x;/www/{x;p}' < fpm-build/sapi/fpm/php-fpm.conf | \
sed -e's{^;listen\.owner{listen.owner{;' \
    -e's{^;listen\.group{listen.group{;' \
    > debian/%n-fpm%p/etc/%n/fpm/pool.d/www.conf
# install a helper script for checking PHP FPM configuration
install -m 755 debian/%n-fpm-checkconf debian/%n-fpm%p/lib/%n/
install -m 755 debian/%n-fpm-reopenlogs debian/%n-fpm%p/lib/%n/

# move and install -dev files
#dh_movefiles --sourcedir=debian/lib%n-embed
for i in `cat debian/%n-dev.files`; do \
	if [ -e debian/lib%n-embed/$i ]; then \
		mkdir -p debian/%n-dev/${i%%/*}; \
		cp -R debian/lib%n-embed/$i debian/%n-dev/${i%%/*}/; \
		if [ -f debian/%n-dev/$i ]; then
			rm -f debian/lib%n-embed/$i; \
			grmdir --ignore-fail-on-non-empty -p debian/lib%n-embed/${i%%/*}; \
		else \
			grmdir --ignore-fail-on-non-empty -p debian/lib%n-embed/$i; \
		fi;
	fi; \
done
#dh_movefiles --sourcedir=debian/libapache2-mod-%n
for i in `cat debian/%n-dev.files`; do \
	if [ -e debian/libapache2-mod-%n/$i ]; then \
		mkdir -p debian/%n-dev/${i%%/*}; \
		cp -R debian/libapache2-mod-%n/$i debian/%n-dev/${i%%/*}/; \
		if [ -f debian/libapache2-mod-%n/$i ]; then \
			rm -f debian/libapache2-mod-%n/$i; \
			grmdir --ignore-fail-on-non-empty -p debian/libapache2-mod-%n/${i%%/*}; \
		else \
			grmdir --ignore-fail-on-non-empty -p debian/libapache2-mod-%n/$i; \
		fi; \
	fi; \
done
rm -rf debian/lib%n-embed%p/include/ \
       debian/lib%n-embed%p/bin/
rm -rf debian/libapache2-mod-%n%p/lib/%n/build/ \
       debian/libapache2-mod-%n%p/include/ \
       debian/libapache2-mod-%n%p/bin/
rm -rf debian/libapache2-mod-%nfilter%p/lib/%n/build/ \
       debian/libapache2-mod-%nfilter%p/include/ \
       debian/libapache2-mod-%nfilter%p/bin/
for i in Makefile.global acinclude.m4 mkdep.awk phpize.m4 scan_makefile_in.awk; do \
	chmod 644 debian/%n-dev%p/lib/%n/build/$i; \
done
mkdir -p debian/%n-dev%p/share/%n
cp -a ext/skeleton ext/ext_skel debian/%n-dev%p/share/%n
sed -i 's/skel_dir="skeleton"/skel_dir="\%p\/share\/%n\/skeleton"/' \
    debian/%n-dev%p/share/%n/ext_skel

# shipping duplicate files from other packages is hell for security audits
ln -sf %p/share/libtool/build-aux/config.guess ${PHPIZE_BUILDDIR}/config.guess
ln -sf %p/share/libtool/build-aux/config.sub ${PHPIZE_BUILDDIR}/config.sub
ln -sf %p/share/aclocal/libtool.m4 ${PHPIZE_BUILDDIR}/libtool.m4
ln -sf %p/share/libtool/build-aux/ltmain.sh ${PHPIZE_BUILDDIR}/ltmain.sh
# FIXME: No fink version?
#ln -sf /usr/bin/shtool ${PHPIZE_BUILDDIR}/shtool
# make php-dev stuff versioned
for i in php-config phpize; do \
	mv debian/%n-dev%p/bin/$i debian/%n-dev%p/bin/${i}%type_raw[phpver]; \
	mv debian/%n-dev%p/share/man/man1/${i}.1 debian/%n-dev%p/share/man/man1/${i}%type_raw[phpver].1; \
done
# remove windows devel file
rm -f debian/%n-dev%p/share/%n/skeleton/skeleton.dsp

# install common files
install -m755 debian/sessionclean debian/%n-common%p/lib/%n
install -m755 debian/%nenmod debian/%n-common%p/sbin/%nenmod
ln -s %nenmod debian/%n-common%p/sbin/%ndismod
install -m755 debian/%nquery debian/%n-common%p/sbin/%nquery

# remove libtool files
rm -f debian/lib%n-embed%p/lib/%n/lib%n.la
mv debian/lib%n-embed%p/lib/%n/* debian/lib%n-embed%p/lib/

# install lintian overrides
cp debian/%n-common.lintian-overrides debian/%n-common%p/share/lintian/overrides/%n-common
cp debian/%n-dev.lintian-overrides debian/%n-dev%p/share/lintian/overrides/%n-dev
cp debian/php-pear.lintian-overrides debian/php-pear%p/share/lintian/overrides/php-pear

# install some generic lintian overrides
ext=`debian/%n-dev%p/bin/php-config5 --extension-dir | cut -b2- `; \
for sapi in %n-cli %n-phpdbg %n-fpm %n-cgi libapache2-mod-%n libapache2-mod-%nfilter lib%n-embed; do \
	mkdir -p debian/"$sapi"%p/share/lintian/overrides/; \
	sed "s/@sapi@/$sapi/g;s,@extdir@,$ext,g" \
	    < debian/%n-sapi.lintian-overrides | \
	grep -E "^${sapi}: " \
	    >> debian/"$sapi"%p/share/lintian/overrides/"$sapi"; \
done

# directories cleanup:
grmdir --ignore-fail-on-non-empty -p debian/libapache2-mod-%n%p/share/man/man1 || true
find debian/php-pear -type d -exec grmdir --ignore-fail-on-non-empty -p '{}' \; 2>&1 >/dev/null || true

# dh_installcron -p%n-common --name=%n
install -d -m0755 debian/%n-common%p/etc/cron.d
install -m644 debian/%n-common.%n.cron.d debian/%n-common%p/etc/cron.d/%n

#dh_installlogrotate -p%n-fpm
install -d -m0755 debian/%n-fpm%p/etc/logrotate.d
install -m644 debian/%n-fpm.logrotate debian/%n-fpm%p/etc/logrotate.d/%n-fpm

# install init scripts
install -d -m755 debian/%n-fpm%p/sbin
install -m755 debian/%n-fpm.init debian/%n-fpm%p/sbin/%n-fpmctl

# remove static modules and leftovers
rm -rf debian/libapache2-mod-%n%p/lib/%n
rm -rf debian/lib%n-embed%p/lib/%n
rm -rf debian/lib%n-embed%p/lib/build

# relink dylib
rm debian/lib%n-embed%p/lib/lib%n.dylib
mkdir -p debian/%n-dev%p/lib
ln -s %p/lib/lib%n.0.dylib debian/%n-dev%p/lib/lib%n.dylib
<<
###
SplitOff: <<
	Package: %N-dev
	BuildDependsOnly: true
	RunTimeDepends: <<
		%N-common (= %v-%r)
	<<
	Recommends: <<
		dh-%N,
		pkg-php-tools,
		autoconf2.6,
		automake1.15,
		libpcre1-dev,
		libtool2,
		openssl100-dev
	<<
	InstallScript: <<
debian/finkdebhelper.sh "%n" "%p" "%i"
	<<
	Description: Files for PHP5 module development
	DescDetail: <<
This package provides the files from the PHP5 source needed for compiling
additional modules.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
	<<
<<
SplitOff2: <<
	Package: lib%N-embed
	Depends: <<
		bzip2-shlibs,
		db53-aes-shlibs,
		libcomerr2,
		libgettext8-shlibs,
		libiconv,
		libonig2-shlibs,
		libpcre1-shlibs,
		libxml2-shlibs (>= 2.9.0),
		openssl100-shlibs,
		qdbm14-shlibs
	<<
	RunTimeDepends: <<
		%N-common (= %v-%r),
		ucf
	<<
	Suggests: <<
		php-pear
	<<
	Replaces: lib%N-embed5
	InstallScript: <<
debian/finkdebhelper.sh "%n" "%p" "%i"
	<<
	Shlibs: <<
		%p/lib/lib%N.0.dylib 1.0.0 lib%N-embed (>= 5.6.27-1)
	<<
	Description: SAPI library for embedding PHP5
	DescDetail: <<
This package provides the library %p/lib/lib%N.dylib which can be used by
application developers to embed PHP scripting functionality.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
	<<
<<
SplitOff3: <<
	Package: php-pear
	Provides: php-xml-util
	RunTimeDepends: <<
		%N-common (= %v-%r),
		%N-cli
	<<
	Recommends: <<
		gnupg2 | gnupg
	<<
	Suggests: <<
		%N-dev
	<<
	Conflicts: <<
		php-xml-util
	<<
	Replaces: <<
		php4-pear (<< 4:4.4.0-0),
		php-xml-util
	<<
	InstallScript: <<
debian/finkdebhelper.sh "%n" "%p" "%i"
	<<
	Description: PHP Extension and Application Repository
	DescDetail: <<
This package contains the base PEAR classes for PHP, as well as the PEAR
installer. Many PEAR classes are already packaged for Debian, and can be easily
identified by names beginning with "php-", such as php-db and php-auth.
Note: to build and install precompiled PECL extensions, you will need one of
the php development packages installed.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
	<<
<<
### Start of Standard Modules 20+
SplitOff20: <<
	Package: %N-curl
	Depends: <<
		libcurl4-shlibs
	<<
	RunTimeDepends: <<
		%N-common (= %v-%r),
		phpapi-%type_raw[sapiver],
		ucf
	<<
	InstallScript: <<
debian/finkdebhelper.sh "%n" "%p" "%i"
	<<
	Description: CURL module for %N
	DescDetail: <<
CURL is a library for getting files from  FTP, GOPHER, HTTP server.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
	<<
<<
SplitOff21: <<
	Package: %N-enchant
	Depends: <<
		enchant1-shlibs
	<<
	RunTimeDepends: <<
		%N-common (= %v-%r),
		phpapi-%type_raw[sapiver],
		ucf
	<<
	InstallScript: <<
debian/finkdebhelper.sh "%n" "%p" "%i"
	<<
	Description: Enchant module for %N
	DescDetail: <<
This package provides a module for the generic spell checking library
Enchant, which can use engines such as ispell, aspell and myspells.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
	<<
<<
SplitOff22: <<
	Package: %N-gd
	Depends: <<
		freetype219-shlibs (>= 2.6-1),
		gd3-shlibs,
		libjpeg9-shlibs,
		libpng16-shlibs
	<<
	RunTimeDepends: <<
		%N-common (= %v-%r),
		phpapi-%type_raw[sapiver],
		ucf
	<<
	InstallScript: <<
debian/finkdebhelper.sh "%n" "%p" "%i"
	<<
	Description: GD module for %N
	DescDetail: <<
This package provides a module for handling graphics directly from PHP
scripts. It supports the PNG, JPEG, XPM formats as well as Freetype/ttf fonts.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
	<<
<<
SplitOff23: <<
	Package: %N-gmp
	Depends: <<
		gmp5-shlibs
	<<
	RunTimeDepends: <<
		%N-common (= %v-%r),
		phpapi-%type_raw[sapiver],
		ucf
	<<
	InstallScript: <<
debian/finkdebhelper.sh "%n" "%p" "%i"
	<<
	Description: GMP module for %N
	DescDetail: <<
This package provides a module for arbitrary precision arithmetic via the
GNU Multiple Precision (GMP) Arithmetic Library.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
	<<
<<
SplitOff24: <<
	Package: %N-imap
	Depends: <<
		libc-client1-shlibs,
		libcomerr2,
		openssl100-shlibs
	<<
	RunTimeDepends: <<
		%N-common (= %v-%r),
		phpapi-%type_raw[sapiver],
		ucf
	<<
	InstallScript: <<
debian/finkdebhelper.sh "%n" "%p" "%i"
	<<
	Description: IMAP module for %N
	DescDetail: <<
This package provides a module for IMAP functions in PHP scripts.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
	<<
<<
#SplitOff25: <<
#	Package: %N-interbase
#	Depends: <<
#	<<
#	RunTimeDepends: <<
#		%N-common (= %v-%r),
#		phpapi-%type_raw[sapiver],
#		ucf
#	<<
#	InstallScript: <<
#debian/finkdebhelper.sh "%n" "%p" "%i"
#	<<
#	Description: Interbase/Firebird module for %N
#	DescDetail: <<
#This package provides a module for interbase/firebird functions in PHP scripts.
#
#PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
#source general-purpose scripting language that is especially suited for web
#development and can be embedded into HTML.
#	<<
#<<
SplitOff26: <<
	Package: %N-intl
	Provides: %N-idn
	Depends: <<
		libicu55-shlibs
	<<
	RunTimeDepends: <<
		%N-common (= %v-%r),
		phpapi-%type_raw[sapiver],
		ucf
	<<
	Conflicts: <<
		%N-idn
	<<
	Replaces: <<
		%N-idn
	<<
	InstallScript: <<
debian/finkdebhelper.sh "%n" "%p" "%i"
	<<
	Description: Internationalisation module for %N
	DescDetail: <<
This package provides a module to ease internationalisation of PHP scripts.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
	<<
<<
SplitOff27: <<
	Package: %N-ldap
	Depends: <<
		cyrus-sasl2-shlibs,
		openldap24-shlibs
	<<
	RunTimeDepends: <<
		%N-common (= %v-%r),
		phpapi-%type_raw[sapiver],
		ucf
	<<
	InstallScript: <<
debian/finkdebhelper.sh "%n" "%p" "%i"
	<<
	Description: LDAP module for %N
	DescDetail: <<
This package provides a module for LDAP functions in PHP scripts.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
	<<
<<
SplitOff28: <<
	Package: %N-mcrypt
	Depends: <<
		libmcrypt-shlibs,
		libtool2-shlibs
	<<
	RunTimeDepends: <<
		%N-common (= %v-%r),
		phpapi-%type_raw[sapiver],
		ucf
	<<
	InstallScript: <<
debian/finkdebhelper.sh "%n" "%p" "%i"
	<<
	Description: MCrypt module for %N
	DescDetail: <<
This package provides a module for MCrypt functions in PHP scripts.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
	<<
<<
SplitOff30: <<
	Package: %N-mysql
	Depends: <<
		mysql-unified-shlibs | libmysqlclient18-shlibs
	<<
	RunTimeDepends: <<
		%N-common (= %v-%r),
		phpapi-%type_raw[sapiver],
		ucf
	<<
	InstallScript: <<
debian/finkdebhelper.sh "%n" "%p" "%i"
	<<
	Description: MySQL module for %N
	DescDetail: <<
This package provides modules for MySQL database connections directly from
PHP scripts.  It includes the generic "mysql" module which can be used
to connect to all versions of MySQL, an improved "mysqli" module for
MySQL version 4.1 or later, and the pdo_mysql module for use with
the PHP Data Object extension.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
	<<
<<
SplitOff31: <<
	Package: %N-odbc
	Depends: <<
		libodbc3-shlibs
	<<
	RunTimeDepends: <<
		%N-common (= %v-%r),
		phpapi-%type_raw[sapiver],
		ucf
	<<
	InstallScript: <<
debian/finkdebhelper.sh "%n" "%p" "%i"
	<<
	Description: ODBC module for %N
	DescDetail: <<
This package provides a module for database access through ODBC drivers.
It uses the unixODBC library as an ODBC provider.  It also contains the
pdo_odbc module, for use with the PHP Data Object extension.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
	<<
<<
SplitOff32: <<
	Package: %N-pgsql
	Depends: <<
		postgresql96-shlibs
	<<
	RunTimeDepends: <<
		%N-common (= %v-%r),
		phpapi-%type_raw[sapiver],
		ucf
	<<
	InstallScript: <<
debian/finkdebhelper.sh "%n" "%p" "%i"
	<<
	Description: PostgreSQL module for %N
	DescDetail: <<
This package provides a module for PostgreSQL database connections
directly from PHP scripts.  It also includes the pdo_pgsql module for
use with the PHP Data Object extension.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
	<<
<<
SplitOff33: <<
	Package: %N-pspell
	Depends: <<
		aspell-shlibs
	<<
	RunTimeDepends: <<
		%N-common (= %v-%r),
		phpapi-%type_raw[sapiver],
		ucf
	<<
	InstallScript: <<
debian/finkdebhelper.sh "%n" "%p" "%i"
	<<
	Description: Pspell module for %N
	DescDetail: <<
This package provides a module for pspell functions in PHP scripts.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
	<<
<<
SplitOff34: <<
	Package: %N-readline
	Depends: <<
		libncurses5-shlibs
	<<
	RunTimeDepends: <<
		%N-common (= %v-%r),
		phpapi-%type_raw[sapiver],
		ucf
	<<
	InstallScript: <<
debian/finkdebhelper.sh "%n" "%p" "%i"
	<<
	Description: Readline module for %N
	DescDetail: <<
This package provides a module for readline functions (based on libedit) in PHP
scripts.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
	<<
<<
SplitOff35: <<
	Package: %N-recode
	Depends: <<
		recode-shlibs
	<<
	RunTimeDepends: <<
		%N-common (= %v-%r),
		phpapi-%type_raw[sapiver],
		ucf
	<<
	InstallScript: <<
debian/finkdebhelper.sh "%n" "%p" "%i"
	<<
	Description: Recode module for %N
	DescDetail: <<
This package provides a module for recode - character set recoding.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
	<<
<<
SplitOff36: <<
	Package: %N-snmp
	Depends: <<
		libnetsnmp30-shlibs
	<<
	RunTimeDepends: <<
		%N-common (= %v-%r),
		phpapi-%type_raw[sapiver],
		ucf
	<<
	InstallScript: <<
debian/finkdebhelper.sh "%n" "%p" "%i"
	<<
	Description: SNMP module for %N
	DescDetail: <<
This package provides a module for SNMP functions in PHP scripts.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
	<<
<<
SplitOff37: <<
	Package: %N-sqlite
	Provides: <<
		%N-sqlite3
	<<
	Depends: <<
		sqlite3-shlibs
	<<
	RunTimeDepends: <<
		%N-common (= %v-%r),
		phpapi-%type_raw[sapiver],
		ucf
	<<
	InstallScript: <<
debian/finkdebhelper.sh "%n" "%p" "%i"
	<<
	Description: SQLite module for %N
	DescDetail: <<
This package provides a module allowing you to use the SQLite self-contained
database engine from within your PHP scripts, eliminating the need for a full
SQL server installation like MySQL or PostgreSQL.  It also includes the
pdo_sqlite module, for use with the PHP Data Object extension.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
	<<
<<
SplitOff38: <<
	Package: %N-sybase
	Provides: %N-mssql
	Depends: <<
		libsybdb5-shlibs
	<<
	RunTimeDepends: <<
		%N-common (= %v-%r),
		phpapi-%type_raw[sapiver],
		ucf
	<<
	InstallScript: <<
debian/finkdebhelper.sh "%n" "%p" "%i"
	<<
	Description: Sybase / MS SQL Server module for %N
	DescDetail: <<
This package provides a module for Sybase and Microsoft SQL Server
database connections directly from PHP scripts. It also includes the
pdo_dblib module for use with the PHP Data Object extension.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
	<<
<<
SplitOff39: <<
	Package: %N-tidy
	Depends: <<
		libtidy5-shlibs
	<<
	RunTimeDepends: <<
		%N-common (= %v-%r),
		phpapi-%type_raw[sapiver],
		ucf
	<<
	InstallScript: <<
debian/finkdebhelper.sh "%n" "%p" "%i"
	<<
	Description: Tidy module for %N
	DescDetail: <<
This package provides a module for tidy functions in PHP scripts.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
	<<
<<
SplitOff40: <<
	Package: %N-xmlrpc
	Depends: <<
		libxml2-shlibs (>= 2.6.27)
	<<
	RunTimeDepends: <<
		%N-common (= %v-%r),
		phpapi-%type_raw[sapiver],
		ucf
	<<
	InstallScript: <<
debian/finkdebhelper.sh "%n" "%p" "%i"
	<<
	Description: XML-RPC module for %N
	DescDetail: <<
This package provides a module for XML-RPC functions in PHP scripts.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
	<<
<<
SplitOff41: <<
	Package: %N-xsl
	Depends: <<
		libxslt-shlibs
	<<
	RunTimeDepends: <<
		%N-common (= %v-%r),
		phpapi-%type_raw[sapiver],
		ucf
	<<
	InstallScript: <<
debian/finkdebhelper.sh "%n" "%p" "%i"
	<<
	Description: XSL module for %N
	DescDetail: <<
This package provides a module for XSL using the libxslt XSL parser.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
	<<
<<
### This where the sapis start 80+
SplitOff80: <<
	Package: libapache2-mod-%N
	Provides: <<
		%N-bcmath,
		%N-bz2,
		%N-mbstring,
		%N-soap,
		%N-xml,
		%N-zip
	<<
	Depends: <<
		bzip2-shlibs,
		db53-aes-shlibs,
		libapr.0-shlibs,
		libaprutil.0-shlibs,
		libcomerr2,
		libgettext8-shlibs,
		libiconv,
		libonig2-shlibs,
		libpcre1-shlibs,
		libxml2-shlibs (>= 2.9.0),
		openssl100-shlibs,
		qdbm14-shlibs
	<<
	RunTimeDepends: <<
		apache2 (>= 2.4),
		apache2-api-20120211,
		%N-cli,
		%N-common (= %v-%r),
		ucf
	<<
	Recommends: <<
		%N-json
	<<
	Suggests: <<
		php-pear
	<<
	InstallScript: <<
debian/finkdebhelper.sh "%n" "%p" "%i"
	<<
	Description: PHP5 Apache 2 module
	DescDetail: <<
This package provides the PHP5 module for the Apache 2 webserver (as found in
the apache2-mpm-prefork package). Please note that this package ONLY works with
Apache's prefork MPM, as it is not compiled thread-safe.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
	<<
<<
SplitOff82: <<
	Package: %N-cgi
	Provides: <<
		%N-bcmath,
		%N-bz2,
		%N-mbstring,
		%N-soap,
		%N-xml,
		%N-zip
	<<
	Depends: <<
		bzip2-shlibs,
		db53-aes-shlibs,
		libcomerr2,
		libgettext8-shlibs,
		libiconv,
		libonig2-shlibs,
		libpcre1-shlibs,
		libxml2-shlibs (>= 2.9.0),
		openssl100-shlibs,
		qdbm14-shlibs
	<<
	RunTimeDepends: <<
		%N-cli,
		%N-common (= %v-%r),
		ucf
	<<
	Recommends: <<
		%N-json
	<<
	Suggests: <<
		php-pear
	<<
	InstallScript: <<
debian/finkdebhelper.sh "%n" "%p" "%i"
	<<
	Description: PHP5 CGI binary
	DescDetail: <<
This package provides the %p/lib/cgi-bin/%N CGI interpreter built for use in
Apache 2 with mod_actions, or any other CGI httpd that supports a similar
mechanism. Note that MOST Apache users probably want the libapache2-mod-%N
package.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
	<<
<<
SplitOff83: <<
	Package: %N-cli
	Provides: <<
		%N-bcmath,
		%N-bz2,
		%N-mbstring,
		%N-soap,
		%N-xml,
		%N-zip
	<<
	Depends: <<
		bzip2-shlibs,
		db53-aes-shlibs,
		libcomerr2,
		libgettext8-shlibs,
		libiconv,
		libonig2-shlibs,
		libpcre1-shlibs,
		libxml2-shlibs (>= 2.9.0),
		openssl100-shlibs,
		qdbm14-shlibs
	<<
	RunTimeDepends: <<
		%N-common (= %v-%r),
		ucf
	<<
	Recommends: <<
		%N-json,
		%N-readline
	<<
	Suggests: <<
		php-pear
	<<
	InstallScript: <<
debian/finkdebhelper.sh "%n" "%p" "%i"
	<<
	Description: Command-line interpreter for PHP5
	DescDetail: <<
This package provides the %p/bin/%N command interpreter, useful for testing
PHP scripts from a shell or performing general shell scripting tasks.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
	<<
<<
SplitOff84: <<
	Package: %N-phpdbg
	Provides: <<
		%N-bcmath,
		%N-bz2,
		%N-mbstring,
		%N-soap,
		%N-xml,
		%N-zip
	<<
	Depends: <<
		bzip2-shlibs,
		db53-aes-shlibs,
		libcomerr2,
		libgettext8-shlibs,
		libiconv,
		libncurses5-shlibs,
		libonig2-shlibs,
		libpcre1-shlibs,
		libxml2-shlibs (>= 2.9.0),
		openssl100-shlibs,
		qdbm14-shlibs
	<<
	RunTimeDepends: <<
		%N-common (= %v-%r),
		ucf
	<<
	Recommends: <<
		%N-json,
		%N-readline
	<<
	InstallScript: <<
debian/finkdebhelper.sh "%n" "%p" "%i"
	<<
	Description: Command-line interpreter for PHP5 (Debug)
	DescDetail: <<
This package provides the %p/bin/phpdbg command interpreter, useful for
stepthrough debugging of PHP code.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
	<<
<<
SplitOff85: <<
	Package: %N-fpm
	Provides: <<
		%N-bcmath,
		%N-bz2,
		%N-mbstring,
		%N-soap,
		%N-xml,
		%N-zip
	<<
	Depends: <<
		bzip2-shlibs,
		db53-aes-shlibs,
		libcomerr2,
		libgettext8-shlibs,
		libiconv,
		libonig2-shlibs,
		libpcre1-shlibs,
		libxml2-shlibs (>= 2.9.0),
		openssl100-shlibs,
		qdbm14-shlibs
	<<
	RunTimeDepends: <<
		daemonic,
		%N-cli,
		%N-common (= %v-%r),
		ucf
	<<
	Suggests: <<
		%N-json,
		php-pear
	<<
	InstallScript: <<
debian/finkdebhelper.sh "%n" "%p" "%i"
	<<
	DaemonicName: %N-fpm
	DaemonicFile: <<
	<service>
		<description>PHP5 FastCGI Process Manager</description>
		<message>PHP5 FastCGI Process Manager</message>

		<daemon name="%N-fpm">
			<executable background="yes">%p/sbin/%N-fpmctl</executable>
			<parameters> start</parameters>
		</daemon>
	</service>
	<<
	Description: PHP5 FPM-CGI binary
	DescDetail: <<
This package provides the Fast Process Manager interpreter that runs as a
daemon and receives Fast/CGI requests.  Note that MOST Apache users probably
want the libapache2-mod-%N package.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
	<<
<<
### Common should be last so it can mop up
SplitOff100: <<
	Package: %N-common
	Provides: <<
		%N-mhash,
		phpapi-%type_raw[sapiver]
	<<
	RunTimeDepends: <<
		cron-service,
		sed,
		coreutils,
		ucf
	<<
	Suggests: <<
		%N-user-cache
	<<
	Docfiles: CREDITS EXTENSIONS CODING_STANDARDS README.EXT_SKEL README.SELF-CONTAINED-EXTENSIONS debian/README.Debian.security:README.Fink.security UPGRADING UPGRADING.INTERNALS debian/copyright
	InstallScript: <<
debian/finkdebhelper.sh "%n" "%p" "%i"
	<<
	Description: Common files for the PHP5 suite
	DescDetail: <<
This package contains the documentation and example files relevant to all the
other packages built from the %N source.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
	<<
<<
###
DocFiles: debian/changelog
Description: Server-side, HTML-embedded scripting language
DescDetail: <<
This package is a metapackage that, when installed, guarantees that you have at
least one of the four server-side versions of the PHP5 interpreter installed.
Removing this package won't remove PHP5 from your system, however it may remove
other packages that depend on this one.

PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
<<
###
License: GPL
Homepage: http://www.php.net/
Maintainer: Justin F. Hallett <thesin@users.sourceforge.net>
<<
