Package: libxml2
Version: 2.9.0
Revision: 1
Maintainer: The Gnome Core Team <fink-gnome-core@lists.sourceforge.net>
Depends: %N-bin (= %v-%r), %N-shlibs (= %v-%r), pkgconfig (>= 0.23)
BuildDepends: <<
	fink (>= 0.24.12-1),
	fink-package-precedence,
	libiconv-dev,
	liblzma5,
	libncurses5 (>= 5.4-20041023-1006),
	readline6
<<
Source: http://xmlsoft.org/sources/%n-%v.tar.gz
Source-MD5: 5b9bebf4f5d2200ae2c4efe8fa6103f7
PatchFile: %n.patch
PatchFile-MD5: 588539bf5baf6266eae33d9fd30439d7
UseMaxBuildJobs: false
PatchScript: <<
	sed 's|@PREFIX@|%p|g' <%{PatchFile} | patch -p1
	perl -pi -e 's|/etc|%p/etc|g' *.[ch] doc/*.html doc/*.1 doc/*.xml
	rm test/ebcdic_566012.xml
<<
ConfigureParams: --mandir=%p/share/man --with-iconv=%p --without-python --enable-dependency-tracking --with-html-dir=%p/share/doc --with-html-subdir=%n --with-history --disable-silent-rules
CompileScript: <<
	XMLLINT=/usr/bin/true XSLTPROC=/usr/bin/true ./configure %c
	make
	fink-package-precedence --prohibit-bdep=%n .
<<
InfoTest: TestScript: make check || exit 2
InstallScript: <<
	make install DESTDIR=%d DOC_MODULE=%n
	mkdir -p %i/etc/xml/catalog.d
	mkdir -p %i/etc/sgml/catalog.d
	mkdir -p %i/sbin
	install -c -m 755 update-xml-catalog %i/sbin/
	install -c -m 755 update-sgml-catalog %i/sbin/
<<
DocFiles: AUTHORS ChangeLog COPYING Copyright NEWS README TODO TODO_SCHEMAS
BuildDependsOnly: True
SplitOff: <<
	Package: %N-shlibs
	Depends: <<
		libiconv,
		liblzma5-shlibs
	<<
	Replaces: libxml2 (<< 2.4.18-2)
	Suggests: %N-bin
	Files: lib/libxml2.2.dylib
	Shlibs: %p/lib/libxml2.2.dylib 12.0.0 %n (>= 2.9.0-1)
	DocFiles: Copyright README
<<
SplitOff2: <<
	Package: %N-bin
	Depends: <<
		%N-shlibs (>= %v-%r),
		liblzma5-shlibs,
		libncurses5-shlibs (>= 5.4-20041023-1006),
		readline6-shlibs
	<<
	Replaces: libxml2 (<< 2.4.18-2)
	Files: bin/xmlcatalog bin/xmllint sbin share/man/man1/xmlcatalog.1 share/man/man1/xmllint.1 etc/xml
	DocFiles: Copyright README
	RuntimeVars: <<
		SGML_CATALOG_FILES: %p/etc/sgml/catalog
		XML_CATALOG_FILES: %p/etc/xml/catalog
	<<
	PostInstScript: <<
		case "$1" in
			configure)
				export SGML_CATALOG_FILES=%p/etc/sgml/catalog
				export XML_CATALOG_FILES=%p/etc/xml/catalog
				%p/sbin/update-xml-catalog
				%p/sbin/update-sgml-catalog
			;;
		esac
	<<
	PostRmScript: <<
		case "$1" in
			abort-install|purge|remove)
				rm -f %p/etc/xml/catalog
				rm -f %p/etc/sgml/catalog
				;;
		esac
	<<
<<
Description: XML parsing library, version 2
DescDetail: <<
	This set of packages does *not* contain the python bindings. Those
	are in libxml2-pyXX for various pythonX.X versions.
<<
DescPort: <<
	Hide fink xmllint and xsltproc executables from ./configure to
	avoid circular dependencies (on libxml2-bin (built here) and
	libxslt-bin (depends on libxml2))--could use apple-supplied
	xmllint & xsltproc anyway. Fortunately, these executables are
	only used to build docs that already come prebuilt (we patch
	the targets instead of patching sources and rebuilding).

	Fix installation of some missing files. See:
	https://mail.gnome.org/archives/xml/2012-September/msg00062.html

	Changed the installation to avoid examples overriding top level
	of doc.

	Fix build-bug in initializer in threads.c. See:
	https://bugzilla.gnome.org/show_bug.cgi?id=684024
	But may not actually be correct at runtime. See:
	https://mail.gnome.org/archives/xml/2012-September/msg00058.html
<<
DescPackaging: <<
libxml2 uses XML/SGML super catalog to know location of DTDs installed on
local system. They are managed by update-xml-catalog and update-sgml-catalog
script. Each package that provides DTDs should also provide configuration
file(s) for these script and call them within Pre/PostInstScript.

When update-xml-catalog is called, it reads every configuration file belongs
to %p/etc/xml/catalog.d/. Each line of them contain 3 fields, TYPE, ORIG and
REPLACE, correspond to arguments of `xmlcatalog --add'. See xmlcatalog(1) for
detail.

Also, update-sgml-catalog reads every configuration file belongs to %p/etc/
sgml/catalog.d/ when it is called. Each line of them contain only 1 field,
reference to other SGML catalog file.

Previous versions by Christoph Pfisterer <chrisp@users.sourceforge.net>

	disable the self-test of ebcdic handling because GNU
	libiconv doesn't support ebcdic. See:
	https://bugzilla.gnome.org/show_bug.cgi?id=603432
<<
License: BSD
Homepage: http://www.xmlsoft.org/
