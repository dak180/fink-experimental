Info2: <<
Package: php5
Version: 5.5.3
Revision: 1.1
Type: sapiver (20121212), embedver (5)
###
BuildDepends: <<
	fink (>= 0.34.99.git),
	dpkg-dev (>= 1.16.1),
	automake1.11,
	apache2-dev,
	debhelper,
	dh-apache2,
	aspell-dev,
	coreutils,
	cyrus-sasl2-dev,
	db53-aes,
	enchant1-dev,
	expat1,
	file-dev,
	freetds (>= 1:0.91-1),
	freetds-dev,
	freetype219,
	gd3,
	glib2-dev,
	gmp5,
	libapr.0-dev,
	libc-client1-dev,
	libcurl4,
	libevent2,
	libgcrypt,
	libicu48-dev,
	libjpeg9,
	libmcrypt,
	libmhash2,
	libonig2-dev,
	libodbc3-dev,
	libpcre1,
	libpng16,
	libtidy-0.99.0-dev,
	libtool2,
	libxml2 (>= 2.9.0-1),
	libxslt,
	mysql-unified-dev | libmysqlclient18-dev,
	libnetsnmp30-dev,
	netcat,
	openldap24-dev,
	openssl100-dev,
	postgresql91-dev,
	qdbm14,
	re2c,
	recode-dev,
	sed,
	sqlite3-dev,
	wrap
<<
Depends: <<
	libapache2-mod-%N (= %v-%r) | libapache2-mod-%Nfilter (= %v-%r) | %N-cgi (= %v-%r) | %N-fpm (= %v-%r),
	%N-common (= %v-%r)
<<
###
CustomMirror: <<
  eur-AR: http://ar.php.net/
  oce-AU: http://au.php.net/
  oce-AU: http://au2.php.net/
  oce-AU: http://au3.php.net/
  eur-AT: http://at.php.net/
  eur-AT: http://at2.php.net/
  eur-BE: http://be.php.net/
  eur-BE: http://be2.php.net/
  sam-BR: http://br.php.net/
  sam-BR: http://br2.php.net/
  nam-CA: http://ca.php.net/
  nam-CA: http://ca2.php.net/
  nam-CA: http://ca3.php.net/
  asi-CN: http://cn.php.net/
  asi-CN: http://cn2.php.net/
  sam-CR: http://cr2.php.net/
  eur-CZ: http://cz.php.net/
  eur-DK: http://dk.php.net/
  eur-DK: http://dk2.php.net/
  eur-FR: http://fr.php.net/
  eur-FR: http://fr2.php.net/
  eur-FR: http://fr3.php.net/
  eur-DE: http://de.php.net/
  eur-DE: http://de2.php.net/
  eur-DE: http://de3.php.net/
  eur-GR: http://gr.php.net/
  eur-GR: http://gr2.php.net/
  eur-HU: http://hu.php.net/
  eur-HU: http://hu2.php.net/
  asi-ID: http://id.php.net/
  eur-IE: http://ie.php.net/
  asi-JP: http://jp.php.net/
  asi-JP: http://jp2.php.net/
  eur-LV: http://lv.php.net/
  nam-MX: http://mx.php.net/
  eur-PL: http://pl.php.net/
  eur-PL: http://pl2.php.net/
  eur-RU: http://ru.php.net/
  eur-RU: http://ru2.php.net/
  eur-SI: http://si.php.net/
  eur-SI: http://si2.php.net/
  eur-SE: http://se.php.net/
  eur-SE: http://se2.php.net/
  eur-CH: http://ch.php.net/
  eur-CH: http://ch2.php.net/
  asi-TW: http://tw.php.net/
  asi-TW: http://tw2.php.net/
  eur-UA: http://ua.php.net/
  eur-UA: http://ua2.php.net/
  eur-UK: http://uk.php.net/
  eur-UK: http://uk2.php.net/
  nam-US: http://us2.php.net/
  nam-US: http://us3.php.net/  
  nam-US: http://us4.php.net/  
  nam-US: http://www.php.net/  
  eur-YU: http://yu.php.net/
<<
###
Source: mirror:custom:distributions/php-%v.tar.gz
Source-MD5: a5dfdd41ccf539942db966310f7429da
Source2: mirror:debian:/pool/main/p/php5/php5_%v+dfsg-1.debian.tar.gz
Source2-MD5: 6988c4ad9f9ddb37c7f04c91542cbc7b
Source2ExtractDir: php-%v
PatchFile: %n.patch
PatchFile-MD5: 0db6ab20012e4a9542c6cdd521a00bb8
PatchScript: <<
  sed -e 's,@FINKPREFIX@,%p,g' %{PatchFile} | patch -p1

  ### Apply some Debian Patches for Security and Build Issues
  patch -p1 < fink/patches/001-libtool_fixes.patch
  patch -p1 < fink/patches/002-static_openssl.patch
  patch -p1 < fink/patches/004-ldap_fix.patch
### Use fink_quirks.patch instead
#  patch -p1 < fink/patches/006-debian_quirks.patch
  patch -p1 < fink/patches/fink_quirks.patch
  patch -p1 < fink/patches/libtool2.2.patch
  patch -p1 < fink/patches/033-we_WANT_libtool.patch
  patch -p1 < fink/patches/036-fd_setsize_fix.patch
  patch -p1 < fink/patches/043-recode_size_t.patch
  patch -p1 < fink/patches/044-strtod_arm_fix.patch
  patch -p1 < fink/patches/045-exif_nesting_level.patch
  patch -p1 < fink/patches/047-zts_with_dl.patch
  patch -p1 < fink/patches/052-phpinfo_no_configure.patch
  patch -p1 < fink/patches/053-extension_api.patch
  patch -p1 < fink/patches/057-no_apache_installed.patch
  patch -p1 < fink/patches/100-recode_is_shared.patch
  patch -p1 < fink/patches/108-64_bit_datetime.patch
  patch -p1 < fink/patches/112-proc_open.patch
  patch -p1 < fink/patches/113-php.ini_securitynotes.patch
  patch -p1 < fink/patches/116-posixness_fix.patch
  patch -p1 < fink/patches/libdb_is_-ldb
  patch -p1 < fink/patches/fix_broken_upstream_tests.patch
  patch -p1 < fink/patches/use_embedded_timezonedb.patch
  patch -p1 < fink/patches/force_libmysqlclient_r.patch
  patch -p1 < fink/patches/mssql-null-exception.patch
  patch -p1 < fink/patches/sybase-alias.patch
  patch -p1 < fink/patches/strcmp_null-OnUpdateErrorLog.patch
#  patch -p1 < fink/patches/deprecate_short_open_tag
  patch -p1 < fink/patches/fix_broken_5.3_tests.patch
  patch -p1 < fink/patches/dont-gitclean-in-build.patch
#  patch -p1 < fink/patches/broken_5.3_test-posix_uname.patch
  patch -p1 < fink/patches/shtool_mkdir_-p_-race-condition.patch
  patch -p1 < fink/patches/qdbm-is-usr_include_qdbm.patch
  patch -p1 < fink/patches/use_embedded_timezonedb_fixes.patch
  patch -p1 < fink/patches/fix_broken_sha2_test.patch
  patch -p1 < fink/patches/session_save_path.patch
#  patch -p1 < fink/patches/install-programs_parallel_FTBFS.patch
  patch -p1 < fink/patches/php-fpm-man-section-and-cleanup.patch
  patch -p1 < fink/patches/fpm-config.patch
  patch -p1 < fink/patches/php-fpm-sysconfdir.patch
  patch -p1 < fink/patches/lp564920-fix-big-files.patch
  patch -p1 < fink/patches/temporary-path-fixes-for-multiarch.patch
  patch -p1 < fink/patches/gdIOCtx.patch
  patch -p1 < fink/patches/hurd-noptrace.diff
  patch -p1 < fink/patches/php-5.3.9-mysqlnd.patch
  patch -p1 < fink/patches/php-5.3.9-gnusrc.patch
  patch -p1 < fink/patches/php-5.3.3-macropen.patch
  patch -p1 < fink/patches/php-5.2.4-norpath.patch
  patch -p1 < fink/patches/php-fpm-listen-on-unix-socket.patch
  patch -p1 < fink/patches/0001-Add-information-about-which-INI-file-is-which-inside.patch
### Use php-5.2.4-embed-darwin.patch instead
#  patch -p1 < fink/patches/php-5.2.4-embed.patch
  patch -p1 < fink/patches/php-5.2.4-embed-darwin.patch
  patch -p1 < fink/patches/php-5.4.0-dlopen.patch
  patch -p1 < fink/patches/php-fpm-m68k.patch
  patch -p1 < fink/patches/expose_all_built_and_installed_apis.patch
  patch -p1 < fink/patches/Zend_OpCache_GNUHurd_fix.patch

### Fink Specific stuff
  patch -p1 < fink/patches/giconv_is_inferior.patch

  ## Patch debian dir for debhelper stuff
  perl -pi -e 's,.libs,libs,g' debian/*.apache2
  cp fink/*.conf debian/
  cp fink/*.load debian/
  cp fink/*.ini debian/

  ## Patch user out of autoscripts
  perl -pi -e 's,\/usr,%p,g' debian/debhelper/*-php5

  ## No builtin json (dfsg)
  rm -rf ext/json/*
<<
###
ConfigureParams: <<
--prefix=%p \
--sysconfdir=%p/etc \
--localstatedir=%p/var \
--mandir=%p/share/man \
--disable-debug \
--with-regex=php \
--disable-rpath \
--disable-static \
--with-pic \
--with-layout=GNU \
--with-pear=%p/share/php \
--enable-calendar \
--enable-sysvsem \
--enable-sysvshm \
--enable-sysvmsg \
--enable-bcmath \
--with-bz2 \
--enable-ctype \
--with-db4=%p \
--with-qdbm=%p \
--without-gdbm \
--with-iconv=%p \
--enable-exif \
--enable-ftp \
--with-gettext=%p \
--enable-mbstring \
--with-onig=%p \
--with-pcre-regex=%p \
--enable-shmop \
--enable-sockets \
--enable-wddx \
--with-libxml-dir=%p \
--with-zlib \
--with-kerberos=/usr \
--with-openssl=%p \
--enable-soap \
--enable-zip \
--with-mhash=yes \
--with-mysql-sock=%p/var/run/mysqld/mysqld.sock
<<
CompileScript: <<
#!/bin/sh -ex

PROG_SENDMAIL="/usr/sbin/sendmail";

### Set these someday maybe
if [ 0 == 1 ]; then \
  CONFIGURE_APACHE_ARGS='--with-interbase=shared,%p --with-pdo-firebird=shared,%p'; \
else \
  CONFIGURE_APACHE_ARGS='--without-interbase --without-pdo-firebird'; \
fi

if [ `uname -s` == 'Linux' ]; then \
  CONFIGURE_SYSTEMD='--with-fpm-systemd'; \
else \
  CONFIGURE_SYSTEMD='--without-fpm-systemd'; \
fi

prepared() {
	sed -i -e 's/EXTRA_VERSION=""/EXTRA_VERSION="-%r"/' configure.in
	./buildconf --force
}

configure_apache2() {
	if [ -d %b/apache2-build ]; then rm -rf %b/apache2-build; fi
	mkdir %b/apache2-build;
	cd %b/apache2-build && \
	PROG_SENDMAIL=$PROG_SENDMAIL ../configure \
		--with-apxs2=%p/bin/apxs2 \
		--with-config-file-path=%p/etc/php5/apache2 \
		--with-config-file-scan-dir=%p/etc/php5/apache2/conf.d \
		%c \
		--without-mm \
		--with-curl=shared,%p \
		--with-enchant=shared,%p \
		--with-zlib-dir=%p \
		--with-gd=shared,%p --enable-gd-native-ttf \
		--with-gmp=shared,%p \
		--with-jpeg-dir=shared,%p \
		--with-xpm-dir=shared,/usr/X11R6 \
		--with-png-dir=shared,%p \
		--with-freetype-dir=shared,%p/lib/freetype219 \
		--with-vpx-dir=%p \
		--with-imap=shared,%p \
		--with-imap-ssl \
		--enable-intl=shared \
		--without-t1lib \
		--with-ldap=shared,%p \
		--with-ldap-sasl=%p \
		--with-mcrypt=shared,%p \
		--with-mysql=shared,%p \
		--with-mysqli=shared,%p/bin/mysql_config \
		--with-pspell=shared,%p \
		--with-unixODBC=shared,%p \
		--with-recode=shared,%p \
		--with-xsl=shared,%p \
		--with-snmp=shared,%p \
		--with-sqlite3=shared,%p \
		--with-mssql=shared,%p \
		--with-tidy=shared,%p \
		--with-xmlrpc=shared \
		--with-pgsql=shared,%p PGSQL_INCLUDE=`pg_config --includedir` \
		--enable-pdo=shared \
		--without-pdo-dblib \
		--with-pdo-mysql=shared,%p \
		--with-pdo-odbc=shared,unixODBC,%p \
		--with-pdo-pgsql=shared,%p/bin/pg_config \
		--with-pdo-sqlite=shared,%p \
		--with-pdo-dblib=shared,%p \
		$CONFIGURE_APACHE_ARGS;
	cd %b/apache2-build && \
	cp ../Zend/zend_ini_scanner.c ../Zend/zend_language_scanner.c \
	   ../Zend/zend_ini_parser.h ../Zend/zend_language_parser.h \
	   ../Zend/zend_ini_parser.c ../Zend/zend_language_parser.c \
	   Zend/
}

configure_apache2filter() {
	if [ -d %b/apache2filter-build ]; then rm -rf %b/apache2filter-build; fi
	mkdir %b/apache2filter-build;
	cd %b/apache2filter-build && \
	PROG_SENDMAIL=$PROG_SENDMAIL ../configure \
		--with-apxs2filter=%p/bin/apxs2 \
		--with-config-file-path=%p/etc/php5/apache2filter \
		--with-config-file-scan-dir=%p/etc/php5/apache2filter/conf.d \
		%c \
		--without-mm \
		--disable-pdo \
		--without-mysql --without-sybase-ct --without-mssql \
		--without-sqlite3;
	cd %b/apache2filter-build && \
	cp ../Zend/zend_ini_scanner.c ../Zend/zend_language_scanner.c \
	   ../Zend/zend_ini_parser.h ../Zend/zend_language_parser.h \
	   ../Zend/zend_ini_parser.c ../Zend/zend_language_parser.c \
	   Zend/
}

configure_cgi() {
	if [ -d %b/cgi-build ]; then rm -rf %b/cgi-build; fi
	mkdir %b/cgi-build;
	cd %b/cgi-build && \
	PROG_SENDMAIL=$PROG_SENDMAIL ../configure \
		--enable-force-cgi-redirect \
		--enable-fastcgi \
		--with-config-file-path=%p/etc/php5/cgi \
		--with-config-file-scan-dir=%p/etc/php5/cgi/conf.d \
		%c \
		--without-mm \
		--enable-pdo=shared \
		--enable-mysqlnd=shared \
		--with-mysql=shared,mysqlnd \
		--with-mysqli=shared,mysqlnd \
		--with-pdo-mysql=shared,mysqlnd \
		--without-pdo-sqlite \
		--without-sybase-ct --without-mssql \
		--without-sqlite3 \
		--enable-pcntl;
	cd %b/cgi-build && \
	cp ../Zend/zend_ini_scanner.c ../Zend/zend_language_scanner.c \
	   ../Zend/zend_ini_parser.h ../Zend/zend_language_parser.h \
	   ../Zend/zend_ini_parser.c ../Zend/zend_language_parser.c \
	   Zend/
}

configure_cli() {
	if [ -d %b/cli-build ]; then rm -rf %b/cli-build; fi
	mkdir %b/cli-build;
	cd %b/cli-build && \
	PROG_SENDMAIL=$PROG_SENDMAIL ../configure \
		--disable-cgi \
		--with-config-file-path=%p/etc/php5/cli \
		--with-config-file-scan-dir=%p/etc/php5/cli/conf.d \
		%c \
		--without-mm \
		--disable-pdo \
		--without-mysql --without-sybase-ct \
		--without-mssql --without-sqlite3 --enable-pcntl \
		--with-libedit=shared,%p;
	cd %b/cli-build && \
	cp ../Zend/zend_ini_scanner.c ../Zend/zend_language_scanner.c \
	   ../Zend/zend_ini_parser.h ../Zend/zend_language_parser.h \
	   ../Zend/zend_ini_parser.c ../Zend/zend_language_parser.c \
	   Zend/
}

configure_embed() {
	if [ -d %b/embed-build ]; then rm -rf %b/embed-build; fi
	mkdir %b/embed-build;
	cd %b/embed-build && \
	PROG_SENDMAIL=$PROG_SENDMAIL ../configure \
		--enable-embed=shared --disable-cgi --disable-cli \
		--with-config-file-path=%p/etc/php5/embed \
		--with-config-file-scan-dir=%p/etc/php5/embed/conf.d \
		%c \
		--without-mm \
		--disable-pdo \
		--without-mysql --without-sybase-ct \
		--without-mssql --without-sqlite3 --enable-pcntl;
	cd %b/embed-build && \
	cp ../Zend/zend_ini_scanner.c ../Zend/zend_language_scanner.c \
	   ../Zend/zend_ini_parser.h ../Zend/zend_language_parser.h \
	   ../Zend/zend_ini_parser.c ../Zend/zend_language_parser.c \
	   Zend/
}

configure_fpm() {
	if [ -d %b/fpm-build ]; then rm -rf %b/fpm-build; fi
	mkdir %b/fpm-build;
	cd %b/fpm-build && \
	PROG_SENDMAIL=$PROG_SENDMAIL ../configure \
		--enable-fpm --disable-cgi \
		--with-fpm-user=www --with-fpm-group=www \
		--with-config-file-path=%p/etc/php5/fpm \
		--with-config-file-scan-dir=%p/etc/php5/fpm/conf.d \
		%c \
		--with-libevent-dir=%p \
		--without-mm \
		--disable-pdo \
		--without-mysql --without-sybase-ct \
		--without-mssql --without-sqlite3 \
		$CONFIGURE_SYSTEMD;
	cd %b/fpm-build && \
	cp ../Zend/zend_ini_scanner.c ../Zend/zend_language_scanner.c \
	   ../Zend/zend_ini_parser.h ../Zend/zend_language_parser.h \
	   ../Zend/zend_ini_parser.c ../Zend/zend_language_parser.c \
	   Zend/
}

build_apache2() {
	cd %b/apache2-build && make;
}

build_apache2filter() {
	cd %b/apache2filter-build && make;

	# Mangle apache2filter DSO name before running dh_apache2
	mv %b/apache2filter-build/libs/libphp5.so %b/apache2filter-build/libs/libphp5filter.so
}

build_cgi() {
	cd %b/cgi-build && make && mv sapi/cgi/php-cgi sapi/cgi/cgi-bin.php5;

	# Dirty hack to not rebuild everything twice
	cd %b/cgi-build/main && \
		sed -i -e 's/FORCE_CGI_REDIRECT 1/FORCE_CGI_REDIRECT 0/' \
		       -e 's/DISCARD_PATH 0/DISCARD_PATH 1/' php_config.h && \
		sed -i -e 's/--enable-force-cgi-redirect/--enable-discard-path/' build-defs.h && \
		touch ../../ext/standard/info.c && \
		touch ../../sapi/cgi/cgi_main.c;

	cd %b/cgi-build && make && mv sapi/cgi/php-cgi sapi/cgi/usr.bin.php5-cgi;
}

build_cli() {
	cd %b/cli-build && make;
}

build_embed() {
	cd %b/embed-build && make;
}

build_fpm() {
	cd %b/fpm-build && make;
}

build_pear() {
	mkdir %b/pear-build;
	mkdir %b/pear-build-download;
	cd %b/cgi-build && PHP_PEAR_DOWNLOAD_DIR=%b/pear-build-download make install-pear PHP_PEAR_PHP_BIN=%p/bin/php PHP_PEAR_INSTALL_DIR=%p/share/php PHP_PEAR_SYSCONF_DIR=%p/etc/pear PHP_PEAR_SIG_BIN=%p/bin/gpg2 INSTALL_ROOT=%b/pear-build;
	sed -i -e 's/-d output_buffering=1 -d open_basedir="" -d safe_mode=0/-d output_buffering=1 -d open_basedir="" -d safe_mode=0 -d memory_limit="-1"/' \
	       %b/pear-build%p/bin/pear && \
	sed -i -e 's/-d output_buffering=1 -d safe_mode=0/-d output_buffering=1 -d open_basedir="" -d safe_mode=0 -d memory_limit="-1"/' \
	       %b/pear-build%p/bin/pecl && \
	sed -i -e 's/-d memory_limit="-1"//' \
	       -e 's/-d output_buffering=1 -d open_basedir="" -d safe_mode=0/-d output_buffering=1 -d open_basedir="" -d safe_mode=0 -d memory_limit="-1"/' \
	       %b/pear-build%p/bin/peardev
	sed -i -re "s#('PEAR_CONFIG_SYSCONFDIR', PHP_SYSCONFDIR)#\1 . '/pear'#" %b/pear-build%p/share/php/PEAR/Config.php
	patch -s -d %b/pear-build%p/share/php/ -p1 -i %b/fink/patches/PEAR-Builder-print-info-about-php5-dev.patch
}

create_test_results() {
	echo 'fink was not run with tests enabled' | tee %b/test-results.txt
}

prepared;

configure_apache2;
configure_apache2filter;
configure_cgi;
configure_cli;
configure_embed;
configure_fpm;

build_apache2;
build_apache2filter;
build_cgi;
build_cli;
build_embed;
build_fpm;
build_pear;

create_test_results;
<<
###
InfoTest: <<
	TestDepends: mysql-unified | virtual-mysql-server-core
	TestScript: <<
#!/bin/sh -ex

MYSQL_PORT=`for i in $(seq 1025 3600 | sort); do nc -z localhost ${i} || { echo ${i}; exit; } ; done`;
MYSQL_DATA_DIR=`greadlink -f mysql_db`;
if [ ${MYSQL_PORT} == '' ]; then
	echo "Could not find available port for mysql server";
	exit 1;
fi
MYSQL_SOCKET=${MYSQL_DATA_DIR}/mysql.sock;

TESTFILE=test-results.txt

if [ -f ${TESTFILE} ]; then \
	rm ${TESTFILE}; \
fi

mkdir -p temp_session_store;
# start our own mysql server for the tests
sh -x fink/setup-mysql.sh ${MYSQL_PORT} ${MYSQL_DATA_DIR};
extensions=""; \
for f in apache2-build/modules/*.so; do \
    ext=`basename "${f}"`; \
    test -d "ext/${ext%%%%.so}/tests" || continue; \
    test "${ext}" != "imap.so" || continue; \
    test "${ext}" != "interbase.so" || continue; \
    test "${ext}" != "ldap.so" || continue; \
    test "${ext}" != "odbc.so" || continue; \
    test "${ext}" != "pgsql.so" || continue; \
    test "${ext}" != "pdo_dblib.so" || continue; \
    test "${ext}" != "pdo_firebird.so" || continue; \
    test "${ext}" != "pdo_odbc.so" || continue; \
    test "${ext}" != "pdo_pgsql.so" || continue; \
    test "${ext}" != "snmp.so" || continue; \
    test "${ext}" != "opcache.so" || continue; \
    extensions="${extensions} -d extension=${ext}"; \
done; \
[ "${extensions}" ] || { echo "extensions list is empty"; exit 1; }; \
env MYSQL_TEST_HOST=127.0.0.1 MYSQL_TEST_PORT=${MYSQL_PORT} MYSQL_TEST_SOCKET=${MYSQL_SOCKET} PDO_MYSQL_TEST_HOST=127.0.0.1 PDO_MYSQL_TEST_PORT=${MYSQL_PORT} PDO_MYSQL_TEST_SOCKET=${MYSQL_SOCKET} NO_INTERACTION=1 TEST_PHP_CGI_EXECUTABLE=cgi-build/sapi/cgi/cgi-bin.php5 TEST_PHP_EXECUTABLE=cli-build/sapi/cli/php \
cli-build/sapi/cli/php run-tests.php -n -d mysql.default_host=127.0.0.1 -d mysql.default_socket=${MYSQL_SOCKET} -d mysqli.default_socket=${MYSQL_SOCKET} -d extension_dir=apache2-build/modules/ ${extensions} | tee ${TESTFILE}
rm -rf temp_session_store
for test in `find . -name '*.log' -a '!' -name 'config.log' -a '!' -name 'bootstrap.log' -a '!' -name 'run.log'`; do \
    /bin/echo; \
    /bin/echo -n "${test#./}:"; \
    cat ${test}; \
    echo; \
done | tee -a ${TESTFILE}
sh -x fink/setup-mysql.sh ${MYSQL_PORT} ${MYSQL_DATA_DIR} stop
	<<
<<
###
InstallScript: <<
# install apache2 DSO module
dh_apache2 --conditional=php5_enable

install -d -m755 debian/php5-common%p/share/php5

# sanitize php.ini file
PCNTL_FUNCTIONS=$(cat ext/pcntl/php_pcntl.h | sed -ne "/^PHP_FUNCTION/ s/PHP_FUNCTION(\(.*\));/\1/;t end;d;:end p" | tr '\n' ','); \
cat php.ini-production | tr "\t" " " | sed -e "/session.gc_probability =/ s/1/0/g;/disable_functions =/ s/$/ ${PCNTL_FUNCTIONS}/g;" > debian/php5-common%p/share/php5/php.ini-production; \
cat php.ini-production | tr "\t" " " | sed -e '/memory_limit =/ s/128M/-1/g;/session.gc_probability =/ s/1/0/g' > debian/php5-common%p/share/php5/php.ini-production.cli; \
cat php.ini-development | tr "\t" " " | sed -e "/session.gc_probability =/ s/1/0/g;/disable_functions =/ s/$/ ${PCNTL_FUNCTIONS}/g;" > debian/php5-common%p/share/php5/php.ini-development

# Install helper shell fragment
install -m644 fink/php5-helper debian/php5-common%p/share/php5/
install -m644 fink/debhelper/php5-maintscript-helper debian/php5-common%p/share/php5/

# install embed SAPI
install -d -m755 debian/libphp5-embed%type_raw[embedver]
cd embed-build && make install-headers install-build install-sapi install-programs INSTALL_ROOT=%b/debian/libphp5-embed%type_raw[embedver]

# install the apache modules' files
install -d -m755 debian/libapache2-mod-php5
cd apache2-build && make install-headers install-build install-modules install-programs INSTALL_ROOT=%b/debian/libapache2-mod-php5

# install the headers from cgi-build
install -d -m755 debian/php5-dev
cd cgi-build && make install-headers INSTALL_ROOT=%b/debian/php5-dev

# remove netware and win32 headers that we don't want
cd debian/libapache2-mod-php5%p/include/php5/ && \
	rm -f TSRM/readdir.h \
	      TSRM/tsrm_config.nw.h TSRM/tsrm_config.w32.h \
	      TSRM/tsrm_nw.h TSRM/tsrm_win32.h \
	      Zend/zend_config.nw.h Zend/zend_config.w32.h \
	      main/config.nw.h main/config.w32.h \
	      main/win95nt.h

# install PEAR
install -d -m755 debian/php-pear
cp -a pear-build/* debian/php-pear/

# everything under %p/share/php/data except 'PEAR' is b0rken
# and actually needs to be fixed
[ ! -f debian/php-pear%p/share/php/data/Structures_Graph/LICENSE ] || \
	rm -f debian/php-pear%p/share/php/data/Structures_Graph/LICENSE
[ ! -f debian/php-pear%p/share/php/doc/PEAR/INSTALL ] || \
	rm -f debian/php-pear%p/share/php/doc/PEAR/INSTALL
[ ! -f debian/php-pear%p/share/php/doc/Structures_Graph/docs/generate.sh ] || \
	rm -f debian/php-pear%p/share/php/doc/Structures_Graph/docs/generate.sh
for f in Structures_Graph/publish.sh Structures_Graph/package.sh \
	Structures_Graph/genpackage.xml.pl; do \
	rm -f debian/php-pear%p/share/php/data/$f; \
done

# we don't want test suites
rm -rf debian/php-pear%p/share/php/test/
[ -d debian/php-pear%p/share/php/doc ] && { \
	install -d -m755 debian/php-pear%p/share/doc/php5-common/PEAR; \
	mv debian/php-pear%p/share/php/doc/* \
		debian/php-pear%p/share/doc/php5-common/PEAR/; \
	rm -rf debian/php-pear%p/share/php/doc; \
	ln -s ../doc/php-pear/PEAR debian/php-pear%p/share/php/doc; \
	echo "Dummy placeholder to prevent the directory's deletion" > \
		debian/php-pear%p/share/doc/php5-common/PEAR/.placeholder; \
}

# install extensions
ext=`debian/libapache2-mod-php5%p/bin/php-config --extension-dir`;\
for i in libapache2-mod-php5 libapache2-mod-php5filter php5-cgi php5-cli libphp5-embed%type_raw[embedver] php5-fpm; do \
	install -d -m755 debian/$i/${ext}; \
done; \
cat fink/modulelist fink/extramodulelist | while read package extname dsoname priority; do \
	if [ "$package" = "mysqlnd" ]; then \
		modulepath=cgi-build/modules; \
	elif [ "$package" = "readline" ]; then \
		modulepath=cli-build/modules; \
	else \
		modulepath=debian/libapache2-mod-php5/${ext}; \
	fi; \
	if [ -z "$dsoname" ]; then dsoname=$package; fi; \
	install -d -m755 debian/php5-$package${ext}; \
	install -m 644 \
		${modulepath}/$dsoname.so \
		debian/php5-$package${ext}/$dsoname.so; \
	rm -f ${modulepath}/$dsoname.so; \
done

# install CGI
install -d -m755 debian/php5-cgi%p/lib/cgi-bin
cp cgi-build/sapi/cgi/cgi-bin.php5 debian/php5-cgi%p/lib/cgi-bin/php5
install -d -m755 debian/php5-cgi%p/bin
cp cgi-build/sapi/cgi/usr.bin.php5-cgi debian/php5-cgi%p/bin/php5-cgi
install -d -m755 debian/php5-cgi%p/share/man/man1
cp cli-build/sapi/cli/php.1 debian/php5-cgi%p/share/man/man1/php5-cgi.1

# install CLI
install -d -m755 debian/php5-cli%p/bin
cp cli-build/sapi/cli/php debian/php5-cli%p/bin/php5
install -d -m755 debian/php5-cli%p/share/man/man1
cp cli-build/sapi/cli/php.1 debian/php5-cli%p/share/man/man1/php5.1

# install FPM
install -d -m755 debian/php5-fpm%p/sbin debian/php5-fpm%p/share/man/man8/ debian/php5-fpm%p/etc/php5/fpm/pool.d
        cp fpm-build/sapi/fpm/php-fpm debian/php5-fpm%p/sbin/php5-fpm
        cp fpm-build/sapi/fpm/php-fpm.8 debian/php5-fpm%p/share/man/man8/php5-fpm.8
        # we don't want the pool definitions on the main file itself:
        sed -r '/('"'"'|\[)www('"'"'|\])/Q' < fpm-build/sapi/fpm/php-fpm.conf > \
            debian/php5-fpm%p/etc/php5/fpm/php-fpm.conf
        # extract the first pool, called "www," from the config file:
        sed -nr '/('"'"'|\[)www('"'"'|\])/{h;p;d};x;/www/{x;p}' < fpm-build/sapi/fpm/php-fpm.conf \
            > debian/php5-fpm%p/etc/php5/fpm/pool.d/www.conf

# install a helper script for checking PHP FPM configuration
install -m 755 fink/php5-fpm-checkconf debian/php5-fpm%p/lib/php5/

# move and install -dev files
cp -a debian/libphp5-embed%type_raw[embedver]/* debian/php5-dev/
cp -a debian/libapache2-mod-php5/* debian/php5-dev/
rm -rf debian/libphp5-embed%type_raw[embedver]%p/include/ \
	debian/libphp5-embed%type_raw[embedver]%p/bin/ \
	debian/libphp5-embed%type_raw[embedver]%p/lib/php5/build/ \
	debian/libphp5-embed%type_raw[embedver]%p/lib/php5/%type_raw[sapiver] \
	debian/libphp5-embed%type_raw[embedver]%p/lib/libphp5.dylib \
	debian/libphp5-embed%type_raw[embedver]%p/share/man/
rm -rf debian/libapache2-mod-php5%p/lib/php5/build/ \
	debian/libapache2-mod-php5%p/include/ \
	debian/libapache2-mod-php5%p/bin/ \
	debian/libapache2-mod-php5%p/share/ \
	debian/libapache2-mod-php5%p/lib/php5/
rm -rf debian/libapache2-mod-php5filter%p/lib/php5/build/ \
	debian/libapache2-mod-php5filter%p/include/ \
	debian/libapache2-mod-php5filter%p/bin/ \
	debian/libapache2-mod-php5filter%p/lib/php5/
rm -rf debian/php5-dev%p/lib/libphp5.*.dylib
install -d -m755 debian/php5-dev%p/lib/php5/build
for i in Makefile.global acinclude.m4 mkdep.awk phpize.m4 scan_makefile_in.awk; do \
	chmod 644 debian/php5-dev%p/lib/php5/build/$i; \
done
install -d -m755 debian/php5-dev%p/share/php5
cp -a ext/skeleton ext/ext_skel debian/php5-dev%p/share/php5
sed -i 's/skel_dir="skeleton"/skel_dir="\%p\/share\/php5\/skeleton"/' \
	debian/php5-dev%p/share/php5/ext_skel

# shipping duplicate files from other packages is hell for security audits
ln -sf %p/share/libtool/config/config.guess debian/php5-dev%p/lib/php5/build/config.guess
ln -sf %p/share/libtool/config/config.sub debian/php5-dev%p/lib/php5/build/config.sub
ln -sf %p/share/aclocal/libtool.m4 debian/php5-dev%p/lib/php5/build/libtool.m4
ln -sf %p/share/libtool/config/ltmain.sh debian/php5-dev%p/lib/php5/build/ltmain.sh
### fink doesn't have a shtool oddly
#ln -sf /usr/bin/shtool debian/php5-dev%p/lib/php5/build/shtool
install -m755 build/shtool debian/php5-dev%p/lib/php5/build/

# make php-dev stuff versioned
for i in php-config phpize; do \
	mv debian/php5-dev%p/bin/${i} debian/php5-dev%p/bin/${i}5; \
	mv debian/php5-dev%p/share/man/man1/${i}.1 debian/php5-dev%p/share/man/man1/${i}5.1; \
done

# remove windows devel file
rm -f debian/php5-dev%p/share/php5/skeleton/skeleton.dsp

install -d -m755 debian/php5-dev%p/bin
install -m755 fink/debhelper/dh_* debian/php5-dev%p/bin
install -d -m755 debian/php5-dev%p/share/debhelper/autoscripts/
install -m644 debian/debhelper/*-php5 debian/php5-dev%p/share/debhelper/autoscripts/
install -d -m755 debian/php5-dev%p/lib/perl5/Debian/Debhelper/Sequence
install -m644 fink/debhelper/php5.pm debian/php5-dev%p/lib/perl5/Debian/Debhelper/Sequence

# install common files
install -d -m755 debian/php5-common%p/lib/php5
install -m755 fink/maxlifetime debian/php5-common%p/lib/php5
install -m755 fink/sessionclean debian/php5-common%p/lib/php5
install -d -m755 debian/php5-common%p/sbin
install -m755 fink/php5enmod debian/php5-common%p/sbin/php5enmod
ln -s php5enmod debian/php5-common%p/sbin/php5dismod
install -m755 fink/php5query debian/php5-common%p/sbin/php5query

# remove libtool files
rm -f debian/libphp5-embed%type_raw[embedver]%p/lib/libphp5.la
rm -rf debian/libphp5-embed%type_raw[embedver]%p/lib/php5

# directories cleanup:
rm -rf debian/php-pear%p/share/lintian
rm -rf debian/php5-dev%p/include/php5/include
rm -rf debian/php5-dev%p/lib/apache2
rm -rf debian/php5-dev%p/etc/apache2
rm -rf debian/php5-dev%p/lib/php5/%type_raw[sapiver]
rm -rf debian/php5-fpm%p/lib/php5/%type_raw[sapiver]
rm -rf debian/php5-cli%p/lib
rm -rf debian/php5-cgi%p/lib/php5
# find debian/php-pear -type d -exec grmdir --ignore-fail-on-non-empty -p '{}' \; >/dev/null 2>&1
for i in $(find debian/php-pear -type d); do \
	grmdir --ignore-fail-on-non-empty -p $i >/dev/null 2>&1; \
done

# binary-indep
for package in php5 php-pear; do \
	rm -rf debian/$package%p/share/doc/$package; \
	install -d -m755 debian/$package%p/share/doc; \
	ln -s php5-common debian/$package%p/share/doc/$package; \
done

# binary-arch
# generate the config snippets for various php
# modules from the templates.
cat fink/modulelist fink/extramodulelist | while read package extname dsoname priority extension; do \
	if [ -z "${dsoname}" ]; then dsoname=$package; fi; \
	if [ -z "${priority}" ]; then priority=20; fi; \
	if [ -z "${extension}" ]; then extension=extension; fi; \
	install -d -m755 debian/php5-${package}%p/share/php5/${package}; \
	sed -e "s|@extname@|${extname}|g; \
		s/@dsoname@/${dsoname}/g; \
		s/@extension@/${extension}/g; \
		s/@priority@/${priority}/g" \
	< fink/php5-module.ini \
	> debian/php5-${package}%p/share/php5/${package}/${dsoname}.ini; \
	/bin/echo -n "${dsoname} " >> fink/php5-${package}.modules; \
done

# generate the maintscripts for various php
# modules from the templates.
cat fink/modulelist | while read package extname dsoname priority; do \
	install -d -m755 debian/php5-${package}/DEBIAN; \
	modules=$(cat fink/php5-${package}.modules); \
	for script in postinst preinst postrm prerm; do \
		sed -e "s/@package@/${package}/g; \
			s/@modules@/${modules}/g; \
			/#EXTRA#/ r fink/php5-${package}.${script}.extra" \
		< fink/php5-module.${script} \
		| sed -e '/#EXTRA#/ d' \
		> debian/php5-${package}/DEBIAN/${script}; \
		chmod 775 debian/php5-${package}/DEBIAN/${script}; \
	done; \
	rm fink/php5-${package}.modules; \
done

# likewise, for the different sapi implementations
for tmpl in postrm prerm postinst; do \
	for sapi in cgi cli fpm; do \
		install -d -m755 debian/php5-${sapi}/DEBIAN; \
		sed -e "s/@sapi@/${sapi}/g; \
			s/@package@/php5-${sapi}/g; \
			/#EXTRA#/ r fink/php5-${sapi}.${tmpl}.extra" \
		< fink/php5-sapi.${tmpl} \
		| sed -e '/#EXTRA#/ d' \
		> debian/php5-${sapi}/DEBIAN/${tmpl}; \
		chmod 775 debian/php5-${sapi}/DEBIAN/${tmpl}; \
		install -d -m755 debian/php5-${sapi}%p/share/php5/sapi; \
		touch debian/php5-${sapi}%p/share/php5/sapi/${sapi}; \
	done; \
	for sapi in embed; do \
		install -d -m755 debian/libphp5-${sapi}%type_raw[embedver]/DEBIAN; \
		sed -e "s/@sapi@/${sapi}/g; \
			s/@package@/libphp5-${sapi}%type_raw[embedver]/g; \
			/#EXTRA#/ r fink/libphp5-${sapi}.${tmpl}.extra" \
		< fink/php5-sapi.${tmpl} \
		| sed -e '/#EXTRA#/ d' \
		> debian/libphp5-${sapi}%type_raw[embedver]/DEBIAN/${tmpl}; \
		chmod 775 debian/libphp5-${sapi}%type_raw[embedver]/DEBIAN/${tmpl}; \
		install -d -m755  debian/libphp5-${sapi}%type_raw[embedver]%p/share/php5/sapi; \
		touch debian/libphp5-${sapi}%type_raw[embedver]%p/share/php5/sapi/${sapi}; \
	done; \
	for sapi in "" "filter"; do \
		install -d -m755 debian/libapache2-mod-php5${sapi}/DEBIAN; \
		sed -e "s/@sapi@/apache2${sapi}/g; \
			s/@package@/libapache2-mod-php5${sapi}/g; \
			/#EXTRA#/ r fink/libapache2-mod-php5${sapi}.${tmpl}.extra" \
		< fink/php5-sapi.${tmpl} \
		| sed -e '/#EXTRA#/ d' \
		> debian/libapache2-mod-php5${sapi}/DEBIAN/${tmpl}; \
		chmod 775 debian/libapache2-mod-php5${sapi}/DEBIAN/${tmpl}; \
		install -d -m755  debian/libapache2-mod-php5${sapi}%p/share/php5/sapi; \
		touch debian/libapache2-mod-php5${sapi}%p/share/php5/sapi/apache2${sapi}; \
	done; \
done

cat fink/modulelist | grep -v common | while read package extname dsoname priority; do \
	rm -rf debian/php5-$package%p/share/doc/php5-$package; \
	install -d -m755 debian/php5-$package%p/share/doc; \
	ln -s php5-common debian/php5-$package%p/share/doc/php5-$package; \
done

for package in php5-dbg php5-dev php5-cgi php5-cli php5-fpm libapache2-mod-php5 libapache2-mod-php5filter libphp5-embed%type_raw[embedver]; do \
	rm -rf debian/$package%p/share/doc/$package; \
	install -d -m755 debian/$package%p/share/doc; \
	ln -s php5-common debian/$package%p/share/doc/$package; \
done

# Install Scripts
install -d -m755 debian/php5-fpm%p/etc/logrotate.d
install -m644 fink/php5-fpm.logrotate debian/php5-fpm%p/etc/logrotate.d/php5-fpm
install -d -m755 debian/php5-common%p/etc/cron.d
install -m644 fink/php5-common.php5.cron.d debian/php5-common%p/etc/cron.d/php5
install -d -m755 debian/php5-fpm%p/sbin
install -m755 fink/php5-fpm.init debian/php5-fpm%p/sbin/php5-fpmctl

### Make dirs exist
#libapache2-mod-php5.dirs
install -d -m755 debian/libapache2-mod-php5%p/etc/apache2/mods-available
install -d -m755 debian/libapache2-mod-php5%p/etc/php5/apache2
install -d -m755 debian/libapache2-mod-php5%p/etc/php5/apache2/conf.d
install -d -m755 debian/libapache2-mod-php5%p/lib/apache2/modules

#libapache2-mod-php5filter.dirs
install -d -m755 debian/libapache2-mod-php5filter%p/etc/apache2/mods-available
install -d -m755 debian/libapache2-mod-php5filter%p/etc/php5/apache2filter
install -d -m755 debian/libapache2-mod-php5filter%p/etc/php5/apache2filter/conf.d
install -d -m755 debian/libapache2-mod-php5filter%p/lib/apache2/modules

#libphp5-embed.dirs
install -d -m755 debian/libphp5-embed%type_raw[embedver]%p/etc/php5/embed
install -d -m755 debian/libphp5-embed%type_raw[embedver]%p/etc/php5/embed/conf.d
install -d -m755 debian/libphp5-embed%type_raw[embedver]%p/lib

#php5-cgi.dirs
install -d -m755 debian/php5-cgi%p/etc/apache2/conf-available
install -d -m755 debian/php5-cgi%p/etc/php5/cgi
install -d -m755 debian/php5-cgi%p/etc/php5/cgi/conf.d
install -d -m755 debian/php5-cgi%p/lib/cgi-bin
install -d -m755 debian/php5-cgi%p/bin
install -d -m755 debian/php5-cgi%p/share/man/man1

#php5-cli.dirs
install -d -m755 debian/php5-cli%p/etc/php5/cli
install -d -m755 debian/php5-cli%p/etc/php5/cli/conf.d
install -d -m755 debian/php5-cli%p/bin
install -d -m755 debian/php5-cli%p/share/man/man1

#php5-common.dirs
install -d -m755 debian/php5-common%p/lib/php5
install -d -m755 debian/php5-common%p/share/doc/php5-common
install -d -m755 debian/php5-common%p/share/php5
install -d -m755 debian/php5-common%p/share/php5/sapi
install -d -m755 debian/php5-common%p/var/lib/php5/modules
install -d -m755 debian/php5-common%p/lib/php5
install -d -m755 debian/php5-common%p/etc/php5/mods-available
install -d -m755 debian/php5-common%p/sbin

#php5-dev.dirs
install -d -m755 debian/php5-dev%p/bin

#php5-fpm.dirs
install -d -m755 debian/php5-fpm%p/etc/php5/fpm
install -d -m755 debian/php5-fpm%p/etc/php5/fpm/conf.d
install -d -m755 debian/php5-fpm%p/etc/php5/fpm/pool.d
install -d -m755 debian/php5-fpm%p/sbin
install -d -m755 debian/php5-fpm%p/lib/php5

#php-pear.dirs
install -d -m755 debian/php-pear%p/share/doc/php-pear/PEAR
install -d -m755 debian/php-pear%p/share/lintian/overrides
<<
###
SplitOff: <<
  Package: %N-dev
  Provides: dh-php5
  BuildDependsOnly: true
  Depends: <<
	libtool2,
	%N-common (= %v-%r),
	lib%N-embed%type_raw[embedver] (= %v-%r)
  <<
  Recommends: pkg-php-tools
  DescUsage: <<
To use phpize you will need libtool2, since it is a BOD package you need to
add that BuildDepends in all php5-modules that use phpize to build.
  <<
  InstallScript: <<
cp -a debian/%n%p/* %i/
  <<
  PostInstScript: <<
set -e

if [ "$1" = "configure" ]; then
    for i in php-config phpize; do
	update-alternatives \
	    --install %p/bin/"$i" $i %p/bin/"$i"5 50 \
	    --slave %p/share/man/man1/"$i".1 "$i".1 %p/share/man/man1/"$i"5.1
    done
fi

### Make sure perms are right
for i in Makefile.global acinclude.m4 mkdep.awk phpize.m4 scan_makefile_in.awk; do \
  chmod 644 %p/lib/php5/build/$i; \
done

exit 0
  <<
  PreRmScript: <<
set -e

if [ "$1" = "remove" -o "$1" = "purge" ]; then
    for i in php-config phpize; do
	update-alternatives --remove $i %p/bin/"$i"5
    done
fi

exit 0
  <<
  Description: Files for PHP5 module development
  DescDetail: <<
This package provides the files from the PHP5 source needed for compiling
additional modules.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
  <<
<<
SplitOff2: <<
  Package: lib%N-embed%type_raw[embedver]
  Provides: phpapi-%type_raw[sapiver]
  Replaces: lib%N-embed, lib%N-embed4
  Conflicts: lib%N-embed, lib%N-embed4
  Depends: <<
	ucf,
	%N-common (= %v-%r),
	bzip2-shlibs,
	db53-aes-shlibs,
	libgettext8-shlibs,
	libiconv,
	libonig2-shlibs,
	libpcre1-shlibs,
	libxml2-shlibs (>= 2.9.1-1),
	openssl100-shlibs,
	qdbm14-shlibs
  <<
  InstallScript: <<
cp -a debian/%n%p/* %i/
cp -a debian/%n/DEBIAN/* %i/../DEBIAN/
  <<
  Shlibs: <<
    %p/lib/libphp5.5.dylib 6.0.0 libphp5-embed%type_raw[embedver] (>= 5.5.1-1)
  <<
  Description: HTML-embedded scripting language (Embedded SAPI library)
  DescDetail: <<
This package provides the libphp5 dylib which can be used by
application developers to embed%type_raw[embedver] PHP scripting functionality.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
  <<
<<
SplitOff3: <<
  Package: php-pear
  Depends: <<
	%N-common (= %v-%r),
	%N-cli (= %v-%r)
  <<
  Conflicts: php-xml-util
  Provides: php-xml-util
  InstallScript: <<
cp -a debian/%n%p/* %i/
  <<
  ConfFiles: %p/etc/pear/pear.conf
  Description: PEAR - PHP Extension and Application Repository
  DescDetail: <<
This package contains the base PEAR classes for PHP, as well as the PEAR
installer. Many PEAR classes are already packaged for Debian, and can be easily
identified by names beginning with "php-", such as php-db and php-auth.
Note: to build and install precompiled PECL extensions, you will need one of
the php development packages installed.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
  <<
<<
### Start of Standard Modules 20+
SplitOff20: <<
  Package: %N-curl
  Depends: <<
	dpkg (>= 1.15),
	ucf,
	phpapi-%type_raw[sapiver],
	%N-common (= %v-%r),
	libcurl4-shlibs
  <<
  InstallScript: <<
cp -a debian/%n%p/* %i/
cp -a debian/%n/DEBIAN/* %i/../DEBIAN/
  <<
  Triggers: <<
    Activate: <<
      %p/etc/php5/apache2/conf.d
      %p/etc/php5/apache2filter/conf.d
      %p/etc/php5/fpm/conf.d
    <<
  <<
  Description: CURL module for php5
  DescDetail: <<
CURL is a library for getting files from  FTP, GOPHER, HTTP server.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
  <<
<<
SplitOff21: <<
  Package: %N-enchant
  Depends: <<
	dpkg (>= 1.15),
	ucf,
	phpapi-%type_raw[sapiver],
	%N-common (= %v-%r),
	enchant1-shlibs
  <<
  InstallScript: <<
cp -a debian/%n%p/* %i/
cp -a debian/%n/DEBIAN/* %i/../DEBIAN/
  <<
  Triggers: <<
    Activate: <<
      %p/etc/php5/apache2/conf.d
      %p/etc/php5/apache2filter/conf.d
      %p/etc/php5/fpm/conf.d
    <<
  <<
  Description: Enchant module for php5
  DescDetail: <<
This package provides a module for the generic spell checking library
Enchant, which can use engines such as ispell, aspell and myspells.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
  <<
<<
SplitOff22: <<
  Package: %N-gd
  Depends: <<
	dpkg (>= 1.15),
	ucf,
	phpapi-%type_raw[sapiver],
	%N-common (= %v-%r),
	freetype219-shlibs,
	gd3-shlibs,
	libjpeg9-shlibs,
	libpng16-shlibs
  <<
  InstallScript: <<
cp -a debian/%n%p/* %i/
cp -a debian/%n/DEBIAN/* %i/../DEBIAN/
  <<
  Triggers: <<
    Activate: <<
      %p/etc/php5/apache2/conf.d
      %p/etc/php5/apache2filter/conf.d
      %p/etc/php5/fpm/conf.d
    <<
  <<
  Description: GD module for php5
  DescDetail: <<
This package provides a module for handling graphics directly from PHP
scripts. It supports the PNG, JPEG, XPM formats as well as Freetype/ttf fonts.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
  <<
<<
SplitOff23: <<
  Package: %N-gmp
  Depends: <<
	dpkg (>= 1.15),
	ucf,
	phpapi-%type_raw[sapiver],
	%N-common (= %v-%r),
	gmp5-shlibs
  <<
  InstallScript: <<
cp -a debian/%n%p/* %i/
cp -a debian/%n/DEBIAN/* %i/../DEBIAN/
  <<
  Triggers: <<
    Activate: <<
      %p/etc/php5/apache2/conf.d
      %p/etc/php5/apache2filter/conf.d
      %p/etc/php5/fpm/conf.d
    <<
  <<
  Description: GMP module for php5
  DescDetail: <<
This package provides a module for arbitrary precision arithmetic via the
GNU Multiple Precision (GMP) Arithmetic Library.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
  <<
<<
SplitOff24: <<
  Package: %N-imap
  Depends: <<
	dpkg (>= 1.15),
	ucf,
	phpapi-%type_raw[sapiver],
	%N-common (= %v-%r),
	libc-client1-shlibs,
	openssl100-shlibs
  <<
  InstallScript: <<
cp -a debian/%n%p/* %i/
cp -a debian/%n/DEBIAN/* %i/../DEBIAN/
  <<
  Triggers: <<
    Activate: <<
      %p/etc/php5/apache2/conf.d
      %p/etc/php5/apache2filter/conf.d
      %p/etc/php5/fpm/conf.d
    <<
  <<
  Description: IMAP module for php5
  DescDetail: <<
This package provides a module for IMAP functions in PHP scripts.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
  <<
<<
#SplitOff25: <<
#  Package: %N-interbase
#  Depends: <<
#	dpkg (>= 1.15),
#	ucf,
#	phpapi-%type_raw[sapiver],
#	%N-common (= %v-%r)
#   <<
#  InstallScript: <<
#cp -a debian/%n%p/* %i/
#cp -a debian/%n/DEBIAN/* %i/../DEBIAN/
#  <<
#  Triggers: <<
#    Activate: <<
#      %p/etc/php5/apache2/conf.d
#      %p/etc/php5/apache2filter/conf.d
#      %p/etc/php5/fpm/conf.d
#    <<
#  <<
#  Description: Interbase/Firebird module for php5
#  DescDetail: <<
#This package provides a module for interbase/firebird functions in PHP scripts.
#.
#PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
#source general-purpose scripting language that is especially suited for web
#development and can be embedded into HTML.
#  <<
#<<
SplitOff26: <<
  Package: %N-intl
  Depends: <<
	dpkg (>= 1.15),
	ucf,
	phpapi-%type_raw[sapiver],
	%N-common (= %v-%r)
  <<
  InstallScript: <<
cp -a debian/%n%p/* %i/
cp -a debian/%n/DEBIAN/* %i/../DEBIAN/
  <<
  Triggers: <<
    Activate: <<
      %p/etc/php5/apache2/conf.d
      %p/etc/php5/apache2filter/conf.d
      %p/etc/php5/fpm/conf.d
    <<
  <<
  Description: Internationalisation module for php5
  DescDetail: <<
This package provides a module to ease internationalisation of PHP scripts.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
  <<
<<
SplitOff27: <<
  Package: %N-ldap
  Depends: <<
	dpkg (>= 1.15),
	ucf,
	phpapi-%type_raw[sapiver],
	%N-common (= %v-%r),
	cyrus-sasl2-shlibs,
	openldap24-shlibs
  <<
  InstallScript: <<
cp -a debian/%n%p/* %i/
cp -a debian/%n/DEBIAN/* %i/../DEBIAN/
  <<
  Triggers: <<
    Activate: <<
      %p/etc/php5/apache2/conf.d
      %p/etc/php5/apache2filter/conf.d
      %p/etc/php5/fpm/conf.d
    <<
  <<
  Description: LDAP module for php5
  DescDetail: <<
This package provides a module for LDAP functions in PHP scripts.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
  <<
<<
SplitOff28: <<
  Package: %N-mcrypt
  Depends: <<
	dpkg (>= 1.15),
	ucf,
	phpapi-%type_raw[sapiver],
	%N-common (= %v-%r),
	libmcrypt-shlibs,
	libtool2-shlibs
  <<
  InstallScript: <<
cp -a debian/%n%p/* %i/
cp -a debian/%n/DEBIAN/* %i/../DEBIAN/
  <<
  Triggers: <<
    Activate: <<
      %p/etc/php5/apache2/conf.d
      %p/etc/php5/apache2filter/conf.d
      %p/etc/php5/fpm/conf.d
    <<
  <<
  Description: MCrypt module for php5
  DescDetail: <<
This package provides a module for MCrypt functions in PHP scripts.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
  <<
<<
SplitOff29: <<
  Package: %N-mysql
  Depends: <<
	dpkg (>= 1.15),
	ucf,
	phpapi-%type_raw[sapiver],
	%N-common (= %v-%r),
	mysql-unified-shlibs | libmysqlclient18-shlibs
  <<
  Conflicts: php5-mysqlnd
  Replaces: php5-mysqlnd
  InstallScript: <<
cp -a debian/%n%p/* %i/
cp -a debian/%n/DEBIAN/* %i/../DEBIAN/
  <<
  Triggers: <<
    Activate: <<
      %p/etc/php5/apache2/conf.d
      %p/etc/php5/apache2filter/conf.d
      %p/etc/php5/fpm/conf.d
    <<
  <<
  Description: MySQL module for php5
  DescDetail: <<
This package provides modules for MySQL database connections directly from
PHP scripts.  It includes the generic "mysql" module which can be used
to connect to all versions of MySQL, an improved "mysqli" module for
MySQL version 4.1 or later, and the pdo_mysql module for use with
the PHP Data Object extension.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
  <<
<<
SplitOff30: <<
  Package: %N-mysqlnd
  Depends: <<
	dpkg (>= 1.15),
	ucf,
	phpapi-%type_raw[sapiver],
	%N-common (= %v-%r),
	mysql-unified-shlibs | libmysqlclient18-shlibs
  <<
  Conflicts: php5-mysql
  Replaces: php5-mysql
  InstallScript: <<
cp -a debian/%n%p/* %i/
cp -a debian/%n/DEBIAN/* %i/../DEBIAN/
  <<
  Triggers: <<
    Activate: <<
      %p/etc/php5/apache2/conf.d
      %p/etc/php5/apache2filter/conf.d
      %p/etc/php5/fpm/conf.d
    <<
  <<
  Description: MySQL module for php5 (Native Driver)
  DescDetail: <<
This package provides modules for MySQL database connections directly from
PHP scripts.  It includes the generic "mysql" module which can be used
to connect to all versions of MySQL, an improved "mysqli" module for
MySQL version 4.1 or later, and the pdo_mysql module for use with
the PHP Data Object extension.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
  <<
<<
SplitOff31: <<
  Package: %N-odbc
  Depends: <<
	dpkg (>= 1.15),
	ucf,
	phpapi-%type_raw[sapiver],
	%N-common (= %v-%r),
	libodbc3-shlibs
  <<
  InstallScript: <<
cp -a debian/%n%p/* %i/
cp -a debian/%n/DEBIAN/* %i/../DEBIAN/
  <<
  Triggers: <<
    Activate: <<
      %p/etc/php5/apache2/conf.d
      %p/etc/php5/apache2filter/conf.d
      %p/etc/php5/fpm/conf.d
    <<
  <<
  Description: ODBC module for php5
  DescDetail: <<
This package provides a module for database access through ODBC drivers.
It uses the unixODBC library as an ODBC provider.  It also contains the
pdo_odbc module, for use with the PHP Data Object extension.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
  <<
<<
SplitOff32: <<
  Package: %N-pgsql
  Depends: <<
	dpkg (>= 1.15),
	ucf,
	phpapi-%type_raw[sapiver],
	%N-common (= %v-%r),
	postgresql91-shlibs
  <<
  InstallScript: <<
cp -a debian/%n%p/* %i/
cp -a debian/%n/DEBIAN/* %i/../DEBIAN/
  <<
  Triggers: <<
    Activate: <<
      %p/etc/php5/apache2/conf.d
      %p/etc/php5/apache2filter/conf.d
      %p/etc/php5/fpm/conf.d
    <<
  <<
  Description: PostgreSQL module for php5
  DescDetail: <<
This package provides a module for PostgreSQL database connections
directly from PHP scripts.  It also includes the pdo_pgsql module for
use with the PHP Data Object extension.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
  <<
<<
SplitOff33: <<
  Package: %N-pspell
  Depends: <<
	dpkg (>= 1.15),
	ucf,
	phpapi-%type_raw[sapiver],
	%N-common (= %v-%r),
	aspell-shlibs
  <<
  InstallScript: <<
cp -a debian/%n%p/* %i/
cp -a debian/%n/DEBIAN/* %i/../DEBIAN/
  <<
  Triggers: <<
    Activate: <<
      %p/etc/php5/apache2/conf.d
      %p/etc/php5/apache2filter/conf.d
      %p/etc/php5/fpm/conf.d
    <<
  <<
  Description: Pspell module for php5
  DescDetail: <<
This package provides a module for pspell functions in PHP scripts.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
  <<
<<
SplitOff34: <<
  Package: %N-recode
  Depends: <<
	dpkg (>= 1.15),
	ucf,
	phpapi-%type_raw[sapiver],
	%N-common (= %v-%r),
	recode-shlibs
  <<
  InstallScript: <<
cp -a debian/%n%p/* %i/
cp -a debian/%n/DEBIAN/* %i/../DEBIAN/
  <<
  Triggers: <<
    Activate: <<
      %p/etc/php5/apache2/conf.d
      %p/etc/php5/apache2filter/conf.d
      %p/etc/php5/fpm/conf.d
    <<
  <<
  Description: Recode module for php5
  DescDetail: <<
This package provides a module for recode - character set recoding.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
  <<
<<
SplitOff35: <<
  Package: %N-snmp
  Depends: <<
	dpkg (>= 1.15),
	ucf,
	phpapi-%type_raw[sapiver],
	%N-common (= %v-%r),
	libnetsnmp30-shlibs,
	openssl100-shlibs
  <<
  InstallScript: <<
cp -a debian/%n%p/* %i/
cp -a debian/%n/DEBIAN/* %i/../DEBIAN/
  <<
  Triggers: <<
    Activate: <<
      %p/etc/php5/apache2/conf.d
      %p/etc/php5/apache2filter/conf.d
      %p/etc/php5/fpm/conf.d
    <<
  <<
  Description: SNMP module for php5
  DescDetail: <<
This package provides a module for SNMP functions in PHP scripts.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
  <<
<<
SplitOff36: <<
  Package: %N-sqlite
  Depends: <<
	dpkg (>= 1.15),
	ucf,
	phpapi-%type_raw[sapiver],
	%N-common (= %v-%r),
	sqlite3-shlibs
  <<
  InstallScript: <<
cp -a debian/%n%p/* %i/
cp -a debian/%n/DEBIAN/* %i/../DEBIAN/
  <<
  Triggers: <<
    Activate: <<
      %p/etc/php5/apache2/conf.d
      %p/etc/php5/apache2filter/conf.d
      %p/etc/php5/fpm/conf.d
    <<
  <<
  Description: SQLite module for php5
  DescDetail: <<
This package provides a module allowing you to use the SQLite self-contained
database engine from within your PHP scripts, eliminating the need for a full
SQL server installation like MySQL or PostgreSQL.  It also includes the
pdo_sqlite module, for use with the PHP Data Object extension.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
  <<
<<
SplitOff37: <<
  Package: %N-sybase
  Depends: <<
	dpkg (>= 1.15),
	ucf,
	phpapi-%type_raw[sapiver],
	%N-common (= %v-%r),
	libsybdb5-shlibs
  <<
  Provides: %N-mssql
  InstallScript: <<
cp -a debian/%n%p/* %i/
cp -a debian/%n/DEBIAN/* %i/../DEBIAN/
  <<
  Triggers: <<
    Activate: <<
      %p/etc/php5/apache2/conf.d
      %p/etc/php5/apache2filter/conf.d
      %p/etc/php5/fpm/conf.d
    <<
  <<
  Description: Sybase / MS SQL Server module for php5
  DescDetail: <<
This package provides a module for Sybase and Microsoft SQL Server
database connections directly from PHP scripts. It also includes the
pdo_dblib module for use with the PHP Data Object extension.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
  <<
<<
SplitOff38: <<
  Package: %N-tidy
  Depends: <<
	dpkg (>= 1.15),
	ucf,
	phpapi-%type_raw[sapiver],
	%N-common (= %v-%r),
	libtidy-0.99.0-shlibs
  <<
  InstallScript: <<
cp -a debian/%n%p/* %i/
cp -a debian/%n/DEBIAN/* %i/../DEBIAN/
  <<
  Triggers: <<
    Activate: <<
      %p/etc/php5/apache2/conf.d
      %p/etc/php5/apache2filter/conf.d
      %p/etc/php5/fpm/conf.d
    <<
  <<
  Description: Tidy module for php5
  DescDetail: <<
This package provides a module for tidy functions in PHP scripts.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
  <<
<<
SplitOff39: <<
  Package: %N-xmlrpc
  Depends: <<
	dpkg (>= 1.15),
	ucf,
	phpapi-%type_raw[sapiver],
	%N-common (= %v-%r),
	libiconv,
	libxml2-shlibs (>= 2.9.1-1)
  <<
  InstallScript: <<
cp -a debian/%n%p/* %i/
cp -a debian/%n/DEBIAN/* %i/../DEBIAN/
  <<
  Triggers: <<
    Activate: <<
      %p/etc/php5/apache2/conf.d
      %p/etc/php5/apache2filter/conf.d
      %p/etc/php5/fpm/conf.d
    <<
  <<
  Description: XML-RPC module for php5
  DescDetail: <<
This package provides a module for XML-RPC functions in PHP scripts.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
  <<
<<
SplitOff40: <<
  Package: %N-xsl
  Depends: <<
	dpkg (>= 1.15),
	ucf,
	phpapi-%type_raw[sapiver],
	%N-common (= %v-%r),
	libiconv,
	libxml2-shlibs (>= 2.9.1-1),
	libxslt-shlibs
  <<
  InstallScript: <<
cp -a debian/%n%p/* %i/
cp -a debian/%n/DEBIAN/* %i/../DEBIAN/
  <<
  Triggers: <<
    Activate: <<
      %p/etc/php5/apache2/conf.d
      %p/etc/php5/apache2filter/conf.d
      %p/etc/php5/fpm/conf.d
    <<
  <<
  Description: XSL module for php5
  DescDetail: <<
This package provides a module for XSL using the libxslt XSL parser.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
  <<
<<
### This where the sapis start 80+
SplitOff80: <<
  Package: libapache2-mod-%N
  Provides: phpapi-%type_raw[sapiver]
  Depends: <<
	dpkg (>= 1.15),
	ucf,
	%N-common (= %v-%r),
	apache2 (>= 2.4.6),
	bzip2-shlibs,
	db53-aes-shlibs,
	libapr.0-shlibs,
	libaprutil.0-shlibs,
	libgettext8-shlibs,
	libiconv,
	libonig2-shlibs,
	libpcre1-shlibs,
	libxml2-shlibs (>= 2.9.1-1),
	openssl100-shlibs,
	qdbm14-shlibs
  <<
  Conflicts: libapache2-mod-%Nfilter
  Replaces: libapache2-mod-%Nfilter
  InstallScript: <<
cp -a debian/%n%p/* %i/
cp -a debian/%n/DEBIAN/* %i/../DEBIAN/
  <<
  ConfFiles: <<
    %p/etc/apache2/mods-available/php5.load
    %p/etc/apache2/mods-available/php5.conf
  <<
  Triggers: <<
    Interest: <<
      %p/etc/php5/apache2/conf.d
    <<
  <<
  Description: PHP5 Apache 2 module
  DescDetail: <<
This package provides the PHP5 module for the Apache 2 webserver (as found in
the apache2-mpm-prefork package). Please note that this package ONLY works with
Apache's prefork MPM, as it is not compiled thread-safe.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
  <<
<<
SplitOff81: <<
  Package: libapache2-mod-%Nfilter
  Provides: phpapi-%type_raw[sapiver]
  Depends: <<
	dpkg (>= 1.15),
	ucf,
	%N-common (= %v-%r),
	apache2 (>= 2.4.6),
	bzip2-shlibs,
	db53-aes-shlibs,
	libapr.0-shlibs,
	libaprutil.0-shlibs,
	libgettext8-shlibs,
	libiconv,
	libonig2-shlibs,
	libpcre1-shlibs,
	libxml2-shlibs (>= 2.9.1-1),
	openssl100-shlibs,
	qdbm14-shlibs
  <<
  Conflicts: libapache2-mod-%N
  Replaces: libapache2-mod-%N
  InstallScript: <<
cp -a debian/%n%p/* %i/
cp -a debian/%n/DEBIAN/* %i/../DEBIAN/
  <<
  ConfFiles: <<
    %p/etc/apache2/mods-available/php5filter.load
    %p/etc/apache2/mods-available/php5filter.conf
  <<
  Triggers: <<
    Interest: <<
      %p/etc/php5/apache2filter/conf.d
    <<
  <<
  Description: PHP5 Apache 2 filter module
  DescDetail: <<
This package provides the PHP5 Filter module for the Apache 2 webserver (as
found in the apache2-mpm-prefork package). Please note that this package ONLY
works with Apache's prefork MPM, as it is not compiled thread-safe.
.
Unless you specifically need filter-module support, you most likely should
instead install libapache2-mod-php5.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
  <<
<<
SplitOff82: <<
  Package: %N-cgi
  Provides: phpapi-%type_raw[sapiver]
  Depends: <<
	ucf,
	%N-common (= %v-%r),
	httpd,
	bzip2-shlibs,
	db53-aes-shlibs,
	libgettext8-shlibs,
	libiconv,
	libonig2-shlibs,
	libpcre1-shlibs,
	libxml2-shlibs (>= 2.9.1-1),
	openssl100-shlibs,
	qdbm14-shlibs
  <<
  InstallScript: <<
cp -a debian/%n%p/* %i/
cp -a debian/%n/DEBIAN/* %i/../DEBIAN/
  <<
  ConfFiles: <<
    %p/etc/apache2/conf-available/php5-cgi.conf
  <<
  PreInstScript: <<
set -e

dpkg-maintscript-helper mv_conffile %p/etc/apache2/mods-available/php5_cgi.conf \
    %p/etc/apache2/conf-available/php5-cgi.conf 5.5.0~beta4-1 -- "$@"

dpkg-maintscript-helper rm_conffile %p/etc/apache2/mods-available/php5_cgi.load 5.5.0~beta4-1 -- "$@"

exit 0
  <<
  Description: PHP5 CGI binary
  DescDetail: <<
This package provides the %p/lib/cgi-bin/php5 CGI interpreter built for use in
Apache 2 with mod_actions, or any other CGI httpd that supports a similar
mechanism. Note that MOST Apache users probably want the libapache2-mod-php5
package.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
  <<
<<
SplitOff83: <<
  Package: %N-cli
  Provides: phpapi-%type_raw[sapiver]
  Depends: <<
	ucf,
	%N-common (= %v-%r),
	bzip2-shlibs,
	db53-aes-shlibs,
	libgettext8-shlibs,
	libiconv,
	libonig2-shlibs,
	libpcre1-shlibs,
	libxml2-shlibs (>= 2.9.1-1),
	openssl100-shlibs,
	qdbm14-shlibs
  <<
  Recommends: %N-readline
  InstallScript: <<
cp -a debian/%n%p/* %i/
cp -a debian/%n/DEBIAN/* %i/../DEBIAN/
  <<
  Description: Command-line interpreter for the PHP5 scripting language
  DescDetail: <<
This package provides the %p/bin/php5 command interpreter, useful for testing
PHP scripts from a shell or performing general shell scripting tasks.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
  <<
<<
SplitOff84: <<
  Package: %N-fpm
  Provides: phpapi-%type_raw[sapiver]
  Depends: <<
	ucf,
	%N-common (= %v-%r),
	httpd,
	daemonic,
	bzip2-shlibs,
	db53-aes-shlibs,
	libgettext8-shlibs,
	libiconv,
	libonig2-shlibs,
	libpcre1-shlibs,
	libxml2-shlibs (>= 2.9.1-1),
	openssl100-shlibs,
	qdbm14-shlibs
  <<
  Recommends: logrotate
  InstallScript: <<
cp -a debian/%n%p/* %i/
cp -a debian/%n/DEBIAN/* %i/../DEBIAN/
  <<
  ConfFiles: <<
    %p/etc/logrotate.d/php5-fpm
    %p/etc/php5/fpm/php-fpm.conf
    %p/etc/php5/fpm/pool.d/www.conf
  <<
  Triggers: <<
    Interest: <<
      %p/etc/php5/fpm/conf.d
    <<
  <<
  DaemonicName: php5-fpm
  DaemonicFile: <<
   <service>
    <description>PHP5 FastCGI Process Manager</description>
    <message>PHP5 FastCGI Process Manager</message>

    <daemon name="php5-fpm">
      <executable background="yes">%p/sbin/php5-fpmctl</executable>
      <parameters> start</parameters>
    </daemon>
   </service>
  <<
  PreInstScript: <<
set -e

dpkg-maintscript-helper mv_conffile %p/etc/php5/fpm/main.conf %p/etc/php5/fpm/php-fpm.conf 5.3.5-1 -- "$@"

exit 0
  <<
  Description: PHP5 FPM-CGI binary
  DescDetail: <<
This package provides the Fast Process Manager interpreter that runs as a
daemon and receives Fast/CGI requests.  Note that MOST Apache users probably
want the libapache2-mod-php5 package.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
  <<
<<
### Common should be last so it can mop up
SplitOff100: <<
  Package: %N-common
  Depends: <<
	dpkg (>= 1.15),
	ucf,
	cron-service,
	coreutils
  <<
  Provides: php5-mhash
  Conflicts: php5-mhash
  Recommends: php5-json
  Suggests: php5-user-cache
  Docfiles: CODING_STANDARDS CREDITS EXTENSIONS LICENSE NEWS README* test-results.txt
  InstallScript: <<
cp -a debian/%n%p/* %i/
cp -a debian/%n/DEBIAN/* %i/../DEBIAN/
  <<
  ConfFiles: <<
    %p/etc/cron.d/php5
  <<
  Description: Common files for packages built from the PHP5 source
  DescDetail: <<
This package contains the documentation and example files relevant to all the
other packages built from the php5 source.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
  <<
<<
###
Docfiles: LICENSE
###
Description: Server-side, HTML-embedded scripting language
DescDetail: <<
This package is a metapackage that, when installed, guarantees that you have at
least one of the four server-side versions of the PHP5 interpreter installed.
Removing this package won't remove PHP5 from your system, however it may remove
other packages that depend on this one.
.
PHP (recursive acronym for PHP: Hypertext Preprocessor) is a widely-used open
source general-purpose scripting language that is especially suited for web
development and can be embedded into HTML.
<<
###
License: GPL
Homepage: http://www.php.net/
Maintainer: Justin F. Hallett <thesin@users.sourceforge.net>
<<
