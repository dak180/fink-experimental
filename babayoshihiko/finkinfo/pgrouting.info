Info4: <<
Package: pgrouting%type_pkg[postgresql]
Version: 1.05
Revision: 0.2
Description: Geospatial routing functionality for PostGIS
Type: postgresql (8.4 9.0)
License: BSD
Maintainer: BABA Yoshihiko <babayoshihiko@mac.com>

Depends: <<
  boost1.41.cmake-shlibs | boost1.35.nopython-shlibs | boost1.35.systempython-shlibs | boost1.35.python26-shlibs,
  postgresql%type_pkg[postgresql]-shlibs,
  libgaul1-shlibs, cgal4-shlibs,
  proj-shlibs
<<
BuildDepends: <<
  fink (>= 0.29.7-1),
  boost1.41.cmake | boost1.35.nopython-shlibs | boost1.35.systempython | boost1.35.python26,
  postgresql%type_pkg[postgresql]-dev,
  libgaul1, cgal4,
  proj
<<
GCC: 4.0

Source: http://download.osgeo.org/pgrouting/source/pgrouting-%v.tar.gz
Source-MD5: bd7c106e3db3c38f7081f1ee9b0e12ae

#SetCFLAGS: -O2 -Wall -Wmissing-prototypes -Wpointer-arith -Wdeclaration-after-statement -Wendif-labels -fno-strict-aliasing -fwrapv
#SetCXXFLAGS: -I%p/lib/system-openssl/include -fno-common -I%p/include -I%p/include/libxml2 -I%p/include
#SetLDFLAGS: -L%p/opt/postgresql-%type_raw[postgresql]/lib -L%p/lib/system-openssl/lib -F/System/Library/Frameworks -L%p/lib -Wl,-dead_strip_dylibs


CompileScript: <<
#!/bin/sh -ev
  pwd
  CMAKE_OPTIONS="-DCMAKE_PREFIX_PATH=%p
                 -DCMAKE_BUILD_TYPE=Release
		 -DCMAKE_INSTALL_PREFIX=%p
		 -DBoost_INCLUDE_DIR=%p/include
                 -DPOSTGRESQL_PREFIX=%p
		 -DPOSTGRESQL_INCLUDE_DIR=%p/opt/postgresql-%type_raw[postgresql]/include/server
		 -DPOSTGRESQL_LIBRARIES=%p/opt/postgresql-%type_raw[postgresql]/lib
                 -DPOSTGRES_CONFIG=%p/bin/pg_config"
  cmake $CMAKE_OPTIONS -DWITH_TSP=TRUE .

  perl -pi -e "s|-dynamiclib|-bundle|" core/src/CMakeFiles/routing.dir/link.txt
  perl -pi -e "s|-dynamiclib|-bundle|" extra/tsp/src/CMakeFiles/routing_tsp.dir/link.txt
  perl -pi -e "s|-install_name \S+|-bundle_loader %p/bin/postgres|" core/src/CMakeFiles/routing.dir/link.txt
  perl -pi -e "s|-install_name \S+|-bundle_loader %p/bin/postgres|" extra/tsp/src/CMakeFiles/routing_tsp.dir/link.txt
  perl -pi -e "s|librouting\.dylib|librouting\\.so|" core/src/CMakeFiles/routing.dir/link.txt
  perl -pi -e "s|librouting_tsp\.dylib|librouting_tsp\\.so|" extra/tsp/src/CMakeFiles/routing_tsp.dir/link.txt
  perl -pi -e "s|librouting\.dylib|librouting\\.so|" core/src/cmake_install.cmake
  perl -pi -e "s|librouting_tsp\.dylib|librouting_tsp\\.so|" extra/tsp/src/cmake_install.cmake
  perl -pi -e "s|/usr/share|%p/share|" core/sql/cmake_install.cmake
  perl -pi -e "s|/usr/share|%p/share|" extra/tsp/sql/cmake_install.cmake
  make VERBOSE=1
<<
InstallScript: <<
  make install DESTDIR=%d
<<


<<