Package: phpmyadmin
Version: 4.1.9
Revision: 1.1
###
BuildDepends: <<
	fink (>= 0.36.99.git),
	debhelper (>= 9),
	sphinx-py27,
	po-debconf
<<
Depends: <<
	dbconfig-common,
	debconf,
	libapache2-mod-php5 | libapache2-mod-php5filter | php5-cgi | php5-fpm | php5,
	php5-mysql | php5-mysqli | php5-mysqlnd, 
	php5-mcrypt, 
	php5-json,
	php-gettext,
	libjs-codemirror,
	libjs-jquery,
	libjs-jquery-ui,
	libjs-jquery-cookie,
	libjs-jquery-mousewheel,
	libjs-jquery-event-drag,
	libjs-jquery-tablesorter,
	libjs-sphinxdoc,
	php-tcpdf,
	ucf (>= 0.28)
<<
Recommends: <<
	apache2 | lighttpd | httpd,
	php5-gd,
	mysql-client | virtual-mysql-client
<<
Suggests: <<
	mysql-server | virtual-mysql-server,
	www-browser
<<
###
Source: mirror:sourceforge:%n/phpMyAdmin/phpMyAdmin-%v-all-languages.zip
Source-MD5: 8a734584d40742ff8e4bca177a08e85c
Source2: mirror:debian:pool/main/p/%n/%n_%v-1.debian.tar.xz
Source2-MD5: 77dbafa9ef3920a574a13e68c34f7c3e
Source2ExtractDir: phpMyAdmin-%v-all-languages
###
PatchScript: <<
#!/bin/sh -ev
# Patch first to make sure they apply (not a good idea on all packages)
dh_dpatch_patch
dh_quilt_patch

BASE=$(echo %p | perl -pi -e 's,/,,'); \
for i in `find debian -type f`; do perl -pi -e "s,usr,${BASE},g" $i; done; \
for i in `find debian -type f`; do perl -pi -e "s,etc,${BASE}\/etc,g" $i; done; \
for i in `find debian -type f`; do perl -pi -e "s,var\/lib,${BASE}\/var\/lib,g" $i; done

### Leave these things to fink
perl -pi -e 's,dh_gencontrol,#dh_gencontrol,g' debian/rules
perl -pi -e 's,dh_md5sums,#dh_md5sum,g' debian/rules
perl -pi -e 's,dh_builddeb,#dh_builddeb,g' debian/rules

cat << EOF >> debian/rules 

override_dh_auto_test:
EOF

### Fix perms, www on darwin not www-data
for i in `find debian -type f`; do perl -pi -e "s,www-data,www,g" $i; done

### Make sure they use the same jquery as us for sphinxdoc to find it
cp %p/share/javascript/jquery/jquery.js doc/html/_static/jquery.js

### Fix since we can't fix the patch (won't apply)
perl -pi -e 's,\/usr,\%p,g' libraries/vendor_config.php doc/setup.rst
perl -pi -e 's,\/etc,\%p\/etc,g' libraries/vendor_config.php doc/setup.rst
perl -pi -e 's,\/var,\%p\/var,g' libraries/vendor_config.php doc/setup.rst
<<
CompileScript: <<
debian/rules build
<<
InfoTest: <<
	TestScript: <<
dh_auto_test || exit 2
	<<
<<
InstallScript: <<
debian/rules install
debian/rules binary

cp -R debian/%N%p/* %i/
cp debian/%N/DEBIAN/* %d/DEBIAN/
<<
###
Description: MySQL web administration tool
DescDetail: <<
This package allows administering of MySQL with a web interface.

It allows administrators to:
 - browse through databases and tables;
 - create, copy, rename, alter and drop databases;
 - create, copy, rename, alter and drop tables;
 - perform table maintenance;
 - add, edit and drop fields;
 - execute any SQL-statement, even multiple queries;
 - create, alter and drop indexes;
 - load text files into tables;
 - create and read dumps of tables or databases;
 - export data to SQL, CSV, XML, Word, Excel, PDF and LaTeX formats;
 - administer multiple servers;
 - manage MySQL users and privileges;
 - check server settings and runtime information with configuration hints;
 - check referential integrity in MyISAM tables;
 - create complex queries using Query-by-example (QBE), automatically
   connecting required tables;
 - create PDF graphics of database layout;
 - search globally in a database or a subset of it;
 - transform stored data into any format using a set of predefined
   functions, such as displaying BLOB-data as image or download-link;
 - manage InnoDB tables and foreign keys;
 and is fully internationalized and localized in dozens of languages.
<<
###
License: GPL
Maintainer: Justin F. Halett <thesin@lists.sourceforge.net>
Homepage: http://www.phpmyadmin.net/
