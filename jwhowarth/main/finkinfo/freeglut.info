Package: freeglut
Version: 3.0.0-rc1
Revision: 1
Maintainer: Jack Howarth <howarth.at.fink@gmail.com>
Source: mirror:sourceforge:freeglut/%N-%v.tar.gz
Source-MD5: 9679f19e5d9fd211c904698be0cfec2b
PatchFile: %n.patch
PatchFile-MD5: 632abf1692669ee6313aa6beb617f483
SourceDirectory: %n-%v
Depends: %N-shlibs (= %v-%r), glew-shlibs
BuildDepends: fink (>= 0.24.12), glew, x11-dev
Conflicts: glut, openglut
Replaces: glut, openglut
SetCFLAGS: -O3 -DTARGET_HOST_POSIX_X11 -I../include -I%p/include -I/usr/X11R6/include
SetCXXFLAGS:  -O3 -DTARGET_HOST_POSIX_X11 -I../include -I%p/include -I/usr/X11R6/include
SetLDFLAGS: -L%p/lib -L/usr/X11R6/lib
PatchScript: <<
  #!/bin/bash -efv
  %{default_script}
  perl -pi -e 's|HOST_NAME_MAX|_POSIX_HOST_NAME_MAX|' src/x11/fg_window_x11.c
<<
CompileScript: <<
#!/bin/bash -efv
mkdir build
# nasty hack to get cmake to set the proper compatibility and current versions
perl -pi -e 's|VERSION 3.9.0 SOVERSION 3|VERSION 13.0.0 SOVERSION 13|g' CMakeLists.txt
cd build
CMAKE_OPTIONS="-DCMAKE_INSTALL_PREFIX=%p \
                -DCMAKE_VERBOSE_MAKEFILE=ON \
                -DCMAKE_BUILD_TYPE=Release \
		-DCMAKE_COLOR_MAKEFILE=ON \
                -DCMAKE_INSTALL_PREFIX=%p \
		-DOPENGL_INCLUDE_DIR="/usr/X11R6/include" \
 	        -DOPENGL_gl_LIBRARY="/usr/X11R6/lib/libGL.dylib" \
      	 	-DOPENGL_glu_LIBRARY="/usr/X11R6/lib/libGLU.dylib" \
	 	-DFREEGLUT_BUILD_SHARED_LIBS=ON \
		-DFREEGLUT_BUILD_STATIC_LIBS=OFF \
		-DFREEGLUT_BUILD_DEMOS=ON \
                -DCMAKE_OSX_DEPLOYMENT_TARGET:STRING="" \
                -DCMAKE_OSX_SYSROOT:STRING=/"
cmake $CMAKE_OPTIONS ..
make
<<
DocFiles: AUTHORS COPYING ChangeLog NEWS README TODO
BuildDependsOnly: True
InstallScript: <<
#!/bin/bash -efv
cd build
perl -pi -e 's|.PHONY|#.PHONY|g' Makefile
make -j1 install/fast DESTDIR="%d"
# hack around the absence of a cmake --disable-replace-glut option
# and restore VERSION to 3 and create symlink for SOVERSION
mv %i/lib/libglut.13.0.0.dylib %i/lib/libfreeglut.3.dylib
rm %i/lib/libglut.13.dylib
install_name_tool -id %p/lib/libfreeglut.3.dylib %i/lib/libfreeglut.3.dylib 
install_name_tool -change libglut.3.dylib %p/lib/libfreeglut.3.dylib  %i/lib/libfreeglut.3.dylib
ln -fs libfreeglut.3.dylib %i/lib/libglut.3.9.0.dylib
ln -fs libfreeglut.3.dylib %i/lib/libglut.dylib
#ln -fs libfreeglut.a %i/lib/libglut.a
#ln -fs libfreeglut.la %i/lib/libglut.la
#ln -s freeglut.h %i/include/GL/glut.h
ln -s freeglut_ext.h %i/include/GL/glut_ext.h
ln -s freeglut_std.h %i/include/GL/glut_std.h
<<
SplitOff: <<
 Package: %N-shlibs
 Depends: libgl, x11
 Files: lib/libfreeglut.3*.dylib
 Shlibs: %p/lib/libfreeglut.3.dylib 13.0.0 %n (>= 3.0.0-1)
 DocFiles: AUTHORS COPYING ChangeLog NEWS README TODO
<<
Description: Opengl utility toolkit
DescDetail: <<
Freeglut is a completely OpenSourced alternative to the OpenGL Utility 
Toolkit (GLUT) library released under the X-Consortium license. The
original GLUT library seems to have been abandoned with the most recent
version (3.7) dating back to August 1998. Its license does not allow 
anyone to distribute modified library code. Freeglut is actively
developed and doesn't suffer the license restrictions. The goal is
to gradually depreciate the current glut package out of fink replacing
it with freeglut.
<<
DescPackaging: <<
This package is NOT binary compatible with glut/glut-shlibs and can not
replace for them. Packages that wish to use freeglut as a replacement
for glut cannot have "BuildDepends: glut|freeglut" and "Depends:
glut-shlibs|freeglut-shlibs" in their info file, but need to pick one
self-consistently.

This package builds the freeglut libraries named as freeglut rather than
glut to allow the co-existance with glut since the shared library versioning
is identical. I have adopted the use of symlinks for the libraries and 
headers to allow freeglut to used as a drop in replace for glut without
requiring changes in the source code of programs which require glut.

Patch fixes crash in flightgear (taken from RH's Fedora 7 package).
<<
License: OSI-Approved
Homepage: http://freeglut.sourceforge.net/

 	  	 
