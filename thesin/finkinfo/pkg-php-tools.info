Package: pkg-php-tools
Version: 1.8
Revision: 1
###
BuildDepends: <<
	debhelper (>= 7.0.50),
	php5-cli,
	php-pear
<<
Depends: <<
	debhelper,
	php-pear,
	php5-cli,
	coreutils
<<
Suggests: <<
	dh-make
<<
###
Source: mirror:debian:pool/main/p/%n/%n_%v.tar.gz
Source-MD5: d8b8a4701d72bb1365da6c32bb5b5234
SourceDirectory: %n-%v
###
PatchScript:<<
perl -pi -e 's,\/usr,%p,g' bin/dh_* lib/perl/Debian/Debhelper/Buildsystem/phppear.pm lib/scripts/phppkginfo doc/pkg-php-tools.pod testsuite/tests/101_dh_phppear_substvars.sh testsuite/tests/151_dh_phpcomposer_substvars.sh
perl -pi -e 's,\/usr\/share,%p\/share,g' testsuite/tests/201_Debian_Debhelper_Buildsystem_phppear.pl
perl -pi -e 's,\%p\/bin\/install,\/usr\/bin\/install,g' lib/perl/Debian/Debhelper/Buildsystem/phppear.pm
perl -pi -e 's,\%p\/bin\/perl,\/usr\/bin\/perl,g' bin/dh_*
perl -pi -e 's,\"rmdir\",\"grmdir\",g' lib/perl/Debian/Debhelper/Buildsystem/phppear.pm
<<
###
CompileScript: <<
make
<<
InfoTest: <<
	# It requires it's self to be installed but tests can be run
	TestScript: <<
#!/bin/bash -ev
if [ "$(fink list pkg-php-tools | tail -n 1 | cut -f1 -f3)" != " i 	%v-%r" ]; then
	echo "%N needs to be built and installed before tests can be run!";
	exit 0;
fi

make test || exit 2
	<<
<<
InstallScript: <<
install -d -m 0755 %i/share/pkg-php-tools/scripts
install -m 0755 lib/scripts/phppkginfo %i/share/pkg-php-tools/scripts
cp -R lib/overrides %i/share/pkg-php-tools/
install -d -m 0755 %i/lib/perl5
cp -R lib/perl/* %i/lib/perl5
install -d -m 0755 %i/bin
install -m 0755 bin/* %i/bin

install -d -m 0755 %i/share/man/man1
install -m 0644 *.1 %i/share/man/man1
install -d -m 0755 %i/share/man/man7
install -m 0644 *.7 %i/share/man/man7
<<
###
DocFiles: debian/changelog debian/copyright debian/README*
###
Description: Various packaging tools for PHP packages
DescDetail: <<
Provide an easy way to package PHP PEAR, PECL and Composer packages: Run
dh_make, edit debian/rules and debian/control and that's it!
.
Detailed instructions can be found in included READMEs.
<<
###
License: GPL
Maintainer: Justin F. Halett <thesin@lists.sourceforge.net>
Homepage: http://packages.debian.org/unstable/admin/pkg-php-tools.html
