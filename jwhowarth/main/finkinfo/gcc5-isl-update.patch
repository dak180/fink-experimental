--- gcc-5-20141109/gcc/graphite-interchange.c.orig	2014-11-10 17:53:00.000000000 -0500
+++ gcc-5-20141109/gcc/graphite-interchange.c	2014-11-10 17:53:14.000000000 -0500
@@ -30,13 +30,7 @@
 #include <isl/union_map.h>
 #include <isl/ilp.h>
 #include <isl/val.h>
-#if defined(__cplusplus)
-extern "C" {
-#endif
 #include <isl/val_gmp.h>
-#if defined(__cplusplus)
-}
-#endif
 #endif
 
 #include "system.h"
--- gcc-5-20141109/gcc/graphite-isl-ast-to-gimple.c.orig	2014-11-10 17:51:56.000000000 -0500
+++ gcc-5-20141109/gcc/graphite-isl-ast-to-gimple.c	2014-11-10 17:52:18.000000000 -0500
@@ -25,13 +25,7 @@
 #include <isl/map.h>
 #include <isl/union_map.h>
 #include <isl/ast_build.h>
-#if defined(__cplusplus)
-extern "C" {
-#endif
 #include <isl/val_gmp.h>
-#if defined(__cplusplus)
-}
-#endif
 #endif
 
 #include "system.h"
--- gcc-5-20141109/gcc/graphite-optimize-isl.c.orig	2014-11-10 17:54:06.000000000 -0500
+++ gcc-5-20141109/gcc/graphite-optimize-isl.c	2014-11-10 17:55:24.000000000 -0500
@@ -354,7 +354,7 @@
 	{
 	  for (i = ScheduleDimensions - 1 ;  i >= 0 ; i--)
 	    {
-	      if (isl_band_member_is_zero_distance (Band, i))
+	      if (isl_band_member_is_coincident (Band, i))
 		{
 		  isl_map *TileMap;
 		  isl_union_map *TileUMap;
--- gcc-5-20141109/gcc/graphite-poly.c.orig	2014-11-10 17:56:18.000000000 -0500
+++ gcc-5-20141109/gcc/graphite-poly.c	2014-11-10 17:56:28.000000000 -0500
@@ -29,13 +29,7 @@
 #include <isl/ilp.h>
 #include <isl/aff.h>
 #include <isl/val.h>
-#if defined(__cplusplus)
-extern "C" {
-#endif
 #include <isl/val_gmp.h>
-#if defined(__cplusplus)
-}
-#endif
 #endif
 
 #include "system.h"
--- gcc-5-20141109/gcc/graphite-sese-to-poly.c.orig	2014-11-10 17:56:56.000000000 -0500
+++ gcc-5-20141109/gcc/graphite-sese-to-poly.c	2014-11-10 17:57:10.000000000 -0500
@@ -31,13 +31,7 @@
    Missing from  isl/val_gmp.h in isl 0.12 versions.
    Appearing in isl/val_gmp.h in isl 0.13.
    To be removed when passing to isl 0.13. */
-#if defined(__cplusplus)
-extern "C" {
-#endif
 #include <isl/val_gmp.h>
-#if defined(__cplusplus)
-}
-#endif
 #endif
 
 #include "system.h"
--- gcc-5-20141109/gcc/graphite-optimize-isl.c.orig	2014-11-10 19:12:27.000000000 -0500
+++ gcc-5-20141109/gcc/graphite-optimize-isl.c	2014-11-10 19:16:05.000000000 -0500
@@ -426,6 +426,7 @@
 {
 
   isl_schedule *schedule;
+  isl_schedule_constraints *schedule_constraints;
   isl_union_set *domain;
   isl_union_map *validity, *proximity, *dependences;
   isl_union_map *schedule_map;
@@ -440,11 +441,16 @@
 
   proximity = isl_union_map_copy (validity);
 
+  schedule_constraints = isl_schedule_constraints_on_domain(domain);
+  schedule_constraints = isl_schedule_constraints_set_proximity(schedule_constraints, proximity);
+  schedule_constraints = isl_schedule_constraints_set_validity(schedule_constraints, isl_union_map_copy(validity));
+  schedule_constraints = isl_schedule_constraints_set_coincidence(schedule_constraints, validity);
+
   isl_options_set_schedule_max_constant_term (scop->ctx, CONSTANT_BOUND);
   isl_options_set_schedule_maximize_band_depth (scop->ctx, 1);
   isl_options_set_schedule_fuse (scop->ctx, ISL_SCHEDULE_FUSE_MIN);
   isl_options_set_on_error (scop->ctx, ISL_ON_ERROR_CONTINUE);
-  schedule = isl_union_set_compute_schedule (domain, validity, proximity);
+  schedule = isl_schedule_constraints_compute_schedule(schedule_constraints);
   isl_options_set_on_error (scop->ctx, ISL_ON_ERROR_ABORT);
 
   if (!schedule)
